import{c as R,f as M,a9 as E,s as F,bB as T,r as C,i as e,by as W,bz as k,bA as N,bC as s,bD as D,B as L,T as r,S as A,a0 as Q,dw as _,Q as z,e0 as P,P as l}from"./vendor-CEMfbhOc.js";import{f as b}from"./formatNumber-Df8NwpjV.js";import{g as V,a as G,S as H}from"./index-BxvL1HP2.js";import{a as U}from"./crypto--V-xCCVf.js";import{i as I}from"./matchTypes-BFKCRNnN.js";import{c as $,V as S}from"./DashboardViaboSpeiByProfile-D8fFL9Im.js";import"./viabo-spei-paths-BulkWan8.js";import"./formatTime-mlJJpQBT.js";import"./TextMaxLine-iGSgfpVZ.js";import"./formik.esm-Dshy1xjd.js";import"./UploadSingleFile-CP5cFJ4A.js";import"./fade-CViozI82.js";import"./transition-anLY3gj9.js";import"./index-BtYJ4qg-.js";import"./iconBase-D_ql85QS.js";import"./filterSearch-NGUmCbyG.js";import"./usePagination-CDhabgJW.js";import"./spei-third-accounts-store-ZCpmUGhJ.js";import"./HeaderPage-C0c7qZ_K.js";const K=(i,o)=>{const a={externalAccounts:i==null?void 0:i.map(t=>{var d,p,c;return{id:(p=(d=t==null?void 0:t.account)==null?void 0:d.id)==null?void 0:p.toString(),amount:parseFloat((t==null?void 0:t.amount.toString())===""?"0":(c=t==null?void 0:t.amount)==null?void 0:c.toString().replace(/,/g,""))}}),concept:(o==null?void 0:o.toString())||""};return U(a)},Y=(i={})=>{const o=R(),a=M($,i);return{...a,mutate:async(d,p)=>{const{onSuccess:c,onError:u,mutationOptions:y}=p;try{const x=await E.promise(a.mutateAsync(d,y),{pending:"Enviando Transacciones ..."});o.invalidateQueries([S.ACCOUNT_INFO]),o.invalidateQueries([S.BALANCE_RESUME]),o.invalidateQueries([S.MOVEMENTS]),I(c)&&c(x)}catch(x){const h=V(x,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");I(u)&&u(h),E.error(h,{type:G(x)})}}}},f=F(T)(({theme:i})=>({"& td":{paddingTop:i.spacing(.5),paddingBottom:i.spacing(.5)}})),q=({data:i,onBack:o,setTransactionLoading:a,transactionLoading:t,onSuccess:d})=>{const{mutate:p,isLoading:c}=Y(),u=C.useMemo(()=>(i==null?void 0:i.transactions)||[],[i]),y=C.useMemo(()=>(parseFloat(i==null?void 0:i.balance)-(i==null?void 0:i.currentBalance)).toFixed(2)||0,[i]),x=()=>{const{transactions:n,concept:m}=i,g=K(n,m);a(!0),p(g,{onSuccess:j=>{d(j)},onError:()=>{a(!1)}})},h=c||t;return e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsx(W,{sx:{minWidth:200},children:e.jsxs(k,{children:[e.jsx(N,{sx:{borderBottom:n=>`solid 1px ${n.palette.divider}`},children:e.jsxs(T,{children:[e.jsx(s,{width:40,children:"#"}),e.jsx(s,{align:"left",children:"Movimiento"}),e.jsx(s,{align:"right",children:"Monto"})]})}),e.jsxs(D,{children:[u==null?void 0:u.map((n,m)=>{var g,j,B,v;return e.jsxs(T,{sx:{borderBottom:O=>`solid 1px ${O.palette.divider}`},children:[e.jsx(s,{children:m+1}),e.jsx(s,{align:"left",children:e.jsxs(L,{sx:{maxWidth:200},children:[e.jsx(r,{variant:"subtitle2",fontWeight:"bold",children:(g=n==null?void 0:n.account)==null?void 0:g.alias}),e.jsx(r,{variant:"subtitle2",children:(B=(j=n==null?void 0:n.account)==null?void 0:j.bank)==null?void 0:B.name}),e.jsx(r,{variant:"subtitle2",children:(v=n==null?void 0:n.account)==null?void 0:v.clabe}),e.jsx(r,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:n==null?void 0:n.concept})]})}),e.jsx(s,{align:"right",children:b(n==null?void 0:n.amount)})]},m)}),e.jsxs(f,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(A,{flexDirection:"row",gap:1,alignItems:"center",justifyContent:"flex-end",children:e.jsx(r,{children:"Saldo Disponible"})})}),e.jsx(s,{align:"right",width:120,children:e.jsx(r,{children:b(i==null?void 0:i.balance)})})]}),e.jsxs(f,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(r,{variant:"h6",children:"Total a dispersar"})}),e.jsx(s,{align:"right",width:120,children:e.jsx(r,{variant:"h6",sx:{color:"error.main"},children:b(-(i==null?void 0:i.currentBalance))})})]}),e.jsxs(f,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(r,{children:"Total después de movimiento"})}),e.jsx(s,{align:"right",width:140,children:e.jsx(r,{children:b(y)})})]})]})]})})}),e.jsxs(A,{sx:{p:3},spacing:3,children:[e.jsx(Q,{size:"large",onClick:x,endIcon:e.jsx(_,{}),loading:h,variant:"contained",color:"primary",fullWidth:!0,type:"submit",sx:{fontWeight:"bold"},children:"Realizar"}),!h&&e.jsx(z,{onClick:o,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(P,{}),children:"Regresar"})]})]})};q.propTypes={data:l.shape({balance:l.any,currentBalance:l.any,concept:l.any,transactions:l.array}),onBack:l.func,onSuccess:l.func,setTransactionLoading:l.func,transactionLoading:l.any};export{q as default};
//# sourceMappingURL=SpeiOutResume-BhDD3fou.js.map
