import{z as B,j as e,k as v,a as A,Z as T,g as E,b as M,q as R,r as I,a2 as k,B as f,T as p,S as F,L as N,p as O,D as t}from"./index-a047affd.js";import{a as Q}from"./build-7aab8da4.js";import{f as a}from"./build-7efe98ef.js";import{t as _,C as S}from"./build-813029bf.js";import{T as b,g as L,h as W,i as z,j as l,k as D}from"./build-95579a04.js";import{S as G}from"./build-4a60a95f.js";import"./build-bee6630b.js";import"./build-1d1632da.js";import"./build-2ec18099.js";import"./build-bcb90f6b.js";import"./build-6c0e5d69.js";import"./build-c89a286d.js";import"./build-2251add0.js";import"./build-790666fb.js";import"./build-f91b49ee.js";import"./build-1b5e218d.js";import"./build-f4cfa8ef.js";import"./build-3146bd8f.js";import"./build-8f64463c.js";import"./build-3ed52cce.js";import"./build-fd15e878.js";const P=B(e.jsx("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos"),$=(r,n,h)=>{var u,g,m;let c;return h?c={originCardId:r,destinationCards:[{cardId:(u=n==null?void 0:n.card)==null?void 0:u.value.toString(),concept:(g=n==null?void 0:n.concept)==null?void 0:g.toString(),amount:parseFloat((n==null?void 0:n.amount.toString())===""?"0":(m=n==null?void 0:n.amount)==null?void 0:m.toString().replace(/,/g,"")).toString()}]}:c={originCardId:r,destinationCards:n==null?void 0:n.map(i=>{var d,o,s,x;return{cardId:(o=(d=i==null?void 0:i.card)==null?void 0:d.value)==null?void 0:o.toString(),concept:(s=i==null?void 0:i.concept)==null?void 0:s.toString(),amount:parseFloat((i==null?void 0:i.amount.toString())===""?"0":(x=i==null?void 0:i.amount)==null?void 0:x.toString().replace(/,/g,"")).toString()}})},{cardId:c==null?void 0:c.originCardId,data:Q(c)}},q=(r={})=>{const n=v(),h=A(_,r);return{...h,transaction:async(u,g)=>{const{onSuccess:m,onError:i,mutationOptions:d}=g;try{await T.promise(h.mutateAsync(u,d),{pending:"Procesando Transferencia ...",success:{render({data:o}){return n.fetchQuery([S.TRANSIT_BALANCE]),n.invalidateQueries([S.CARD_INFO,o==null?void 0:o.cardId]),n.fetchQuery([S.CARD_MOVEMENTS,o==null?void 0:o.cardId]),n.fetchQuery([S.MAIN_CARD]),m(o),"Se realizo la transferencia con éxito"}}})}catch(o){const s=E(o,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");i(s),T.error(s,{type:M(o)})}}}},C=R(b)(({theme:r})=>({"& td":{paddingTop:r.spacing(.5),paddingBottom:r.spacing(.5)}})),H=({data:r,onBack:n,setTransactionLoading:h,transactionLoading:c,onClose:u})=>{const{transaction:g,isLoading:m}=q(),i=I.useMemo(()=>(r!=null&&r.isGlobal?[r==null?void 0:r.transactions]:r==null?void 0:r.transactions)||[],[r]),d=I.useMemo(()=>(parseFloat(r==null?void 0:r.balance)-(r==null?void 0:r.currentBalance)).toFixed(2)||0,[r]),o=()=>{const{cardOriginId:s,transactions:x,isGlobal:j}=r,y=$(s,x,j);h(!0),g(y,{onSuccess:()=>{u()},onError:()=>{h(!1)}})};return e.jsxs(e.Fragment,{children:[e.jsx(k,{children:e.jsx(L,{sx:{minWidth:200},children:e.jsxs(W,{children:[e.jsx(z,{sx:{borderBottom:s=>`solid 1px ${s.palette.divider}`},children:e.jsxs(b,{children:[e.jsx(l,{width:40,children:"#"}),e.jsx(l,{align:"left",children:"Movimiento"}),e.jsx(l,{align:"right",children:"Monto"})]})}),e.jsxs(D,{children:[i==null?void 0:i.map((s,x)=>{var j;return e.jsxs(b,{sx:{borderBottom:y=>`solid 1px ${y.palette.divider}`},children:[e.jsx(l,{children:x+1}),e.jsx(l,{align:"left",children:e.jsxs(f,{sx:{maxWidth:200},children:[e.jsx(p,{variant:"subtitle2",children:((j=s==null?void 0:s.card)==null?void 0:j.cardUserNumber)||"Cuenta Global"}),e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:s==null?void 0:s.concept})]})}),e.jsx(l,{align:"right",children:a(s==null?void 0:s.amount)})]},x)}),e.jsxs(C,{children:[e.jsx(l,{colSpan:1}),e.jsxs(l,{align:"right",children:[e.jsx(f,{sx:{mt:2}}),e.jsx(p,{children:"Saldo"})]}),e.jsxs(l,{align:"right",width:120,children:[e.jsx(f,{sx:{mt:2}}),e.jsx(p,{children:a(r==null?void 0:r.balance)})]})]}),e.jsxs(C,{children:[e.jsx(l,{colSpan:1}),e.jsx(l,{align:"right",children:e.jsx(p,{children:"Transacciones"})}),e.jsx(l,{align:"right",width:120,children:e.jsx(p,{sx:{color:"error.main"},children:a(-(r==null?void 0:r.currentBalance))})})]}),e.jsxs(C,{children:[e.jsx(l,{colSpan:1}),e.jsx(l,{align:"right",children:e.jsx(p,{variant:"h6",children:"Total"})}),e.jsx(l,{align:"right",width:140,children:e.jsx(p,{variant:"h6",children:a(d)})})]})]})]})})}),e.jsxs(F,{sx:{p:3},spacing:3,children:[e.jsx(N,{onClick:o,loading:m||c,variant:"contained",color:"primary",fullWidth:!0,type:"submit",startIcon:e.jsx(G,{}),children:"Enviar"}),(!m||!c)&&e.jsx(O,{onClick:n,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(P,{}),children:"Regresar"})]})]})};H.propTypes={data:t.shape({balance:t.any,cardOriginId:t.any,currentBalance:t.any,isGlobal:t.any,transactions:t.any}),onBack:t.any,onClose:t.func,setTransactionLoading:t.func,transactionLoading:t.any};export{H as default};
