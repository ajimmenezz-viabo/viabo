{"version":3,"file":"SpeiOutConcentratorForm-BM5liQ8X.js","sources":["../../../../../frontend/src/app/business/viabo-spei/dashboard/components/spei-out/SpeiOutConcentratorForm.jsx"],"sourcesContent":["import React, { useEffect } from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport { ArrowForwardIos } from '@mui/icons-material'\nimport { Stack, Typography } from '@mui/material'\nimport { useFormik } from 'formik'\nimport { toast } from 'react-toastify'\n\nimport { ButtonViaboSpei, borderColorViaboSpeiStyle } from '@/app/business/viabo-spei/shared/components'\nimport { FormProvider, MaskedInput, RFTextField } from '@/shared/components/form'\nimport { Scrollbar } from '@/shared/components/scroll'\n\nconst SpeiOutConcentratorForm = ({ selectedAccount, setCurrentBalance, insufficient, onSuccess, initialValues }) => {\n  const formik = useFormik({\n    initialValues: initialValues || {\n      transactions: [],\n      amount: '',\n      concept: ''\n    },\n    validateOnChange: false,\n    onSubmit: (values, { setFieldValue, setSubmitting }) => {\n      if (insufficient) {\n        toast.warning('Saldo insuficiente para realizar esta operación')\n        return setSubmitting(false)\n      }\n      setSubmitting(false)\n      setFieldValue('amount', '')\n      return onSuccess({ ...values, origin: selectedAccount?.account?.number })\n    }\n  })\n\n  const { isSubmitting, setFieldValue, values, handleSubmit } = formik\n\n  const loading = isSubmitting\n\n  const crypto = window.crypto || window.msCrypto\n\n  const array = new Uint32Array(1)\n\n  const random = crypto.getRandomValues(array)[0]\n\n  const isDisabled = values?.amount === '' || Number(values?.amount) <= 0\n\n  useEffect(() => {\n    const totalAmount = values.transactions?.reduce((accumulator, currentObject) => {\n      const amountValue = currentObject.amount.trim() !== '' ? parseFloat(currentObject.amount.replace(/,/g, '')) : 0\n\n      if (!isNaN(amountValue)) {\n        return accumulator + amountValue\n      } else {\n        return accumulator\n      }\n    }, 0)\n\n    const currentBalance = totalAmount.toFixed(2)\n\n    setCurrentBalance(currentBalance)\n  }, [values.transactions])\n\n  return (\n    <Scrollbar containerProps={{ sx: { flexGrow: 0, height: 'auto' } }}>\n      <FormProvider formik={formik}>\n        <Stack sx={{ p: 3 }} spacing={3}>\n          <Stack spacing={0.5}>\n            <Typography variant=\"caption\" fontWeight={'bold'}>\n              Monto:\n            </Typography>\n            <RFTextField\n              size={'large'}\n              name={'amount'}\n              placeholder={'0.00'}\n              disabled={loading}\n              autoComplete={'off'}\n              InputProps={{\n                startAdornment: <span style={{ marginRight: '5px' }}>$</span>,\n                endAdornment: <span style={{ marginRight: '5px' }}>MXN</span>,\n                inputComponent: MaskedInput,\n                inputProps: {\n                  mask: Number,\n                  radix: '.',\n                  thousandsSeparator: ',',\n                  padFractionalZeros: true,\n                  min: 0,\n                  scale: 2,\n                  value: values.amount,\n                  onAccept: value => {\n                    setFieldValue('amount', value)\n                    setFieldValue('transactions', [\n                      {\n                        id: random,\n                        account: { clabe: selectedAccount?.concentrator?.number, name: 'ENVIÓ A CONCENTRADORA' },\n                        amount: values?.amount\n                      }\n                    ])\n                  }\n                },\n                sx: {\n                  borderRadius: theme => Number(1),\n                  borderColor: borderColorViaboSpeiStyle\n                }\n              }}\n            />\n          </Stack>\n\n          <RFTextField\n            fullWidth\n            name={'concept'}\n            multiline\n            disabled={loading}\n            rows={2}\n            label={'Concepto'}\n            placeholder={'Transferencia ..'}\n            InputProps={{\n              sx: {\n                borderRadius: theme => Number(1),\n                borderColor: borderColorViaboSpeiStyle\n              }\n            }}\n          />\n\n          <Stack sx={{ pt: 3 }}>\n            <ButtonViaboSpei\n              variant=\"contained\"\n              size=\"large\"\n              color=\"primary\"\n              disabled={isDisabled}\n              fullWidth\n              type={'submit'}\n              startIcon={<ArrowForwardIos />}\n            >\n              Siguiente\n            </ButtonViaboSpei>\n          </Stack>\n        </Stack>\n      </FormProvider>\n    </Scrollbar>\n  )\n}\n\nSpeiOutConcentratorForm.propTypes = {\n  initialValues: PropTypes.shape({\n    transactions: PropTypes.array,\n    amount: PropTypes.string,\n    concept: PropTypes.string\n  }),\n  insufficient: PropTypes.any,\n  onSuccess: PropTypes.func,\n  selectedAccount: PropTypes.shape({\n    account: PropTypes.shape({\n      number: PropTypes.any\n    }),\n    concentrator: PropTypes.shape({\n      number: PropTypes.any\n    })\n  }),\n  setCurrentBalance: PropTypes.func\n}\n\nexport default SpeiOutConcentratorForm\n"],"names":["SpeiOutConcentratorForm","selectedAccount","setCurrentBalance","insufficient","onSuccess","initialValues","formik","useFormik","transactions","amount","concept","validateOnChange","onSubmit","values","setFieldValue","setSubmitting","toast","warning","origin","account","number","isSubmitting","handleSubmit","loading","crypto","window","msCrypto","array","Uint32Array","random","getRandomValues","isDisabled","Number","useEffect","currentBalance","reduce","accumulator","currentObject","amountValue","trim","parseFloat","replace","isNaN","toFixed","jsx","Scrollbar","sx","flexGrow","height","FormProvider","jsxs","Stack","p","Typography","RFTextField","startAdornment","marginRight","endAdornment","inputComponent","MaskedInput","inputProps","mask","radix","thousandsSeparator","padFractionalZeros","min","scale","value","onAccept","id","clabe","concentrator","name","borderRadius","borderColor","borderColorViaboSpeiStyle","pt","ButtonViaboSpei","ArrowForwardIos","propTypes","PropTypes","shape","string","any","func"],"mappings":"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"}