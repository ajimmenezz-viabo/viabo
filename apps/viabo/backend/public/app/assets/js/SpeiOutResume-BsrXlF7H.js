import{c as M,f as R,a9 as E,s as F,bB as B,r as C,i as e,by as W,bz as k,bA as L,bC as s,bD as N,B as V,T as t,S as A,dw as z,e0 as _,P as l}from"./vendor-CEMfbhOc.js";import{f as b}from"./formatNumber-Df8NwpjV.js";import{g as D,a as P,S as Q}from"./index-B-U8M-8N.js";import{a as G}from"./crypto--V-xCCVf.js";import{c as H,V as y,L as U,B as $}from"./DashboardViaboSpeiByProfile-CuPFxNBw.js";import{i as I}from"./matchTypes-BFKCRNnN.js";import"./viabo-spei-paths-CP0FcW2K.js";import"./formatTime-mlJJpQBT.js";import"./TextMaxLine-D6XZvUuW.js";import"./formik.esm-Dshy1xjd.js";import"./UploadSingleFile-B0jkdwVt.js";import"./fade-CViozI82.js";import"./transition-anLY3gj9.js";import"./index-BtYJ4qg-.js";import"./iconBase-D_ql85QS.js";import"./filterSearch-NGUmCbyG.js";import"./usePagination-CDhabgJW.js";import"./spei-third-accounts-store-CIqgAlGv.js";import"./HeaderPage-DRv2GeZX.js";const K=(i,o)=>{const a={externalAccounts:i==null?void 0:i.map(r=>{var d,p,c;return{id:(p=(d=r==null?void 0:r.account)==null?void 0:d.id)==null?void 0:p.toString(),amount:parseFloat((r==null?void 0:r.amount.toString())===""?"0":(c=r==null?void 0:r.amount)==null?void 0:c.toString().replace(/,/g,""))}}),concept:(o==null?void 0:o.toString())||""};return G(a)},Y=(i={})=>{const o=M(),a=R(H,i);return{...a,mutate:async(d,p)=>{const{onSuccess:c,onError:u,mutationOptions:S}=p;try{const x=await E.promise(a.mutateAsync(d,S),{pending:"Enviando Transacciones ..."});o.invalidateQueries([y.ACCOUNT_INFO]),o.invalidateQueries([y.BALANCE_RESUME]),o.invalidateQueries([y.MOVEMENTS]),I(c)&&c(x)}catch(x){const h=D(x,"No se puede realizar esta operaciÃ³n en este momento. Intente nuevamente o reporte a sistemas");I(u)&&u(h),E.error(h,{type:P(x)})}}}},f=F(B)(({theme:i})=>({"& td":{paddingTop:i.spacing(.5),paddingBottom:i.spacing(.5)}})),q=({data:i,onBack:o,setTransactionLoading:a,transactionLoading:r,onSuccess:d})=>{const{mutate:p,isLoading:c}=Y(),u=C.useMemo(()=>(i==null?void 0:i.transactions)||[],[i]),S=C.useMemo(()=>(parseFloat(i==null?void 0:i.balance)-(i==null?void 0:i.currentBalance)).toFixed(2)||0,[i]),x=()=>{const{transactions:n,concept:m}=i,g=K(n,m);a(!0),p(g,{onSuccess:j=>{d(j)},onError:()=>{a(!1)}})},h=c||r;return e.jsxs(e.Fragment,{children:[e.jsx(Q,{children:e.jsx(W,{sx:{minWidth:200},children:e.jsxs(k,{children:[e.jsx(L,{sx:{borderBottom:n=>`solid 1px ${n.palette.divider}`},children:e.jsxs(B,{children:[e.jsx(s,{width:40,children:"#"}),e.jsx(s,{align:"left",children:"Movimiento"}),e.jsx(s,{align:"right",children:"Monto"})]})}),e.jsxs(N,{children:[u==null?void 0:u.map((n,m)=>{var g,j,v,T;return e.jsxs(B,{sx:{borderBottom:O=>`solid 1px ${O.palette.divider}`},children:[e.jsx(s,{children:m+1}),e.jsx(s,{align:"left",children:e.jsxs(V,{sx:{maxWidth:200},children:[e.jsx(t,{variant:"subtitle2",fontWeight:"bold",children:(g=n==null?void 0:n.account)==null?void 0:g.alias}),e.jsx(t,{variant:"subtitle2",children:(v=(j=n==null?void 0:n.account)==null?void 0:j.bank)==null?void 0:v.name}),e.jsx(t,{variant:"subtitle2",children:(T=n==null?void 0:n.account)==null?void 0:T.clabe}),e.jsx(t,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:n==null?void 0:n.concept})]})}),e.jsx(s,{align:"right",children:b(n==null?void 0:n.amount)})]},m)}),e.jsxs(f,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(A,{flexDirection:"row",gap:1,alignItems:"center",justifyContent:"flex-end",children:e.jsx(t,{children:"Saldo disponible"})})}),e.jsx(s,{align:"right",width:120,children:e.jsx(t,{children:b(i==null?void 0:i.balance)})})]}),e.jsxs(f,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(t,{variant:"h6",children:"Total a dispersar"})}),e.jsx(s,{align:"right",width:120,children:e.jsx(t,{variant:"h6",sx:{color:"error.main"},children:b(-(i==null?void 0:i.currentBalance))})})]}),e.jsxs(f,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(t,{children:"Saldo actualizado"})}),e.jsx(s,{align:"right",width:140,children:e.jsx(t,{children:b(S)})})]})]})]})})}),e.jsxs(A,{direction:{md:"row-reverse"},sx:{p:3},gap:3,children:[e.jsx(U,{size:"large",onClick:x,endIcon:e.jsx(z,{}),loading:h,variant:"contained",color:"primary",fullWidth:!0,type:"submit",sx:{fontWeight:"bold"},children:"Enviar"}),!h&&e.jsx($,{size:"large",onClick:o,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(_,{}),children:"Regresar"})]})]})};q.propTypes={data:l.shape({balance:l.any,currentBalance:l.any,concept:l.any,transactions:l.array}),onBack:l.func,onSuccess:l.func,setTransactionLoading:l.func,transactionLoading:l.any};export{q as default};
//# sourceMappingURL=SpeiOutResume-BsrXlF7H.js.map
