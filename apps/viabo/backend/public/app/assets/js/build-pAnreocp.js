import{z as q,j as r,am as K,K as y,aO as v,O as m,r as C,ak as Q,S as h,T as c,B as S,al as g,E as W,a2 as Y,an as J,d as X,g as Z,N as ee,P as te,ae as re,aP as ne,aQ as ae,C as M,_ as T}from"./index-mplo7Cy0.js";import{V as se}from"./build-piimbepB.js";import{P as oe}from"./build-eQ93QMpk.js";import{L as _}from"./build-fgcEbVX7.js";import{L as le}from"./build-1LmYI3dU.js";import{g as ie}from"./build-TesjUH-a.js";import{P as ce}from"./build-A0pkRIS4.js";import{f as O,M as me,C as pe,H as de}from"./build-oGgHkT3Q.js";import{c as ue}from"./build-yDVAqRjG.js";import{u as he}from"./build-yyP470yP.js";const xe=q(r.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"}),"LibraryAdd"),Ce={commerce:null,openCommerceDetails:!1,openCommerceCommissions:!1,openCommerceServices:!1},ge=(e,t)=>({...Ce,setCommerce:a=>{e(n=>({commerce:a}))},setOpenCommerceDetails:a=>{e(n=>({openCommerceDetails:a}),!1,"SET_OPEN_COMMERCE_DETAILS")},setOpenCommerceCommissions:a=>{e(n=>({openCommerceCommissions:a}),!1,"SET_OPEN_COMMERCE_COMMISSIONS")},setOpenCommerceServices:a=>{e(n=>({openCommerceServices:a}),!1,"SET_OPEN_COMMERCE_SERVICES")}}),fe=K(ge);function Se(e){const{row:t,closeMenu:a}=e,{original:n}=t,{setCommerce:s,setOpenCommerceDetails:o,setOpenCommerceCommissions:l,setOpenCommerceServices:p}=fe(d=>d);return[r.jsxs(y,{onClick:()=>{s(n),o(!0),a()},sx:{m:0},children:[r.jsx(v,{children:r.jsx(se,{color:"info"})}),"Ver Detalles"]},"details"),r.jsxs(y,{onClick:()=>{s(n),l(!0),a()},sx:{m:0},children:[r.jsx(v,{children:r.jsx(oe,{color:"primary"})}),"Comisiones"]},"commissions"),r.jsxs(y,{onClick:()=>{s(n),p(!0),a()},sx:{m:0},children:[r.jsx(v,{children:r.jsx(xe,{})}),"Servicios"]},"services")]}const P=({open:e,anchorEl:t,handlePopoverClose:a,data:n})=>{var s;return n?r.jsx(Q,{id:"mouse-over-popover",sx:{pointerEvents:"none"},open:e,anchorEl:t,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},onClose:a,disableRestoreFocus:!0,slotProps:{paper:{sx:{mt:1.5,ml:.5,overflow:"inherit",boxShadow:o=>o.customShadows.z20,border:o=>`solid 1px ${o.palette.grey[5008]}`,width:200}}},children:r.jsxs(h,{spacing:2,p:2,children:[r.jsxs(h,{spacing:.5,flex:1,children:[r.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre:"}),r.jsx(c,{variant:"body2",children:(n==null?void 0:n.name)??"-"})]}),r.jsxs(h,{spacing:.5,flex:1,children:[r.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono:"}),r.jsx(c,{variant:"body2",children:(n==null?void 0:n.phone)??"-"})]}),r.jsxs(h,{spacing:.5,flex:1,children:[r.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Fecha Registro:"}),r.jsx(c,{variant:"body2",children:(n==null?void 0:n.register)??"-"})]}),r.jsxs(h,{spacing:.5,flex:1,children:[r.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Último Inicio de Sesión:"}),r.jsx(c,{variant:"body2",children:(n==null?void 0:n.lastLogged)??"-"})]}),r.jsxs(h,{spacing:.5,flex:1,children:[r.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Estado:"}),r.jsx(S,{children:r.jsx(_,{variant:"ghost",color:((s=n==null?void 0:n.status)==null?void 0:s.toLowerCase())==="activo"?"success":"error",sx:{textTransform:"uppercase"},children:(n==null?void 0:n.status)??"-"})})]})]})}):null};P.propTypes={anchorEl:m.any,data:m.shape({lastLogged:m.string,name:m.string,phone:m.string,register:m.string,status:m.string}),handlePopoverClose:m.any,open:m.any};const Ee=C.memo(P),N=({row:e})=>{var l;const[t,a]=C.useState(null),n=p=>{a(p.currentTarget)},s=()=>{a(null)},o=!!t;return r.jsxs(r.Fragment,{children:[r.jsx(Ee,{anchorEl:t,open:o,handlePopoverClose:s,data:e==null?void 0:e.account}),r.jsx(S,{sx:{display:"flex",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:1},children:r.jsx(le,{color:"info.main",sx:{cursor:"auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},underline:"none",variant:"subtitle2",component:c,"aria-owns":o?"mouse-over-popover":void 0,"aria-haspopup":"true",onMouseEnter:p=>{n(p)},onMouseLeave:s,children:(l=e==null?void 0:e.account)==null?void 0:l.name})})]})};N.propTypes={row:m.shape({account:m.shape({name:m.any})})};const je=e=>{const t=e==null?void 0:e.find(a=>(a==null?void 0:a.type)==="2");return t?{id:t==null?void 0:t.id,type:t==null?void 0:t.type,name:t==null?void 0:t.name,cardNumbers:t==null?void 0:t.cardNumbers,cardUse:t==null?void 0:t.cardUse,customCardsRequired:(t==null?void 0:t.personalized)==="1"}:null},be=e=>(e==null?void 0:e.map(t=>{const{Id:a,Name:n,storePath:s}=t;return{id:a,name:n,path:s}}))??[],ye=e=>({available:!!e,speiInCarnet:parseFloat((e==null?void 0:e.SpeiInCarnet)??"0.0"),speiOutCarnet:parseFloat((e==null?void 0:e.SpeiOutCarnet)??"0.0"),speiInMasterCard:parseFloat((e==null?void 0:e.SpeiInMasterCard)??"0.0"),speiOutMasterCard:parseFloat((e==null?void 0:e.SpeiOutMasterCard)??"0.0"),viaboPay:parseFloat((e==null?void 0:e.Pay)??"0.0")}),ve=e=>e.map((t,a)=>I(t)),I=e=>{var A;const{id:t,legalRepresentative:a,legalRepresentativeName:n,legalRepresentativePhone:s,legalRepresentativeLastSession:o,legalRepresentativeEmail:l,fiscalName:p,fiscalPersonType:u,tradeName:d,rfc:E,employees:j,branchOffices:b,pointSaleTerminal:f,paymentApi:L,register:D,statusId:z,registerStep:w,statusName:R,services:x,documents:V,terminals:F,commissions:H,slug:B,publicTerminal:k,postalAddress:U,phoneNumbers:G,logo:$}=e;return{id:t,name:d,account:{id:a,name:n,email:l,phone:s,status:"Activo",lastLogged:o===""?"No ha iniciado sesión":O(o),register:O(D)??""},information:{available:p!=="",fiscalName:p,commercialName:d,fiscalTypePerson:u,rfc:E,employeesNumber:j,branchesNumber:b,terminalCommerceSlug:B||"",publicTerminal:k||null,postalAddress:U||"",phoneNumbers:G||"",logo:$||null},terminals:ue(F||[],"id","name"),services:{names:(x==null?void 0:x.map(i=>i==null?void 0:i.name))||[],catalog:(x==null?void 0:x.map(i=>({id:i==null?void 0:i.Id,type:i==null?void 0:i.type,name:i==null?void 0:i.name})))||[],available:f!=="0",viaboCard:je(x),viaboPay:{tpvsNumber:f,apiRequired:L==="1"}},status:{id:z,name:R,step:((A=ce.find(i=>i.step.toString()===w))==null?void 0:A.name)??""},documents:be(V),commissions:ye(H)}},Me={COMMERCE_LIST:"commerceList",COMMERCE_DETAILS:"commerce-details"},Te=async()=>{const{data:e}=await g.get("/api/commerces");return ve(e)},qe=async e=>{const{data:t}=await g.get(`/api/commerce/${e}`);return I(t)},Ke=async e=>{const{data:t}=await g.post("/api/commerce/commissions/register",e);return t},Qe=async e=>{const{data:t}=await g.post("/api/backoffice/commerce/update",e);return t},We=async e=>{const{data:t}=await g.put("/api/commerce/service",e);return t},Ae=[{id:1,name:"Registro",color:"info"},{id:2,name:"Validacion",color:"warning"},{id:3,name:"Afiliacion",color:"primary"},{id:4,name:"Cancelado",color:"error"}],Oe=e=>{var t;return((t=Ae.find(a=>a.id.toString()===e.toString()))==null?void 0:t.color)||"info"},_e=()=>C.useMemo(()=>[{id:"name",accessorKey:"name",header:"Nombre",enableHiding:!1,size:120,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>r.jsx(c,{fontWeight:"bold",variant:"subtitle2",children:n})},{id:"legalRepresentative",accessorFn:e=>{var t;return(t=e==null?void 0:e.account)==null?void 0:t.name},header:"Representante Legal",size:100,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>{const{original:s}=a;return r.jsx(N,{row:s})}},{id:"services",accessorFn:e=>{var t,a;return(a=(t=e==null?void 0:e.services)==null?void 0:t.names)==null?void 0:a.toString()},header:"Servicios",Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>{var l,p;const{original:s}=a,o=[];return(p=(l=s==null?void 0:s.services)==null?void 0:l.names)==null||p.forEach(u=>{const d=ie(u);d&&o.push({component:d==null?void 0:d.component,name:u,width:u==="NUBE"?20:25,height:u==="NUBE"?20:25,color:u==="NUBE"?"primary.main":"inherit"})}),r.jsxs(h,{flexDirection:"row",alignItems:"center",gap:1,divider:r.jsx(W,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"double"}}),children:[(o==null?void 0:o.length)===0&&r.jsx(c,{variant:"subtitle2",fontWeight:"bold",color:"warning.main",children:"Sin Servicios"}),o==null?void 0:o.map(({component:u,width:d,height:E,name:j,color:b},f)=>r.jsx(Y,{title:j,children:r.jsx(S,{display:"flex",children:r.jsx(u,{sx:{width:d,height:E,color:b}})})},f))]})}},{id:"register-status",accessorFn:e=>{var t;return(t=e==null?void 0:e.status)==null?void 0:t.step},header:"Estado Registro",minSize:100,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>r.jsx(h,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.jsx(c,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variant:"subtitle2",title:n,children:n})})},{id:"status",accessorFn:e=>{var t;return(t=e==null?void 0:e.status)==null?void 0:t.name},header:"Estado",size:70,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>{var o,l;const{original:s}=a;return r.jsx(h,{children:r.jsx(_,{size:"sm",variant:"filled",color:Oe((o=s==null?void 0:s.status)==null?void 0:o.id),sx:{textTransform:"uppercase"},children:(l=s==null?void 0:s.status)==null?void 0:l.name})})}}],[]),Pe=(e={})=>{const{enqueueSnackbar:t}=J(),[a,n]=C.useState(null);return{...X([Me.COMMERCE_LIST],Te,{staleTime:60*5e3,onError:o=>{const l=Z(o,"No se puede obtener la lista de comercios");n(l),t(l,{variant:"error",autoHideDuration:5e3})},...e}),error:a||null}};function Ne(){const{data:e,isLoading:t,isError:a,error:n,isFetching:s}=Pe(),o=_e(),l=he(a,n,{columns:o,data:e||[],enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowActions:!0,enableRowSelection:!0,enableDensityToggle:!1,positionActionsColumn:"last",selectAllMode:"all",initialState:{density:"compact",sorting:[{id:"name",desc:!1}]},state:{isLoading:t,showAlertBanner:a,showProgressBars:s},displayColumnDefOptions:{"mrt-row-select":{maxSize:10},"mrt-row-actions":{header:"Acciones",maxSize:80}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},renderTopToolbarCustomActions:()=>r.jsx(S,{}),renderRowActionMenuItems:Se});return r.jsx(ee,{children:r.jsx(me,{table:l})})}const Ie=M(C.lazy(()=>T(()=>import("./build-0Hx1TqRV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])))),Le=M(C.lazy(()=>T(()=>import("./build-1mZe1oxk.js"),__vite__mapDeps([27,1,2,13,14,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26])))),De=M(C.lazy(()=>T(()=>import("./build-FkOYDjDH.js"),__vite__mapDeps([28,1,2,13,14,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26]))));function ze(){return r.jsx(te,{title:"Administración Comercios",children:r.jsxs(pe,{children:[r.jsx(de,{name:"Comercios",links:[{name:"Inicio",href:re.root},{name:"Administración",href:ne.commerces},{name:ae.commerces.name}]}),r.jsx(Ne,{}),r.jsx(Ie,{}),r.jsx(Le,{}),r.jsx(De,{})]})})}const Ye=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}));export{Me as M,Qe as a,Ke as b,We as c,Ye as d,qe as g,fe as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/build-0Hx1TqRV.js","assets/js/index-mplo7Cy0.js","assets/css/build-pvjN466W.css","assets/js/build-fgcEbVX7.js","assets/js/build-0lw-wv_t.js","assets/js/build-E66JUiqZ.js","assets/js/build-UhUpPKic.js","assets/js/build-nSdaxBfa.js","assets/js/build-D3xC4GbD.js","assets/js/build-Hhkdi4aP.js","assets/js/build-Uc7vb3zK.js","assets/js/build-9Efc2eo3.js","assets/js/build-1LmYI3dU.js","assets/js/build-piimbepB.js","assets/js/build-eQ93QMpk.js","assets/js/build-TesjUH-a.js","assets/js/build-zH8OCAbq.js","assets/js/build-zEF68lUW.js","assets/js/build-A0pkRIS4.js","assets/js/build-oGgHkT3Q.js","assets/js/build-PfoRwXqx.js","assets/js/build-Qg3JQUP_.js","assets/js/build-M7AoVccO.js","assets/js/build-jhrJ8roR.js","assets/js/build-onu4nqUu.js","assets/js/build-yDVAqRjG.js","assets/js/build-yyP470yP.js","assets/js/build-1mZe1oxk.js","assets/js/build-FkOYDjDH.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}