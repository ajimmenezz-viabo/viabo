import{q as h,g as _,a as j,r as b,L as E,_ as A,P as O,o as T}from"./index-B-U8M-8N.js";import{aM as S,aw as M,r as D,e as R,a9 as L,i as s,a4 as F,a6 as f,cc as w,J as z,bO as B,S as y,T as N,x as v}from"./vendor-CEMfbhOc.js";import{M as U}from"./MaterialDataTable-CDmLz-NL.js";import{B as V,a as H}from"./index-BdTlPQ76.js";import{g as k}from"./cardTypes-NmdqE8Eh.js";import{g as K}from"./operationTypes-BbkqNKhX.js";import{L as G}from"./TextMaxLine-D6XZvUuW.js";import{C as Y}from"./cardMovementsAdapter-ocC5swCp.js";import{g as I}from"./crypto--V-xCCVf.js";import{f as $}from"./formatNumber-Df8NwpjV.js";import{f as x}from"./formatTime-mlJJpQBT.js";import{C as W,H as q}from"./HeaderPage-DRv2GeZX.js";const Q=[{id:6,name:"PENDIENTE",color:"warning"},{id:7,name:"PAGADA",color:"primary"},{id:8,name:"CANCELADA",color:"error"},{id:9,name:"LIQUIDADA",color:"success"}],J=t=>{var e;return((e=Q.find(n=>{var a;return n.name===((a=t==null?void 0:t.toLowerCase())==null?void 0:a.toUpperCase())}))==null?void 0:e.color)||"info"},X=t=>Y(t),Z=t=>{var e;return(t==null?void 0:t.statusName)==="Pagada"?(e=t==null?void 0:t.payCashData)==null?void 0:e.date:(t==null?void 0:t.statusName)==="Liquidada"?t==null?void 0:t.conciliationDate:(t==null?void 0:t.statusName)==="Cancelada"?t==null?void 0:t.cancellationDate:t==null?void 0:t.registerDate},P=t=>{var c,o,l,m,C;let e="";t!=null&&t.spei&&(t!=null&&t.referencePayCash)&&t.spei!==""&&t.referencePayCash!==""?e="SPEI,PAYCASH":t!=null&&t.spei&&t.spei!==""?e="SPEI":t!=null&&t.referencePayCash&&t.referencePayCash!==""&&(e="PAYCASH");const n=t!=null&&t.registerDate?S(new Date(t==null?void 0:t.registerDate),"dd MMM yyyy",{locale:M}):"",a=t!=null&&t.registerDate?S(new Date(t==null?void 0:t.registerDate),"p"):"",i=Z(t);return{id:t==null?void 0:t.id,cardId:t==null?void 0:t.cardId,cardNumber:t==null?void 0:t.cardNumber,paymentProcessorName:t==null?void 0:t.paymentProcessorName,paymentMethods:e,referenceNumber:t==null?void 0:t.referenceNumber,amount:$(t==null?void 0:t.amount),status:t==null?void 0:t.statusName,date:t==null?void 0:t.registerDate,registerDate:{fullDate:x(t==null?void 0:t.registerDate),time:a,date:n},spei:t==null?void 0:t.spei,emails:(c=t==null?void 0:t.emails)==null?void 0:c.split(","),conciliatedName:(t==null?void 0:t.conciliated)!=="No"?"Conciliada":"Sin Conciliar",conciliated:(t==null?void 0:t.conciliated)!=="No",conciliationInfo:{number:t==null?void 0:t.conciliationNumber,userId:t==null?void 0:t.conciliationUserId,userName:t==null?void 0:t.conciliationUserName,date:t!=null&&t.conciliationDate?x(t==null?void 0:t.conciliationDate):""},cancelationInfo:{userId:t==null?void 0:t.canceledByUserId,userName:t==null?void 0:t.canceledByUserName,date:t==null?void 0:t.cancellationDate},payCash:t==null?void 0:t.referencePayCash,payCashURLS:t==null?void 0:t.instructionsUrls,paymentInfo:{folio:(o=t==null?void 0:t.payCashData)==null?void 0:o.folio,authorizationCode:(l=t==null?void 0:t.payCashData)==null?void 0:l.authorizationCode,date:(m=t==null?void 0:t.payCashData)!=null&&m.date?x((C=t==null?void 0:t.payCashData)==null?void 0:C.date):""},lastStatusDate:i?x(i):""}},d=t=>{const e=I(t==null?void 0:t.ciphertext,t==null?void 0:t.iv);return P(e)},r=t=>{const e=I(t==null?void 0:t.ciphertext,t==null?void 0:t.iv);return e==null?void 0:e.map(n=>P(n))},tt={LIST:"funding-orders-list",MOVEMENTS:"conciliate-movements",DETAILS:"funding-order-details"},at=async()=>{const{data:t}=await h.get("/api/funding-orders");return r(t)},It=async t=>{const{data:e}=await h.get(`/api/funding-order/${t==null?void 0:t.id}`);return d(e)},Pt=async t=>{const{data:e}=await h.get(`/api/master-card/movements/unreconciled?fundingOrderId=${t==null?void 0:t.id}`);return X(e)},_t=async t=>{const{data:e}=await h.put("/api/funding-order/conciliation",t);return e},jt=async t=>{const{data:e}=await h.put(`/api/funding-order/cancel/${t==null?void 0:t.id}`);return e},et=(t={})=>{const[e,n]=D.useState(null);return{...R([tt.LIST],at,{staleTime:6e4,refetchOnWindowFocus:!1,onError:i=>{const c=_(i,"No se puede obtener las ordenes de fondeo");n(c),L.error(c,{type:j(i)})},...t}),error:e||null}},nt={openConciliateModal:!1,openCancelFundingOrder:!1,openDetailsFundingOrder:!1,fundingOrder:null},st=(t,e)=>({...nt,setOpenConciliateModal:n=>{t(a=>({openConciliateModal:n}),!1,"SET_OPEN_CONCILIATE_MODAL")},setFundingOrder:n=>{t(a=>({fundingOrder:n}),!1,"SET_FUNDING_ORDER")},setOpenCancelFundingOrder:n=>{t(a=>({openCancelFundingOrder:n}),!1,"SET_OPEN_CANCEL_FUNDING_ORDER")},setOpenDetailsFundingOrder:n=>{t(a=>({openDetailsFundingOrder:n}),!1,"SET_OPEN_DETAILS_FUNDING_ORDER")}}),p=b(st);function it(t,e){const{original:n}=t,{status:a}=n,i=a==="Pendiente",c=a==="Pagada",o=p(u=>u.setFundingOrder),l=p(u=>u.setOpenConciliateModal),m=p(u=>u.setOpenCancelFundingOrder),C=p(u=>u.setOpenDetailsFundingOrder),g=[s.jsxs(F,{onClick:()=>{o(n),C(!0),e()},sx:{m:0},children:[s.jsx(f,{children:s.jsx(B,{color:"info"})}),"Ver Detalles"]},0)];return(c||i)&&g.push(s.jsxs(F,{onClick:()=>{o(n),l(!0),e()},sx:{m:0},children:[s.jsx(f,{children:s.jsx(w,{color:"success"})}),"Conciliar"]},1)),i&&g.push(s.jsxs(F,{onClick:()=>{o(n),m(!0),e()},sx:{m:0},children:[s.jsx(f,{children:s.jsx(z,{color:"error"})}),"Cancelar"]},2)),g}const ct=[{accessorKey:"referenceNumber",header:"Referencia",enableHiding:!1,size:100},{accessorKey:"paymentProcessorName",header:"Cuenta",size:100,filterVariant:"multi-select",Cell:({cell:t,column:e,row:n})=>{const{original:a}=n,i=k(a==null?void 0:a.paymentProcessorName),c=i==null?void 0:i.component;return s.jsx(y,{flexDirection:"row",alignItems:"center",gap:1,children:i&&s.jsx(c,{sx:{width:30,height:30}})})}},{accessorKey:"amount",header:"Monto",size:100,Cell:({cell:t,column:e,row:n,renderedCellValue:a})=>s.jsx(N,{variant:"subtitle2",fontWeight:"bold",children:a})},{accessorKey:"date",header:"Fecha",size:100,Cell:({cell:t,column:e,row:n})=>{var i,c;const{original:a}=n;return s.jsxs(y,{children:[s.jsx(N,{variant:"subtitle2",children:(i=a==null?void 0:a.registerDate)==null?void 0:i.date}),s.jsx(N,{variant:"body2",sx:{color:"text.secondary"},children:(c=a==null?void 0:a.registerDate)==null?void 0:c.time})]})}},{accessorKey:"paymentMethods",header:"Método(s)",size:120,filterVariant:"multi-select",Cell:({cell:t,column:e,row:n})=>{var o;const{original:a}=n,i=[],c=((o=a==null?void 0:a.paymentMethods)==null?void 0:o.split(","))||[];return c==null||c.forEach(l=>{const m=K(l);m&&i.push({component:m==null?void 0:m.component,width:l==="PAYCASH"?50:30,height:l==="PAYCASH"?50:30})}),s.jsx(y,{flexDirection:"row",alignItems:"center",gap:1,children:i==null?void 0:i.map(({component:l,width:m,height:C},g)=>s.jsx(l,{sx:{width:m,height:C}},g))})}},{accessorKey:"status",header:"Estado",filterVariant:"multi-select",size:100,Cell:({cell:t,column:e,row:n})=>{const{original:a}=n,i=J(a==null?void 0:a.status);return s.jsx(y,{flexDirection:"row",alignItems:"center",gap:1,children:s.jsx(G,{variant:"ghost",color:i,sx:{textTransform:"capitalize"},children:a==null?void 0:a.status})})}},{accessorKey:"conciliatedName",header:"¿Conciliada?",filterVariant:"multi-select",size:80,Cell:({cell:t,column:e,row:n})=>{const{original:a}=n;return s.jsx(y,{flexDirection:"row",width:1,justifyContent:"center",alignItems:"center",mr:2,gap:1,color:"primary",children:a!=null&&a.conciliated?s.jsx(V,{color:"green",fontWeight:"bold",fontSize:"18px"}):s.jsx(H,{fontSize:"18px",color:"red"})})}}],lt=()=>{const{data:t,isError:e,isLoading:n,isFetching:a,error:i}=et(),c=ct;return s.jsx(v,{children:s.jsx(U,{enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowActions:!0,enableRowSelection:!0,positionActionsColumn:"last",enableDensityToggle:!1,columns:c,data:t||[],isError:e,textError:i,selectAllMode:"all",initialState:{density:"compact",sorting:[{id:"date",desc:!0}]},state:{isLoading:n,showAlertBanner:e,showProgressBars:a},displayColumnDefOptions:{"mrt-row-actions":{header:"Acciones",maxSize:80},"mrt-row-select":{maxSize:10}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},renderRowActionMenuItems:({closeMenu:o,row:l})=>it(l,o)})})},ot=E(D.lazy(()=>A(()=>import("./ConciliateModal-BAuaFQFQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])))),mt=E(D.lazy(()=>A(()=>import("./CancelFundingOrder-CfHHmMaE.js"),__vite__mapDeps([27,1,2,3,19,9,11,12,4,5,6,7,8,13,14,15,16,17,18,20,21,22,23,24,25,26])))),ut=E(D.lazy(()=>A(()=>import("./FundingOrderDetails-BVLrMVqv.js"),__vite__mapDeps([28,1,11,12,2,3,13,14,15,16,17,18,19,20,21,22,23,9,4,5,6,7,8,24,25,26])))),pt=()=>{const t=p(a=>a.openConciliateModal),e=p(a=>a.openCancelFundingOrder),n=p(a=>a.openDetailsFundingOrder);return s.jsx(O,{title:"Órdenes de Fondeo",children:s.jsxs(W,{children:[s.jsx(q,{name:"Órdenes de Fondeo",links:[{name:"Inicio",href:T.root},{name:"Órdenes de Fondeo"}]}),s.jsx(lt,{}),t&&s.jsx(ot,{}),e&&s.jsx(mt,{}),n&&s.jsx(ut,{})]})})},bt=Object.freeze(Object.defineProperty({__proto__:null,default:pt},Symbol.toStringTag,{value:"Module"}));export{tt as F,jt as a,J as b,_t as c,It as d,bt as e,Pt as g,p as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/ConciliateModal-BAuaFQFQ.js","assets/js/vendor-CEMfbhOc.js","assets/js/index-B-U8M-8N.js","assets/css/build-Bl0dWaDY.css","assets/js/cardTypes-NmdqE8Eh.js","assets/js/AmexLogo-DsyshqEq.js","assets/js/CarnetLogo-BssSE0Ex.js","assets/js/MasterCardLogo-Bcn9gvbj.js","assets/js/VisaLogo-ByWQmEg7.js","assets/js/MaterialDataTable-CDmLz-NL.js","assets/js/useMaterialTable-9wOa4uxn.js","assets/js/index-BdTlPQ76.js","assets/js/iconBase-D_ql85QS.js","assets/js/operationTypes-BbkqNKhX.js","assets/js/viabo-card-CcTpX9JZ.js","assets/js/viabo-pay-Tb0TUikx.js","assets/js/TextMaxLine-D6XZvUuW.js","assets/js/formik.esm-Dshy1xjd.js","assets/js/formatTime-mlJJpQBT.js","assets/js/matchTypes-BFKCRNnN.js","assets/js/UploadSingleFile-B0jkdwVt.js","assets/js/fade-CViozI82.js","assets/js/transition-anLY3gj9.js","assets/js/formatNumber-Df8NwpjV.js","assets/js/cardMovementsAdapter-ocC5swCp.js","assets/js/crypto--V-xCCVf.js","assets/js/HeaderPage-DRv2GeZX.js","assets/js/CancelFundingOrder-CfHHmMaE.js","assets/js/FundingOrderDetails-BVLrMVqv.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=FundingOrders-BUVI52IW.js.map
