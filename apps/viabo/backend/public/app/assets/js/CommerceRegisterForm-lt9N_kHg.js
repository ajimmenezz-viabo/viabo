import{t as $,r as C,c as D,f as H,P as Q,i as e,V as h,T as f,Q as U,B as K,bN as x,aX as b,dk as X,I as E,bI as A,bM as T,dQ as z,ba as G,aH as N,a5 as I,a0 as Y,O as Z}from"./vendor-pMbAJ2vN.js";import{u as J}from"./formik.esm-EswYUHaB.js";import{l as ee}from"./mui-tel-input.es-B0TASf-x.js";import{C as re,c as oe,p as se}from"./CommerceRegister-VElUGsI1.js";import{g as ae,$ as k}from"./index-4lAQqZtp.js";import{P as j}from"./processList-0DUGlmod.js";import{c as ne,a as m,e as te,f as ie}from"./index.esm-EW845fRj.js";import{A as le}from"./AlertWithFocus-oyQcWneR.js";const ce=t=>{const{name:i,lastName:c,phone:a,email:d,password:g,confirmPassword:u}=t;return{name:i,lastname:c,phone:a,email:d,password:g,confirmPassword:u}},me=(t={})=>{const{enqueueSnackbar:i}=$(),[c,a]=C.useState(null),d=D();return{...H(oe,{onSuccess:()=>{a(null),d.removeQueries([re.TOKEN_COMMERCE]),i("Se creo el comercio",{variant:"success",autoHideDuration:5e3})},onError:u=>{a(ae(u,"No se puede crear el comercio"))},...t}),error:c||null}},de=t=>({schema:ne({name:m().required("El nombre es requerido"),lastName:m().required("Los apellidos son requeridos"),email:m().email("Ingresa un correo valido").required("El correo es requerido"),phone:m().required("El telefono es requerido").test("longitud","El telefono es muy corto",a=>!(a&&a.replace(/[\s+]/g,"").length<10)),password:m().required("La contraseña es requerida").matches("^(?=(?:.*\\d))(?=.*[A-Z])(?=.*[a-z])(?=.*[_\\-.\\@])\\S{8,16}$","La contraseña debe contener al menos 8 caracteres, una mayúscula, una minúscula , un número y un caracter especial [ - _ . @]"),confirmPassword:m().oneOf([te("password"),null],"Las contraseñas no coinciden").required("La confirmación de la contraseña es requerida"),terms:ie().oneOf([!0],"Debe aceptar los acuerdos y condiciones")}),initialValues:{name:"",lastName:"",phone:"",email:"",password:"",confirmPassword:"",terms:!1}});ue.propTypes={store:Q.shape(se)};function ue({store:t}){const[i,c]=C.useState(!1),[a,d]=C.useState(!1),{schema:g,initialValues:u}=C.useMemo(()=>de(),[t]),{setActualProcess:P,setLastProcess:v}=t,{mutate:R,isError:S,isLoading:L,error:O}=me(),q=J({initialValues:u,validationSchema:g,onSubmit:l=>{const w=ce(l),{email:W}=w;R(w,{onSuccess:()=>{P(j.VALIDATION_CODE),v({info:{email:W},name:j.REGISTER}),y(!1)},onError:()=>{y(!1)}})}}),{handleSubmit:B,values:s,errors:r,touched:o,handleChange:p,isSubmitting:V,setSubmitting:y,getFieldProps:_,setFieldValue:F}=q,n=L||V,M=()=>{P(j.CONTINUE_PROCESS)};return e.jsxs(e.Fragment,{children:[e.jsxs(h,{direction:"column",width:1,spacing:1,children:[e.jsx(f,{variant:"h4",color:"textPrimary",align:"center",children:"Registrar Comercio"}),e.jsx(f,{paragraph:!0,align:"center",variant:"body1",color:"text.secondary",whiteSpace:"pre-line",children:"Ingrese la información para iniciar con el proceso de registro."})]}),S&&e.jsxs(le,{listenElement:S,sx:{mt:3,textAlign:"initial"},severity:"warning",children:[e.jsx(U,{sx:{textAlign:"initial"},children:"Error al registrar el comercio"}),O]}),e.jsx(K,{width:1,mt:4,component:"form",onSubmit:B,children:e.jsxs(h,{spacing:3,pb:5,direction:"column",children:[e.jsxs(h,{direction:{xs:"column",sm:"row"},spacing:3,children:[e.jsx(x,{fullWidth:!0,name:"name",label:"Nombre(s)",autoComplete:"on",autoFocus:!0,value:s.name,error:o.name&&!!r.name,helperText:o.name&&r.name,onChange:p,disabled:n}),e.jsx(x,{fullWidth:!0,name:"lastName",label:"Apellidos",value:s.lastName,error:o.lastName&&!!r.lastName,helperText:o.lastName&&r.lastName,onChange:p,disabled:n})]}),e.jsxs(h,{direction:{xs:"column",sm:"row"},spacing:3,children:[e.jsx(x,{fullWidth:!0,id:"email",name:"email",label:"Correo",placeholder:"usuario@dominio.com",value:s.email,onChange:p,error:o.email&&!!r.email,helperText:o.email&&r.email,disabled:n,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(X,{})})}}),e.jsx(ee,{name:"phone",fullWidth:!0,langOfCountryName:"es",preferredCountries:["MX","US"],continents:["NA","SA"],value:s.phone||"+52",disabled:n,onChange:(l,w)=>{F("phone",l)},error:o.phone&&!!r.phone,helperText:o.phone&&r.phone})]}),e.jsx(x,{fullWidth:!0,id:"password",name:"password",label:"Contraseña",placeholder:"********",type:i?"text":"password",autoComplete:"current-password",InputProps:{endAdornment:e.jsx(b,{position:"end",sx:{mr:1},children:e.jsx(E,{edge:"end",onClick:()=>c(l=>!l),children:i?e.jsx(A,{}):e.jsx(T,{})})})},value:s.password,onChange:p,error:o.password&&!!r.password,helperText:o.password&&r.password,disabled:n}),e.jsx(x,{fullWidth:!0,id:"confirmPassword",name:"confirmPassword",label:"Confirmar Contraseña",placeholder:"********",type:a?"text":"password",autoComplete:"current-password",InputProps:{endAdornment:e.jsx(b,{position:"end",sx:{mr:1},children:e.jsx(E,{edge:"end",onClick:()=>d(l=>!l),children:a?e.jsx(A,{}):e.jsx(T,{})})})},value:s.confirmPassword,onChange:p,error:o.confirmPassword&&!!r.confirmPassword,helperText:o.confirmPassword&&r.confirmPassword,disabled:n}),e.jsxs(h,{direction:"column",justifyContent:"center",alignItems:"center",spacing:{xs:1,md:0},children:[e.jsx(z,{control:e.jsx(G,{..._("terms"),disabled:n,checked:s==null?void 0:s.terms,value:s==null?void 0:s.terms}),label:e.jsxs(f,{variant:"body2",align:"center",sx:{color:"text.secondary"},children:["He leído y acepto los  ",e.jsx(N,{component:I,underline:"always",color:"info.main",to:k.policies,target:"_blank",children:"Términos y condiciones"}),"  &  ",e.jsx(N,{component:I,underline:"always",color:"info.main",to:k.privacy,target:"_blank",children:"Acuerdos de privacidad"}),"."]})}),!!r.terms&&o.terms&&e.jsx(f,{variant:"caption",color:"error",children:r.terms})]}),e.jsx(Y,{loading:n,color:"primary",variant:"contained",fullWidth:!0,type:"submit",sx:{textTransform:"uppercase"},children:"Registrar"}),e.jsx(Z,{onClick:M,children:">> Continuar proceso"})]})})]})}export{ue as default};
//# sourceMappingURL=CommerceRegisterForm-lt9N_kHg.js.map
