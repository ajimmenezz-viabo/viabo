import{c as B,f as R,a9 as T,s as I,P as f,a as k,i as o,V as c,T as h,m as A,B as v,a0 as D}from"./vendor-StReGf79.js";import{u as P}from"./formik.esm-ayHIcoJR.js";import{c as C,a as N}from"./index.esm-cYP9oANf.js";import{g as O,a as V}from"./index-mKe_odg3.js";import{i as F}from"./matchTypes-VzXr5CmM.js";import{T as w}from"./tickets-support-list-keys-ThL685Ct.js";import{n as W}from"./TicketSupportDrawer-8PnL9Vmk.js";import{F as z,R as G,d as _}from"./TextMaxLine-Nybdgfc_.js";import"./UploadSingleFile-NVjHNA2_.js";import"./fade-HpdRXKiE.js";import"./transition-Uc7vb3zK.js";import"./formatNumber-D2wM-uoj.js";const M=r=>{var a,i;const t=new FormData,s={supportReasonId:(a=r==null?void 0:r.cause)==null?void 0:a.id,description:r==null?void 0:r.description};return(i=Object.entries(s))==null||i.forEach(([p,l])=>{t.append(p,l)}),r!=null&&r.file&&t.append("files",r==null?void 0:r.file),t},Q=(r={})=>{const t=B(),s=R(W,r);return{...s,mutate:async(i,p)=>{const{onSuccess:l,onError:m,mutationOptions:n}=p;try{const u=await T.promise(s.mutateAsync(i,n),{pending:"Generando ticket de soporte ...",success:{render({data:d}){return F(l)&&l(d),"Se genero el ticket con éxito"}}});t.invalidateQueries([w.ASSIGNED_LIST]),t.invalidateQueries([w.GENERATED_LIST])}catch(u){const d=O(u,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");F(m)&&m(d),T.error(d,{type:V(u)})}}}},S=r=>r?parseInt(r.replace(/^#/,""),16)>16777215/2?"black":"white":null,$=I("span")(({theme:r,ownerState:t})=>{const s=r.palette.mode==="light",{color:a,variant:i}=t,p=n=>({color:S(n)||r.palette.text.primary,backgroundColor:n}),l=n=>({color:S(n)||r.palette.text.primary,backgroundColor:"transparent",border:`1px solid ${n}`}),m=n=>({color:S(n)||r.palette.text.primary,backgroundColor:n?k(n,.6):"inherit"});return{height:22,minWidth:22,lineHeight:0,borderRadius:8,cursor:"default",alignItems:"center",whiteSpace:"nowrap",display:"inline-flex",justifyContent:"center",padding:r.spacing(0,1),color:r.palette.grey[800],fontSize:r.typography.pxToRem(12),fontFamily:r.typography.fontFamily,backgroundColor:r.palette.grey[300],fontWeight:r.typography.fontWeightBold,...a!=="default"?{...i==="filled"&&{...p(a)},...i==="outlined"&&{...l(a)},...i==="ghost"&&{...m(a)}}:{...i==="outlined"&&{backgroundColor:"transparent",color:r.palette.text.primary,border:`1px solid ${r.palette.grey[50032]}`},...i==="ghost"&&{color:s?r.palette.text.secondary:r.palette.common.white,backgroundColor:r.palette.grey[50016]}}}});E.propTypes={children:f.node,color:f.string,variant:f.oneOf(["filled","outlined","ghost"])};function E({color:r="default",variant:t="ghost",children:s,...a}){return o.jsx($,{ownerState:{color:r,variant:t},...a,children:s})}const q=({causes:r=[],onSuccess:t})=>{var j;const{mutate:s,isLoading:a}=Q(),i=C().shape({cause:C().nullable().required("La causa es necesaria"),description:N().trim().max(200,"Máximo 200 caracteres").required("La descripción del ticket es necesaria")}),p=P({initialValues:{cause:null,description:"",file:null},validationSchema:i,onSubmit:(e,{setSubmitting:g,setFieldValue:y})=>{const x=M(e);s(x,{onSuccess:()=>{g(!1),t()},onError:()=>{g(!1)}})}}),{values:l,setFieldValue:m,setTouched:n,isSubmitting:u,errors:d}=p,b=u||a,L=e=>{m("cause",e)};return o.jsx(z,{formik:p,children:o.jsxs(c,{spacing:2,children:[o.jsxs(c,{spacing:1,children:[o.jsx(h,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Seleccione una Causa"}),o.jsx(c,{flexDirection:"row",flexWrap:"wrap",gap:1,children:r==null?void 0:r.map(e=>{var y;const g=((y=l.cause)==null?void 0:y.id)===(e==null?void 0:e.id);return o.jsx(E,{variant:g?"ghost":"filled",color:e==null?void 0:e.color,sx:{textTransform:"uppercase",marginRight:1,marginBottom:2,cursor:"pointer",...!(e!=null&&e.color)&&{border:"2px dashed",borderColor:x=>x.palette.text.disabled},...g&&{border:"3px solid",borderColor:x=>x.palette.primary.main}},children:o.jsx(A.div,{onClick:()=>L(e),whileHover:{scale:1.03},whileTap:{scale:.8},children:e==null?void 0:e.cause},e==null?void 0:e.id)},e==null?void 0:e.id)})}),o.jsxs(c,{spacing:1,children:[o.jsxs(h,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Causa:"," ",o.jsx(v,{component:"span",color:"error.main",children:"*"})]}),o.jsx(h,{fontWeight:"bold",color:d.cause?"error.main":"text.primary",variant:"subtitle1",children:((j=l.cause)==null?void 0:j.cause)||d.cause})]})]}),o.jsxs(c,{spacing:1,children:[o.jsxs(h,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Descripción"," ",o.jsx(v,{component:"span",color:"error.main",children:"*"})]}),o.jsx(G,{size:"small",name:"description",multiline:!0,rows:4,disabled:b,inputProps:{maxLength:"200"},placeholder:"Descripción del ticket..."})]}),o.jsxs(c,{spacing:1,children:[o.jsx(h,{variant:"overline",sx:{color:"text.disabled",width:1},children:"Archivo (Max - 3MB):"}),o.jsx(_,{name:"file",maxSize:3145728,accept:{"image/*":[".jpeg",".jpg",".png"],"application/pdf":[".pdf"]}})]}),o.jsx(c,{sx:{pt:1},children:o.jsx(D,{loading:b,variant:"contained",size:"large",color:"primary",fullWidth:!0,type:"submit",children:"Generar Ticket"})})]})})};q.propTypes={causes:f.array,onSuccess:f.func};export{q as default};
//# sourceMappingURL=TicketSupportForm-ip1Jp-CX.js.map
