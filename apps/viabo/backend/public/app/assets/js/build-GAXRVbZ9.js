import{z as T,j as e,an as P,K as j,aO as b,O as m,r as h,al as L,S as p,T as c,B as v,am as g,E as z,a2 as I,aP as D,d as w,g as N,N as V,P as H,ae as R,aQ as k,aR as B,C as y,_ as M}from"./index-ixKXqnJp.js";import{V as F}from"./build-Xb7BDARj.js";import{P as U}from"./build-nRrF_AoO.js";import{L as _}from"./build-VQrlUuND.js";import{L as W}from"./build-pdsvphlv.js";import{g as G}from"./build-N8x3nlwn.js";import{M as $,C as K}from"./build-c128-zuA.js";import{M as Q,C as q,H as Y}from"./build-LwbiozbY.js";import{u as J}from"./build-LAyEB08K.js";const X=T(e.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"}),"LibraryAdd"),Z={commerce:null,openCommerceDetails:!1,openCommerceCommissions:!1,openCommerceServices:!1},ee=(s,t)=>({...Z,setCommerce:o=>{s(r=>({commerce:o}))},setOpenCommerceDetails:o=>{s(r=>({openCommerceDetails:o}),!1,"SET_OPEN_COMMERCE_DETAILS")},setOpenCommerceCommissions:o=>{s(r=>({openCommerceCommissions:o}),!1,"SET_OPEN_COMMERCE_COMMISSIONS")},setOpenCommerceServices:o=>{s(r=>({openCommerceServices:o}),!1,"SET_OPEN_COMMERCE_SERVICES")}}),se=P(ee);function re(s){const{row:t,closeMenu:o}=s,{original:r}=t,{setCommerce:n,setOpenCommerceDetails:i,setOpenCommerceCommissions:a,setOpenCommerceServices:d}=se(u=>u);return[e.jsxs(j,{onClick:()=>{n(r),i(!0),o()},sx:{m:0},children:[e.jsx(b,{children:e.jsx(F,{color:"info"})}),"Ver Detalles"]},"details"),e.jsxs(j,{onClick:()=>{n(r),a(!0),o()},sx:{m:0},children:[e.jsx(b,{children:e.jsx(U,{color:"primary"})}),"Comisiones"]},"commissions"),e.jsxs(j,{onClick:()=>{n(r),d(!0),o()},sx:{m:0},children:[e.jsx(b,{children:e.jsx(X,{})}),"Servicios"]},"services")]}const A=({open:s,anchorEl:t,handlePopoverClose:o,data:r})=>{var n;return r?e.jsx(L,{id:"mouse-over-popover",sx:{pointerEvents:"none"},open:s,anchorEl:t,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},onClose:o,disableRestoreFocus:!0,slotProps:{paper:{sx:{mt:1.5,ml:.5,overflow:"inherit",boxShadow:i=>i.customShadows.z20,border:i=>`solid 1px ${i.palette.grey[5008]}`,width:200}}},children:e.jsxs(p,{spacing:2,p:2,children:[e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.name)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.phone)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Fecha Registro:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.register)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Último Inicio de Sesión:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.lastLogged)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Estado:"}),e.jsx(v,{children:e.jsx(_,{variant:"ghost",color:((n=r==null?void 0:r.status)==null?void 0:n.toLowerCase())==="activo"?"success":"error",sx:{textTransform:"uppercase"},children:(r==null?void 0:r.status)??"-"})})]})]})}):null};A.propTypes={anchorEl:m.any,data:m.shape({lastLogged:m.string,name:m.string,phone:m.string,register:m.string,status:m.string}),handlePopoverClose:m.any,open:m.any};const te=h.memo(A),O=({row:s})=>{var a;const[t,o]=h.useState(null),r=d=>{o(d.currentTarget)},n=()=>{o(null)},i=!!t;return e.jsxs(e.Fragment,{children:[e.jsx(te,{anchorEl:t,open:i,handlePopoverClose:n,data:s==null?void 0:s.account}),e.jsx(v,{sx:{display:"flex",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:1},children:e.jsx(W,{color:"info.main",sx:{cursor:"auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},underline:"none",variant:"subtitle2",component:c,"aria-owns":i?"mouse-over-popover":void 0,"aria-haspopup":"true",onMouseEnter:d=>{r(d)},onMouseLeave:n,children:(a=s==null?void 0:s.account)==null?void 0:a.name})})]})};O.propTypes={row:m.shape({account:m.shape({name:m.any})})};const oe={COMMERCE_LIST:"commerceList",COMMERCE_DETAILS:"commerce-details"},ne=async()=>{const{data:s}=await g.get("/api/commerces");return $(s)},ye=async s=>{const{data:t}=await g.get(`/api/commerce/${s}`);return K(t)},Me=async s=>{const{data:t}=await g.post("/api/commerce/commissions/register",s);return t},_e=async s=>{const{data:t}=await g.post("/api/backoffice/commerce/update",s);return t},Ae=async s=>{const{data:t}=await g.put("/api/backoffice/commerce/service/update",s);return t},ie=[{id:1,name:"Registro",color:"info"},{id:2,name:"Validacion",color:"warning"},{id:3,name:"Afiliacion",color:"primary"},{id:4,name:"Cancelado",color:"error"}],ae=s=>{var t;return((t=ie.find(o=>o.id.toString()===s.toString()))==null?void 0:t.color)||"info"},ce=()=>h.useMemo(()=>[{id:"name",accessorKey:"name",header:"Nombre",enableHiding:!1,size:150,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>e.jsx(c,{fontWeight:"bold",variant:"subtitle2",children:r})},{id:"legalRepresentative",accessorFn:s=>{var t;return(t=s==null?void 0:s.account)==null?void 0:t.name},header:"Representante Legal",size:100,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>{const{original:n}=o;return e.jsx(O,{row:n})}},{id:"services",accessorFn:s=>{var t,o;return(o=(t=s==null?void 0:s.services)==null?void 0:t.names)==null?void 0:o.toString()},header:"Servicios",Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>{var a,d;const{original:n}=o,i=[];return(d=(a=n==null?void 0:n.services)==null?void 0:a.names)==null||d.forEach(l=>{const u=G(l);u&&i.push({component:u==null?void 0:u.component,name:l,width:l==="NUBE"?20:25,height:l==="NUBE"?20:25,color:l==="NUBE"?"primary.main":"inherit"})}),e.jsxs(p,{flexDirection:"row",alignItems:"center",gap:1,divider:e.jsx(z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"double"}}),children:[(i==null?void 0:i.length)===0&&e.jsx(c,{variant:"subtitle2",fontWeight:"bold",color:"warning.main",children:"Sin Servicios"}),i==null?void 0:i.map(({component:l,width:u,height:S,name:E,color:f},x)=>e.jsx(I,{title:E,children:e.jsx(v,{display:"flex",children:e.jsx(l,{sx:{width:u,height:S,color:f}})})},x))]})}},{id:"register-status",accessorFn:s=>{var t;return(t=s==null?void 0:s.status)==null?void 0:t.step},header:"Estado Registro",minSize:100,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>e.jsx(p,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.jsx(c,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variant:"subtitle2",title:r,children:r})})},{id:"status",accessorFn:s=>{var t;return(t=s==null?void 0:s.status)==null?void 0:t.name},header:"Estado",size:70,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>{var i,a;const{original:n}=o;return e.jsx(p,{children:e.jsx(_,{size:"sm",variant:"filled",color:ae((i=n==null?void 0:n.status)==null?void 0:i.id),sx:{textTransform:"uppercase"},children:(a=n==null?void 0:n.status)==null?void 0:a.name})})}}],[]),le=(s={})=>{const{enqueueSnackbar:t}=D(),[o,r]=h.useState(null);return{...w([oe.COMMERCE_LIST],ne,{staleTime:60*5e3,onError:i=>{const a=N(i,"No se puede obtener la lista de comercios");r(a),t(a,{variant:"error",autoHideDuration:5e3})},...s}),error:o||null}};function me(){const{data:s,isLoading:t,isError:o,error:r,isFetching:n}=le(),i=ce(),a=J(o,r,{columns:i,data:s||[],enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowActions:!0,enableRowSelection:!0,enableDensityToggle:!1,positionActionsColumn:"last",selectAllMode:"all",initialState:{density:"compact",sorting:[{id:"name",desc:!1}]},state:{isLoading:t,showAlertBanner:o,showProgressBars:n},displayColumnDefOptions:{"mrt-row-select":{maxSize:10},"mrt-row-actions":{header:"Acciones",maxSize:80}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},enableColumnResizing:!0,layoutMode:"grid",renderTopToolbarCustomActions:()=>e.jsx(v,{}),renderRowActionMenuItems:re}),d=(l=1)=>{const u=a.refs.tableContainerRef.current.offsetWidth,S=a.getState().density==="spacious"?40:a.getState().density==="comfortable"?32:16,E=20;let f=0;const x=a.getAllColumns();for(let C=0;C<x.length;C++)f+=x[C].getSize()+S,f+E>u?C>l&&x[C].toggleVisibility(!1):x[C].toggleVisibility(!0)};return h.useEffect(()=>{d(3);function l(){d(3)}window.addEventListener("resize",l)},[a,a.getState().density]),e.jsx(V,{children:e.jsx(Q,{table:a})})}const de=y(h.lazy(()=>M(()=>import("./build-3hBIboKw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29])))),ue=y(h.lazy(()=>M(()=>import("./build-sTnfC4Dc.js"),__vite__mapDeps([30,1,2,13,14,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29])))),pe=y(h.lazy(()=>M(()=>import("./build-wwiunAM6.js"),__vite__mapDeps([31,1,2,13,14,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]))));function he(){return e.jsx(H,{title:"Administración Comercios",children:e.jsxs(q,{children:[e.jsx(Y,{name:"Comercios",links:[{name:"Inicio",href:R.root},{name:"Administración",href:k.commerces},{name:B.commerces.name}]}),e.jsx(me,{}),e.jsx(de,{}),e.jsx(ue,{}),e.jsx(pe,{})]})})}const Oe=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"}));export{oe as M,_e as a,Me as b,Ae as c,Oe as d,ye as g,se as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/build-3hBIboKw.js","assets/js/index-ixKXqnJp.js","assets/css/build-pvjN466W.css","assets/js/build-VQrlUuND.js","assets/js/build-etstWp0g.js","assets/js/build-GywV9psu.js","assets/js/build-YOvIjgAO.js","assets/js/build-0U7rJSAM.js","assets/js/build-KbTEeZ86.js","assets/js/build-3mvdD2lh.js","assets/js/build-Uc7vb3zK.js","assets/js/build-6YIPcFHU.js","assets/js/build-pdsvphlv.js","assets/js/build-Xb7BDARj.js","assets/js/build-nRrF_AoO.js","assets/js/build-N8x3nlwn.js","assets/js/build-zH8OCAbq.js","assets/js/build-zEF68lUW.js","assets/js/build-c128-zuA.js","assets/js/build-0DUGlmod.js","assets/js/build-FAvjNavH.js","assets/js/build-dm4yWFPt.js","assets/js/build-oHIjvIrR.js","assets/js/build-LwbiozbY.js","assets/js/build-ZOc5AsDV.js","assets/js/build-M__DqRBL.js","assets/js/build-QRts0fGp.js","assets/js/build-lj6x1nL8.js","assets/js/build-LPvWp5h1.js","assets/js/build-LAyEB08K.js","assets/js/build-sTnfC4Dc.js","assets/js/build-wwiunAM6.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}