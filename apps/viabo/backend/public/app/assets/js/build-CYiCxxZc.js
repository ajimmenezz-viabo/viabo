import{a as b,d7 as z,Q as P,g as q,b as F,a7 as A,j as e,S as s,a0 as S,h as N,B as v,T as d,L,O as T}from"./index-31hWdJRI.js";import{u as E}from"./build-gnF2i0Ts.js";import{h as B}from"./build-0ei0W4Cu.js";import{c as R,a as u,d as $}from"./build-uEnCB0Kv.js";import{i as f,m as k}from"./build-sfA6zjcU.js";import{F as I}from"./build-DdoBiVJn.js";import{R as x}from"./build-FRN50ysx.js";import"./build-bWikoT0N.js";import"./build-JN0lDpws.js";import"./build-d41d2PYV.js";import"./build-nZbDWYvm.js";import"./build-o4hv-yMn.js";import"./build-Uc7vb3zK.js";import"./build-j8prt7ez.js";import"./build-nC7ityK5.js";import"./build-wMUFPvru.js";import"./build-VAF321fR.js";import"./build-Rh4qk5tL.js";const O=r=>({code:r==null?void 0:r.authCode,currentPassword:r==null?void 0:r.currentPassword,newPassword:r==null?void 0:r.newPassword,confirmPassword:r==null?void 0:r.verifyNewPassword}),W=(r={})=>{const a=b(z,r);return{...a,mutate:async(m,p)=>{const{onSuccess:i,onError:l,mutationOptions:h}=p;try{await P.promise(a.mutateAsync(m,h),{pending:"Actualizando Contraseña ...",success:{render({data:o}){return f(i)&&i(o),"Se actualizo la contraseña con éxito"}}})}catch(o){const n=q(o,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");f(l)&&l(n),P.error(n,{type:F(o)})}}}},V=({onSuccess:r})=>{const a=A(),{mutate:w,isLoading:m}=W(),p=R().shape({currentPassword:u().trim().required("La contraseña actual es requerida"),newPassword:u().trim().required("La contraseña nueva es requerida").matches("^(?=(?:.*\\d))(?=.*[A-Z])(?=.*[a-z])(?=.*[_\\-.\\@])\\S{8,16}$","La contraseña debe contener al menos 8 caracteres, una mayúscula, una minúscula , un número y un carácter especial [ - _ . @]"),verifyNewPassword:u().trim().oneOf([$("newPassword"),null],"Las contraseñas no coinciden").required("La confirmación de la contraseña es requerida"),authCode:u().required("El código de autorización es requerido")}),i=E({initialValues:{currentPassword:"",newPassword:"",verifyNewPassword:"",authCode:""},enableReinitialize:!0,validationSchema:p,onSubmit:(c,{setSubmitting:g,setFieldTouched:_})=>{const y=O(c);w(y,{onSuccess:()=>{g(!1),r()},onError:()=>{g(!1)}})}}),{isSubmitting:l,setFieldValue:h,values:o,errors:n}=i,t=l||m,j=c=>{h("authCode",c)},C=c=>k(c);return e.jsx(I,{formik:i,children:e.jsxs(s,{spacing:2,p:3,children:[e.jsxs(S,{severity:"info",children:[e.jsx(N,{children:"Código de Autorización"}),"Enviamos un correo electrónico a"," ",e.jsxs(v,{component:"span",fontWeight:"bold",children:[a==null?void 0:a.email," "]}),"con el código de autorización."]}),e.jsxs(s,{spacing:1,children:[e.jsx(d,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Contraseña Actual *"}),e.jsx(x,{size:"small",name:"currentPassword",disabled:t,required:!0,placeholder:"********"})]}),e.jsxs(s,{spacing:1,children:[e.jsx(d,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Contraseña Nueva *"}),e.jsx(x,{size:"small",name:"newPassword",placeholder:"********",disabled:t,required:!0})]}),e.jsxs(s,{spacing:1,children:[e.jsx(d,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Repetir Contraseña Nueva *"}),e.jsx(x,{size:"small",placeholder:"********",name:"verifyNewPassword",disabled:t,required:!0})]}),e.jsxs(s,{spacing:1,children:[e.jsx(d,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Código de Autorización *"}),e.jsxs(s,{children:[e.jsx(B,{length:6,value:o.authCode,onChange:j,validateChar:C,sx:{gap:{xs:1.5,sm:2,md:3}},TextFieldsProps:{placeholder:"-",error:!!n.authCode,disabled:t,size:"small"}}),!!n.authCode&&e.jsx(v,{mt:1,children:e.jsx(d,{variant:"caption",color:"error",children:n.authCode})})]})]}),e.jsx(s,{pt:2,children:e.jsx(L,{loading:t,variant:"contained",color:"primary",fullWidth:!0,type:"submit",sx:{fontWeight:"bold"},children:"Guardar"})})]})})};V.propTypes={onSuccess:T.func};export{V as default};
