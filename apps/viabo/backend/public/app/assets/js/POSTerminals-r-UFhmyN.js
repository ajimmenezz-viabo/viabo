import{q as R,g as xe,r as ge,a as Le,j as se,_ as ae,E as Pe,l as Ae,m as Be,n as De,S as Fe,L as ke,P as Re,o as Ne,t as Ve,v as ze}from"./index-B-U8M-8N.js";import{r as p,i as e,B as w,a3 as ne,A as ye,b3 as He,aQ as Ye,b4 as We,T as f,S as x,aM as N,aw as ie,e as je,b5 as Ge,b6 as $e,a9 as fe,P as y,b7 as Ke,b8 as X,b9 as Ue,a4 as Y,ba as Qe,a7 as Xe,bb as qe,bc as Je,s as be,bd as Ze,a0 as oe,be as le,I as q,bf as ce,x as J,U as Ce,X as Z,O as ve,Q as W,b1 as me,bg as et,aF as G,m as V,bh as tt,bi as st,a as at,bj as v,aa as nt,aT as rt,aU as it,bk as Te,bl as ot,aV as lt,aW as ct,aX as dt,aY as ut,u as ht,V as de}from"./vendor-CEMfbhOc.js";import{B as pt,a as xt}from"./index-BdTlPQ76.js";import{g as gt,a as yt}from"./cardTypes-NmdqE8Eh.js";import{g as jt}from"./csv-BGNpG_Xb.js";import{f as m}from"./formatNumber-Df8NwpjV.js";import{n as z,m as ee}from"./formatTime-mlJJpQBT.js";import{C as ft}from"./cardMovementsAdapter-ocC5swCp.js";import{L as bt,I as Ct}from"./TextMaxLine-D6XZvUuW.js";import{M as Tt,b as St,S as wt,c as Mt,a as Et,F as It}from"./MaterialDataTable-CDmLz-NL.js";import{v as A,a as B}from"./transition-anLY3gj9.js";import{S as Ot,a as _t,b as Lt,c as U,d as ue}from"./SidebarStyles-JhyDWPNq.js";import{C as Pt,H as At}from"./HeaderPage-DRv2GeZX.js";function Bt(t){const[s,a]=p.useState(t||"");return{currentTab:s,onChangeTab:(r,n)=>{a(n)},setCurrentTab:a}}const Dt=t=>{const s=(t==null?void 0:t.distance)||160,a=t==null?void 0:t.durationIn,r=t==null?void 0:t.durationOut,n=t==null?void 0:t.easeIn,o=t==null?void 0:t.easeOut;return{inUp:{initial:{y:s},animate:{y:0,transition:A({durationIn:a,easeIn:n})},exit:{y:s,transition:B({durationOut:r,easeOut:o})}},inDown:{initial:{y:-s},animate:{y:0,transition:A({durationIn:a,easeIn:n})},exit:{y:-s,transition:B({durationOut:r,easeOut:o})}},inLeft:{initial:{x:-s},animate:{x:0,transition:A({durationIn:a,easeIn:n})},exit:{x:-s,transition:B({durationOut:r,easeOut:o})}},inRight:{initial:{x:s},animate:{x:0,transition:A({durationIn:a,easeIn:n})},exit:{x:s,transition:B({durationOut:r,easeOut:o})}},outUp:{initial:{y:0},animate:{y:-s,transition:A({durationIn:a,easeIn:n})},exit:{y:0,transition:B({durationOut:r,easeOut:o})}},outDown:{initial:{y:0},animate:{y:s,transition:A({durationIn:a,easeIn:n})},exit:{y:0,transition:B({durationOut:r,easeOut:o})}},outLeft:{initial:{x:0},animate:{x:-s,transition:A({durationIn:a,easeIn:n})},exit:{x:0,transition:B({durationOut:r,easeOut:o})}},outRight:{initial:{x:0},animate:{x:s,transition:A({durationIn:a,easeIn:n})},exit:{x:0,transition:B({durationOut:r,easeOut:o})}}}},Ft=t=>[{id:"terminal",header:`${t?t==null?void 0:t.name:"Global"}`,columns:[{accessorKey:"description",header:"Movimiento",enableHiding:!1,size:200,Cell:({cell:s,column:a,row:r})=>{const{original:n}=r,o=n==null?void 0:n.approved,l=gt(n==null?void 0:n.cardType),c=l==null?void 0:l.component;return e.jsxs(w,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(w,{sx:{position:"relative"},children:[e.jsx(ne,{title:n==null?void 0:n.cardType,children:e.jsx(ye,{sx:{width:40,height:40,color:"text.secondary",bgcolor:"background.neutral"},children:l?e.jsx(c,{sx:{width:25,height:25}}):e.jsx(He,{width:25,height:25})})}),e.jsx(w,{sx:{right:0,bottom:0,width:15,height:15,display:"flex",borderRadius:"50%",position:"absolute",alignItems:"center",color:"common.white",bgcolor:"error.main",justifyContent:"center",...o&&{bgcolor:"success.main"}},children:o?e.jsx(Ye,{sx:{width:12,height:12}}):e.jsx(We,{sx:{width:12,height:12}})})]}),e.jsxs(w,{sx:{ml:2},children:[e.jsx(f,{variant:"subtitle2",sx:{textWrap:"wrap"},children:n==null?void 0:n.description}),e.jsx(f,{variant:"body2",textTransform:"capitalize",sx:{color:o?"success.main":"error.main",textWrap:"wrap"},children:n==null?void 0:n.transactionMessage})]})]})}},...t?[]:[{accessorKey:"terminalName",header:"Terminal",size:100,Cell:({cell:s,column:a,row:r,renderedCellValue:n})=>{const{original:o}=r;return e.jsx(f,{variant:"subtitle2",fontWeight:"bold",children:o==null?void 0:o.terminalName})}}],{accessorKey:"date",header:"Fecha",size:100,Cell:({cell:s,column:a,row:r,renderedCellValue:n})=>{var l,c;const{original:o}=r;return e.jsxs(x,{children:[e.jsx(f,{variant:"subtitle2",children:(l=o==null?void 0:o.transactionDate)==null?void 0:l.date}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:(c=o==null?void 0:o.transactionDate)==null?void 0:c.time})]})}},{accessorKey:"amountFormat",header:"Monto",size:100,Cell:({cell:s,column:a,row:r})=>{const{original:n}=r;return e.jsx(f,{variant:"subtitle2",fontWeight:"bold",children:n==null?void 0:n.amountFormat})}},{accessorKey:"conciliatedName",header:"Â¿Conciliada?",filterVariant:"multi-select",size:110,Cell:({cell:s,column:a,row:r})=>{const{original:n}=r;return e.jsx(x,{flexDirection:"row",gap:1,color:"primary",children:n!=null&&n.conciliated?e.jsx(pt,{color:"green",fontWeight:"bold",fontSize:"20px"}):e.jsx(xt,{fontSize:"20px",color:"red"})})}}]}],te={LIST:"commerce-terminals",MOVEMENTS:"terminal-movements",CONCILIATE_MOVEMENTS:"conciliate-movements"},kt=t=>(t==null?void 0:t.map(s=>{var a,r,n,o;return{id:s==null?void 0:s.id,commerceId:s==null?void 0:s.commerceId,terminalId:s==null?void 0:s.terminalId,terminalON:((a=s==null?void 0:s.apiData)==null?void 0:a.status)===1,country:(r=s==null?void 0:s.apiData)==null?void 0:r.country,date:{created:(n=s==null?void 0:s.apiData)==null?void 0:n.created_at,updated:(o=s==null?void 0:s.apiData)==null?void 0:o.updated_at,register:s==null?void 0:s.registerDate},isVirtual:(s==null?void 0:s.typeId)==="1",name:(s==null?void 0:s.name)!==""?s==null?void 0:s.name.toString().toUpperCase():`TERMINAL-${s==null?void 0:s.terminalId}`,active:(s==null?void 0:s.active)==="1",isExternalConciliation:!!(s!=null&&s.isConciliationExternal)}}))||[],Rt=t=>ft(t),Nt=t=>{var n,o,l,c,h,j;const s=((n=t==null?void 0:t.movements)==null?void 0:n.map(i=>{const T=parseFloat((i==null?void 0:i.amount)||"0"),_=i!=null&&i.transaction_date?N(z(i==null?void 0:i.transaction_date),"dd MMM yyyy",{locale:ie}):"",b=i!=null&&i.transaction_date?N(z(i==null?void 0:i.transaction_date),"p"):"";return{id:i==null?void 0:i.id,terminalName:i==null?void 0:i.terminal_name,amount:T,amountFormat:m(T),approved:i==null?void 0:i.approved,cardType:i==null?void 0:i.card_brand,cardNumber:i==null?void 0:i.card_number,cardBank:i==null?void 0:i.issuer,transactionDate:{fullDate:N(z(i==null?void 0:i.transaction_date),"dd MMM yyyy HH:mm",{locale:ie}),date:_,time:b},date:z(i==null?void 0:i.transaction_date),description:`${(i==null?void 0:i.issuer)===""?i==null?void 0:i.card_brand:i==null?void 0:i.issuer}-${i==null?void 0:i.card_number}`.toUpperCase(),transactionMessage:i==null?void 0:i.result_message,conciliated:!!(i!=null&&i.conciliated),conciliatedName:i!=null&&i.conciliated?"Conciliada":"Sin Conciliar"}}))??[],a={amount:m((o=t==null?void 0:t.balance)==null?void 0:o.amount),month:(c=(l=t==null?void 0:t.balance)==null?void 0:l.month)==null?void 0:c.toLowerCase()},r={status:{all:(s==null?void 0:s.length)||0,approved:((h=s==null?void 0:s.filter(i=>i==null?void 0:i.approved))==null?void 0:h.length)||0,rejected:((j=s==null?void 0:s.filter(i=>!(i!=null&&i.approved)))==null?void 0:j.length)||0}};return{movements:s,balance:a,filters:r}},Vt=async()=>{const{data:t}=await R.get("/api/commerces/terminals");return kt(t)},Ss=async t=>{const{data:s}=await R.post("/api/commerce/pay/new",t);return s},ws=async t=>{const{data:s}=await R.post("/api/commerce/virtual/pay",t);return s},zt=async(t,s,a)=>{const r=t?`?fromDate=${s}&toDate=${a}&terminalId=${t}`:`?fromDate=${s}&toDate=${a}`,{data:n}=await R.get(`/api/commerces-pay/transactions/all${r}`);return Nt(n)},Ms=async(t,s)=>{const a=new URL("/api/card/movements/terminal/conciliated",window.location.origin);a.searchParams.set("startDate",s),a.searchParams.set("terminalId",t);const{data:r}=await R.get(a.href);return Rt(r)},Es=async t=>{const{data:s}=await R.post("/api/commerce/terminal/consolidation/create",t);return s},Ht=(t={})=>{const[s,a]=p.useState(null);return{...je([te.LIST],Vt,{staleTime:6e4,refetchOnMount:"always",onError:n=>{const o=xe(n,"No se puede obtener la lista de terminales del comercio. Intente nuevamente o reporte a sistemas");a(o)},...t}),error:s||null}},H={terminal:null,conciliateInfo:{movements:null,total:0,date:null},openConciliate:!1},Yt=(t,s)=>({...H,setTerminal:a=>{const{terminal:r}=s();t(n=>({terminal:{...r,...a}}),!1,"SET_TERMINAL_SELECTED")},resetTerminal:()=>{t(a=>({terminal:null}),!1,"RESET_TERMINAL_SELECTED")},addTerminalInfo:a=>{const{terminal:r}=s();t(n=>({terminal:{...r,...a}}),!1,"SET_TERMINAL_INFO")},setOpenConciliate:a=>{t(r=>({openConciliate:a}),!1,"SET_OPEN_CONCILIATE")},setConciliateMovements:a=>{let r=H==null?void 0:H.conciliateInfo;if(a){a==null||a.sort((l,c)=>l.date-c.date);const n=(a==null?void 0:a.length)>0&&a[0],o=a.reduce((l,c)=>l+(c==null?void 0:c.amount),0);r={movements:a,total:o,date:n==null?void 0:n.date}}t(n=>({conciliateInfo:r}),!1,"SET_CONCILIATE_MOVEMENTS")}}),O=ge(Yt),Q={terminals:[],isOpenList:!0,isCollapse:!1,balance:{amount:"$0.00",month:null},globalBalance:{amount:"$0.00",month:null}},Wt=(t,s)=>({...Q,setTerminals:a=>{t(r=>({terminals:a}),!1,"SET_TERMINALS")},setOpenList:a=>{t(r=>({isOpenList:a}),!1,"SET_OPEN_LIST")},setCollapse:a=>{t(r=>({isCollapse:a}),!1,"SET_COLLAPSE")},setBalance:a=>{t(r=>({balance:a}),!1,"SET_BALANCE")},setGlobalBalance:a=>{t(r=>({globalBalance:a}),!1,"SET_GLOBAL_BALANCE")},resetBalance:()=>{t(a=>({balance:Q.balance}),!1,"RESET_BALANCE")},resetGlobalBalance:()=>{t(a=>({globalBalance:Q.globalBalance}),!1,"RESET_BALANCE")}}),C=ge(Wt),Gt=(t,s,a={})=>{const r=C(b=>b.resetBalance),n=C(b=>b.resetGlobalBalance),o=Ge(s),l=$e(s),c=N(o,"yyyy-MM-dd"),h=N(l,"yyyy-MM-dd"),[j,i]=p.useState(null),T=t?[te.MOVEMENTS,t]:[te.MOVEMENTS,"global"];return{...je(T,({signal:b})=>zt(t,c,h),{staleTime:6e4,retry:!1,refetchOnWindowFocus:!1,onError:b=>{const L=xe(b,"No se puede obtener la lista de movimientos de la terminal. Intente nuevamente o reporte a sistemas");i(L),fe.error(L,{type:Le(b)}),t?r():n()},...a}),error:j||null}},$t=48,Kt=8,Ut={PaperProps:{style:{maxHeight:$t*4.5+Kt,width:250}}},Qt=yt(),Se=({cardType:t,handleChangeCardType:s,isLoading:a})=>e.jsx(Ke,{sx:{minWidth:240},disabled:!!a,children:e.jsxs(X,{fullWidth:!0,multiple:!0,displayEmpty:!0,disabled:!!a,size:"small",value:t,onChange:s,input:e.jsx(Ue,{}),renderValue:r=>r.length===0?e.jsx(e.Fragment,{children:"Tarjeta"}):r.join(", "),MenuProps:Ut,inputProps:{"aria-label":"Without label"},children:[e.jsx(Y,{disabled:!0,value:"",children:e.jsx("em",{children:" Seleccionar Tarjeta"})}),Qt.map(r=>e.jsxs(Y,{value:r,sx:{mx:1,my:.5,p:0,borderRadius:.75,typography:"body2",textTransform:"capitalize",fontWeight:n=>t.indexOf(name)===-1?n.typography.fontWeightRegular:n.typography.fontWeightMedium},children:[e.jsx(Qe,{checked:t.indexOf(r)>-1}),e.jsx(Xe,{primary:r})]},r))]})}),Xt=p.memo(Se);Se.propTypes={cardType:y.array,handleChangeCardType:y.func,isLoading:y.any};const k=[{name:"Todos",id:"all",color:"primary"},{name:"Aprobado",id:"approved",color:"success"},{name:"Rechazado",id:"rejected",color:"error"}],qt=t=>k==null?void 0:k.find(s=>s.name===t),we=({filterStatus:t,onChangeFilterStatus:s,filters:a})=>{const r=p.useMemo(()=>k==null?void 0:k.map(n=>n.name),[]);return e.jsx(qe,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:t,onChange:s,sx:{px:2},children:r.map(n=>{const o=qt(n),l=o&&(a==null?void 0:a.status[o==null?void 0:o.id])||0;return e.jsx(Je,{icon:e.jsx(bt,{color:o==null?void 0:o.color,children:l}),iconPosition:"end",disableRipple:!0,label:n,value:n},n)})})},Jt=p.memo(we);we.propTypes={filterStatus:y.any,filters:y.shape({status:y.any}),onChangeFilterStatus:y.func};const he=be(Ze)(({theme:t})=>({"label + &":{marginTop:t.spacing(3)},"& .MuiInputBase-input":{borderRadius:4,position:"relative",border:"none",outline:"none"}}));function Zt({setCurrentMonth:t,currentMonth:s,isLoading:a}){const n=new Date().getFullYear(),o=se("up","lg"),l=Array.from({length:n-2020+1},(g,d)=>2020+d).reverse(),c=a,h=()=>{t(g=>{const d=new Date(g);return d.setMonth(d.getMonth()-1),d})},j=()=>{t(g=>{const d=new Date(g);return d.setMonth(d.getMonth()+1),d})},i=()=>{const g=new Date;return s.getMonth()===g.getMonth()&&s.getFullYear()===g.getFullYear()},T=(g,d)=>{const S=new Date,D=S.getFullYear(),I=S.getMonth();return d>D||d===D&&g>I},_=g=>{const d=new Date(s);d.setMonth(g.target.value),t(d)},b=g=>{const d=new Date(s);d.setFullYear(g.target.value),t(d)},L={PaperProps:{style:{maxHeight:200,overflowY:"auto"}}};return e.jsxs(x,{spacing:2,direction:"row",justifyContent:"space-between",sx:{py:2.5,px:3},children:[o?e.jsx(oe,{loading:c,variant:"outlined",startIcon:e.jsx(le,{}),onClick:h,children:"anterior"}):e.jsx(q,{disabled:c,variant:"outlined",onClick:h,children:e.jsx(le,{})}),e.jsxs(w,{display:"flex",alignItems:"center",justifyContent:"center",spacing:1,gap:1,children:[e.jsx(X,{size:"small",value:s.getMonth(),onChange:_,disabled:c,input:e.jsx(he,{}),children:ee.map((g,d)=>{const S=s.getFullYear();return T(d,S)?null:e.jsx(Y,{value:d,disabled:T(d,S),children:g},d)})}),e.jsx(X,{size:"small",value:s.getFullYear(),onChange:b,input:e.jsx(he,{}),MenuProps:L,disabled:c,children:l.map(g=>e.jsx(Y,{value:g,children:g},g))})]}),o?e.jsx(oe,{loading:c,variant:"outlined",endIcon:e.jsx(ce,{}),disabled:i(),onClick:j,children:"siguiente"}):e.jsx(q,{disabled:c,variant:"outlined",onClick:j,children:e.jsx(ce,{})})]})}const pe=()=>{const[t,s]=p.useState(new Date),a=O(u=>u.terminal),r=O(u=>u.setConciliateMovements),n=O(u=>u.setOpenConciliate),o=C(u=>u.setBalance),l=C(u=>u.setGlobalBalance),{data:c,isFetching:h,refetch:j,isError:i,error:T,isLoading:_}=Gt(a==null?void 0:a.terminalId,t,{enabled:!!(a!=null&&a.terminalId&&t)}),{currentTab:b,onChangeTab:L}=Bt("Todos"),[g,d]=p.useState([]),[S,D]=p.useState({}),{movements:I,amount:P}=p.useMemo(()=>vt({movements:(c==null?void 0:c.movements)||[],filterCardType:g,filterStatus:b}),[c==null?void 0:c.movements,g,b]),F=p.useMemo(()=>Ft(a),[a]),Oe=u=>{const{target:{value:M}}=u;d(typeof M=="string"?M.split(","):M)};p.useEffect(()=>{j(),D({})},[t]),p.useEffect(()=>{s(new Date)},[a]),p.useEffect(()=>{P&&a&&t&&o({month:ee[t.getMonth()],amount:P}),P&&!a&&t&&l({month:ee[t.getMonth()],amount:P})},[P,a,t]);const _e=u=>{try{const M=u.getSortedRowModel().rows.map(E=>(F==null?void 0:F.map($=>E.getValue($.accessorKey)))||[])??[];jt((F==null?void 0:F.map(E=>E.header))||[],M,"Movimientos Terminales")}catch{}};return e.jsx(J,{children:e.jsx(Tt,{enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowSelection:u=>{const{conciliated:M,approved:E}=u.original;return!(!E&&a||M&&a)},enableDensityToggle:!1,columns:F,data:I||[],isError:i,textError:T,selectAllMode:"all",onRowSelectionChange:D,initialState:{density:"compact",sorting:[{id:"date",desc:!0}]},state:{isLoading:_,showAlertBanner:i,showProgressBars:h,rowSelection:S??{}},displayColumnDefOptions:{"mrt-row-select":{maxSize:10}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},renderTopToolbar:({table:u})=>{var E;const M=()=>{var re;const $=(re=u.getSelectedRowModel().flatRows)==null?void 0:re.map(K=>K==null?void 0:K.original);a!=null&&a.isExternalConciliation?fe.info("ConciliaciÃ³n Externa: En etapa de desarrollo ðŸ§‘ðŸ»â€ðŸ’»ðŸš€!!"):(r($),n(!0))};return e.jsxs(x,{component:Ce,children:[e.jsx(Jt,{filterStatus:b,onChangeFilterStatus:L,filters:c==null?void 0:c.filters}),e.jsx(Z,{sx:{borderStyle:"dashed"}}),i&&!h&&e.jsx(ve,{severity:"error",sx:{width:1,borderRadius:0},action:e.jsx(W,{color:"inherit",size:"small",onClick:j,children:"Recargar"}),children:T}),e.jsxs(x,{direction:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"center",flex:1,spacing:2,px:2,py:1,children:[e.jsx(Xt,{cardType:g,handleChangeCardType:Oe,isLoading:h}),e.jsx(x,{flexGrow:1,children:e.jsx(Zt,{currentMonth:t,setCurrentMonth:s,isLoading:h})})]}),e.jsx(Z,{sx:{borderStyle:"dashed"}}),e.jsxs(x,{px:2,py:1,direction:"row",justifyContent:"space-between",alignItems:"center",children:[a?e.jsx(x,{children:e.jsx(W,{color:"info",onClick:M,disabled:((E=u.getSelectedRowModel().flatRows)==null?void 0:E.length)===0,variant:"contained",children:"Conciliar"})}):e.jsx(w,{display:"flex"}),e.jsx(St,{table:u}),e.jsxs(w,{children:[e.jsx(wt,{table:u}),e.jsx(ne,{title:"Descargar",children:e.jsx(q,{disabled:u.getPrePaginationRowModel().rows.length===0,onClick:()=>_e(u),children:e.jsx(me,{})})}),e.jsx(Mt,{table:u}),e.jsx(Et,{table:u}),e.jsx(It,{table:u})]})]})]})},muiSelectCheckboxProps:({row:u})=>{const{approved:M,conciliated:E}=u.original;return{sx:{disabled:!!(!M&&a)||E&&a,display:!M&&a||E&&a?"none":"flex"}}}})})};function vt({movements:t,filterCardType:s,filterStatus:a}){const r=(t==null?void 0:t.map((l,c)=>[l,c]))||[];let n=0,o=r.map(l=>l[0]);return a!=="Todos"&&(o=o.filter(l=>l.approved===(a==="Aprobado"))),et.isArray(s)&&(s==null?void 0:s.length)>0&&(o=o.filter(l=>{var c;return s.includes((c=l==null?void 0:l.cardType)==null?void 0:c.toUpperCase())})),n=o.reduce((l,c)=>{if(c.approved){const h=parseFloat(c.amount);return l+h}return l},0),{movements:o??[],amount:m(n.toFixed(2))}}const mt=()=>{const t=O(s=>s.terminal);return e.jsx(x,{sx:s=>({pl:{xs:0,sm:2,lg:2},overflow:"hidden",flexDirection:"column",flexGrow:1,transition:s.transitions.create(["width","flexGrow"])}),children:e.jsx(G,{children:e.jsxs(w,{sx:{overflowY:"auto"},children:[t&&e.jsx(V.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsx(x,{p:2,children:e.jsx(pe,{})})}),!t&&e.jsx(V.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsx(x,{p:2,children:e.jsx(pe,{})})})]})})})},es=p.lazy(()=>ae(()=>import("./PaymentLinkModal-CLlcYt-G.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))),ts=p.lazy(()=>ae(()=>import("./VirtualTerminalModal-CkekQ3Rd.js"),__vite__mapDeps([28,1,3,5,10,6,7,8,9,11,12,13,14,15,21,22,16,17,18,19,20,23,24,25,26,27]))),ss=()=>{const[t,s]=p.useState(!1),[a,r]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Z,{sx:{borderStyle:"dashed"}}),e.jsxs(x,{px:2,py:1,flexDirection:"row",justifyContent:"space-between",children:[e.jsx(W,{size:"small",startIcon:e.jsx(tt,{}),onClick:()=>s(!0),children:"Liga de Pago"}),e.jsx(W,{size:"small",startIcon:e.jsx(st,{}),sx:{textWrap:"nowrap"},onClick:()=>r(!0),children:"Term. Virtual"})]}),e.jsx(p.Suspense,{children:e.jsx(es,{open:t,setOpen:s})}),e.jsx(p.Suspense,{children:e.jsx(ts,{open:a,setOpen:r})})]})},as=()=>{const t=O(r=>r.terminal),s=C(r=>r.balance),a=t?t==null?void 0:t.name:"Global";return e.jsx(G,{children:!!(t!=null&&t.id)&&e.jsx(V.div,{...Dt().inLeft,children:e.jsxs(Ce,{sx:{boxShadow:r=>`0px 0px 15px 2px ${at(r.palette.primary.main,.4)}`},children:[e.jsx(v,{title:e.jsx(x,{flexDirection:"column",gap:1,children:e.jsx(f,{variant:"subtitle1",children:a})}),sx:{px:2,py:2}}),e.jsxs(x,{alignItems:"center",pb:2,px:2,children:[e.jsxs(x,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(f,{variant:"h3",children:s.amount}),e.jsx(f,{variant:"caption",children:"MXN"})]}),(s==null?void 0:s.month)&&e.jsxs(f,{variant:"subtitle2",children:["Balance de ",s.month]})]}),(t==null?void 0:t.isVirtual)&&e.jsx(ss,{})]})})})},ns=()=>{const t=C(n=>n.globalBalance),s=O(n=>n.resetTerminal),a=O(n=>n.terminal),r=()=>{s()};return a?e.jsx(G,{children:e.jsx(V.div,{onClick:r,whileHover:{scale:1.03},whileTap:{scale:.8},children:e.jsx(J,{sx:n=>({cursor:"pointer","& :hover":{color:"primary.main"}}),children:e.jsx(v,{title:e.jsxs(x,{flexDirection:"row",gap:1,justifyContent:"space-between",children:[e.jsx(f,{variant:"subtitle1",children:"Global"}),e.jsxs(x,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(f,{variant:"caption",children:t.amount}),e.jsx(f,{variant:"caption",children:"MXN"})]})]}),sx:{px:2,py:2}})})})}):e.jsx(G,{children:e.jsx(V.div,{onClick:r,whileHover:{scale:1.03},whileTap:{scale:.8},children:e.jsxs(J,{sx:n=>({cursor:"pointer",backgroundColor:{xs:"background.neutral",md:"background.paper"},"& :hover":{color:"primary.main"}}),children:[e.jsx(v,{title:e.jsx(x,{flexDirection:"column",gap:1,children:e.jsx(f,{variant:"subtitle1",children:"Global"})}),sx:{px:2,py:2}}),e.jsxs(x,{alignItems:"center",pb:2,px:2,children:[e.jsxs(x,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(f,{variant:"h3",children:t.amount}),e.jsx(f,{variant:"caption",children:"MXN"})]}),(t==null?void 0:t.month)&&e.jsxs(f,{variant:"subtitle2",children:["Balance de ",t.month]})]})]})})})},rs=be(nt)(({theme:t})=>({borderRadius:"8px!important",width:1,justifyContent:"center",display:"flex",alignItems:"center",mb:1})),Me=({terminal:t})=>{const s=C(l=>l.isOpenList);C(l=>l.setOpenList);const a=O(l=>l.setTerminal),r=O(l=>l.terminal);(t==null?void 0:t.id)===(r==null?void 0:r.id)&&r&&(r==null||r.cardON);const n=(t==null?void 0:t.id)===(r==null?void 0:r.id),o=l=>{var h;!((h=l.target)==null?void 0:h.type)&&!n&&a(t)};return e.jsx(ne,{title:t==null?void 0:t.name,arrow:!0,placement:"right",children:e.jsx(rt,{sx:{mb:1,padding:0,borderRadius:1,"& :hover":{color:"text.primary"}},disablePadding:!0,children:e.jsxs(rs,{onClick:o,sx:{...n&&{bgcolor:"secondary.light",color:"text.primary.contrastText","& :hover":{color:"text.primary"}},"& :hover":{color:"text.primary"},width:1,py:1,gap:1},children:[e.jsx(it,{sx:{ml:2,m:0},children:e.jsx(w,{sx:{position:"relative"},children:e.jsx(ye,{sx:l=>({width:32,height:32,m:0,backgroundColor:l.palette.primary.main,color:l.palette.primary.contrastText,"& :hover":{color:l.palette.primary.contrastText}}),children:t!=null&&t.isVirtual?e.jsx(Te,{sx:l=>({width:20,height:20,"& :hover":{color:l.palette.primary.contrastText}})}):e.jsx(ot,{sx:l=>({width:16,height:16,"& :hover":{color:l.palette.primary.contrastText}})})})})}),s&&e.jsx(e.Fragment,{children:e.jsx(x,{sx:{width:1},children:e.jsx(f,{noWrap:!0,variant:"subtitle2",children:t==null?void 0:t.name})})})]})})})};Me.propTypes={terminal:y.shape({alias:y.any,id:y.any,isVirtual:y.any,name:y.any})};const Ee=({terminalsQuery:t,sx:s,...a})=>{const{isLoading:r,data:n,error:o,isError:l,refetch:c}=t,h=C(i=>i.isOpenList),j=C(i=>i.terminals);return l&&h&&!n&&!r?e.jsx(Pe,{errorMessage:o,handleButton:c}):n&&h&&(n==null?void 0:n.length)===0&&!r?e.jsx(Ae,{pt:2.5,message:"No hay terminales activas para este comercio"}):e.jsx(lt,{disablePadding:!0,sx:s,...a,children:(r?[...Array(12)]:j).map((i,T)=>i!=null&&i.id?e.jsx(Me,{terminal:i},i==null?void 0:i.id):e.jsx(Ot,{isOpenSideBar:h},T))})};Ee.propTypes={sx:y.any,terminalsQuery:y.shape({data:y.array,error:y.any,isError:y.any,isLoading:y.any,refetch:y.any})};const Ie=({commerceTerminals:t=[]})=>{const{setOpenList:s,setCollapse:a,setTerminals:r}=C(),n=C(d=>d.isOpenList),o=C(d=>d.isCollapse),l=C(d=>d.terminals),c=se("up","md"),[h,j]=p.useState(""),[i,T]=p.useState(!1),_=async d=>{try{const{value:S}=d.target;if(j(S),S){const D=(t==null?void 0:t.filter(I=>{var P;return(I==null?void 0:I.name)&&((P=I==null?void 0:I.name)==null?void 0:P.toLowerCase().indexOf(S.toLowerCase()))!==-1}))||[];r(D)}else r(t)}catch(S){console.error(S)}},b=()=>{a(c&&n),n&&(j(""),r(t)),s(!n)},L=()=>{T(!0)},g=()=>{T(!1)};return p.useEffect(()=>{t&&r(t)},[t]),p.useEffect(()=>{if(!n)return T(!1)},[n]),e.jsxs(e.Fragment,{children:[e.jsx(w,{sx:{p:2,px:0},children:e.jsxs(x,{direction:"row",justifyContent:n?"flex-end":"center",alignItems:"center",spacing:2,children:[(!o||!c)&&e.jsx(ct,{onClickAway:g,children:e.jsx(Ct,{fullWidth:!0,size:"small",value:h,onFocus:L,onChange:_,placeholder:"Buscar Terminales...",InputProps:{startAdornment:e.jsx(dt,{position:"start",children:e.jsx(ut,{sx:{color:"text.disabled",width:20,height:20}})})}})}),c&&e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(_t,{size:"small",sx:{...!n&&{transform:"rotate(180deg)"}},onClick:b,children:Be})})]})}),(l==null?void 0:l.length)===0&&(t==null?void 0:t.length)>0&&e.jsx(De,{sx:{p:1,display:"flex",flexDirection:"column",alignItems:"center"},searchQuery:h})]})};Ie.propTypes={commerceTerminals:y.array};const is=()=>{const t=C(i=>i.isOpenList),s=C(i=>i.setOpenList),a=C(i=>i.setCollapse),r=Ht(),n=ht(),o=se("up","md"),l=p.useMemo(()=>o&&!t,[o,t]),c=()=>{a(!0),s(!1)},h=()=>{s(!t)},j=e.jsxs(e.Fragment,{children:[t&&e.jsxs(x,{spacing:2,p:2,children:[e.jsx(ns,{}),e.jsx(as,{})]}),e.jsx(x,{children:e.jsx(Ie,{commerceTerminals:(r==null?void 0:r.data)||[]})}),e.jsx(Fe,{sx:{height:.98},children:e.jsx(x,{children:e.jsx(Ee,{terminalsQuery:r})})})]});return e.jsxs(e.Fragment,{children:[!o&&!t&&e.jsx(Lt,{onClick:h,children:e.jsx(Te,{sx:{width:20,height:20}})}),o?e.jsx(de,{open:t,variant:"persistent",PaperProps:{sx:{height:1,borderRightStyle:"none",bgcolor:"background.default"}},sx:{height:1,width:U,transition:n.transitions.create("width"),"& .MuiDrawer-paper":{position:"static",backgroundColor:"transparent!important",width:U},...l&&{width:ue,"& .MuiDrawer-paper":{width:ue,backgroundColor:"transparent!important",position:"static",transform:"none !important",visibility:"visible !important"}}},children:j}):e.jsx(de,{ModalProps:{keepMounted:!1},open:t,onClose:c,sx:{height:1,"& .MuiDrawer-paper":{width:U,p:2}},children:j})]})},os=ke(p.lazy(()=>ae(()=>import("./ConciliateTerminalsMovements-CcTj_c_r.js"),__vite__mapDeps([29,1,15,6,7,25,30,16,17,18,19,20,21,22,23,10,24,8,9,3,11,12,13,14,26,27])))),ls=()=>{const t=O(s=>s.openConciliate);return e.jsx(Re,{title:"Lista de Terminales Punto de Venta",children:e.jsxs(Pt,{children:[e.jsxs(w,{display:"flex",overflow:"hidden",sx:{height:"100vH",maxHeight:"100%",flexDirection:"column"},children:[e.jsx(w,{px:1,children:e.jsx(At,{name:"Terminales Punto de Venta",links:[{name:"Inicio",href:Ne.root},{name:"Viabo Pay",href:Ve.terminals},{name:ze.terminals.name}]})}),e.jsxs(w,{display:"flex",overflow:"hidden",flex:1,children:[e.jsx(is,{}),e.jsx(mt,{})]})]}),!!t&&e.jsx(os,{})]})})},Is=Object.freeze(Object.defineProperty({__proto__:null,default:ls},Symbol.toStringTag,{value:"Module"}));export{Is as P,te as T,Ss as a,ws as b,Es as c,Ms as g,O as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/PaymentLinkModal-CLlcYt-G.js","assets/js/vendor-CEMfbhOc.js","assets/js/Link-CFu4JD_A.js","assets/js/formik.esm-Dshy1xjd.js","assets/js/mui-tel-input.es-DuWRtnpZ.js","assets/js/index.esm-C2GVbld4.js","assets/js/index-B-U8M-8N.js","assets/css/build-Bl0dWaDY.css","assets/js/crypto--V-xCCVf.js","assets/js/TextMaxLine-D6XZvUuW.js","assets/js/formatTime-mlJJpQBT.js","assets/js/matchTypes-BFKCRNnN.js","assets/js/UploadSingleFile-B0jkdwVt.js","assets/js/fade-CViozI82.js","assets/js/transition-anLY3gj9.js","assets/js/formatNumber-Df8NwpjV.js","assets/js/index-BdTlPQ76.js","assets/js/iconBase-D_ql85QS.js","assets/js/cardTypes-NmdqE8Eh.js","assets/js/AmexLogo-DsyshqEq.js","assets/js/CarnetLogo-BssSE0Ex.js","assets/js/MasterCardLogo-Bcn9gvbj.js","assets/js/VisaLogo-ByWQmEg7.js","assets/js/csv-BGNpG_Xb.js","assets/js/cardMovementsAdapter-ocC5swCp.js","assets/js/MaterialDataTable-CDmLz-NL.js","assets/js/SidebarStyles-JhyDWPNq.js","assets/js/HeaderPage-DRv2GeZX.js","assets/js/VirtualTerminalModal-CkekQ3Rd.js","assets/js/ConciliateTerminalsMovements-CcTj_c_r.js","assets/js/useMaterialTable-9wOa4uxn.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=POSTerminals-r-UFhmyN.js.map
