import{a as S,d8 as q,Q as j,g as A,b as F,z as L,j as e,a7 as N,d9 as R,S as a,a0 as T,h as E,B as C,T as t,da as I,L as B,O as k}from"./index-ixKXqnJp.js";import{u as V}from"./build-etstWp0g.js";import{h as $}from"./build-BftwNxht.js";import{c as O,a as m,e as W}from"./build-FTXeMWpc.js";import{a as M}from"./build-FAvjNavH.js";import{i as v,m as _}from"./build-oHIjvIrR.js";import{F as G}from"./build-VQrlUuND.js";import{R as g}from"./build-5iMH1_PB.js";import"./build-0U7rJSAM.js";import"./build-KbTEeZ86.js";import"./build-GywV9psu.js";import"./build-YOvIjgAO.js";import"./build-3mvdD2lh.js";import"./build-Uc7vb3zK.js";import"./build-6YIPcFHU.js";import"./build-pdsvphlv.js";import"./build-syo_OqTy.js";import"./build-jxeW1WMv.js";import"./build-lj6x1nL8.js";const Q=r=>{const s={code:r==null?void 0:r.authCode,currentPassword:r==null?void 0:r.currentPassword,newPassword:r==null?void 0:r.newPassword,confirmationPassword:r==null?void 0:r.verifyNewPassword};return M(s)},U=(r={})=>{const s=S(q,r);return{...s,mutate:async(p,h)=>{const{onSuccess:c,onError:d,mutationOptions:l}=h;try{await j.promise(s.mutateAsync(p,l),{pending:"Actualizando Contraseña ...",success:{render({data:o}){return v(c)&&c(o),"Se actualizo la contraseña con éxito"}}})}catch(o){const u=A(o,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");v(d)&&d(u),j.error(u,{type:F(o)})}}}},Z=L(e.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh"),D=({onSuccess:r})=>{const s=N(),{mutate:w,isLoading:p}=U(),{mutate:h,isLoading:c}=R(),d=O().shape({currentPassword:m().trim().required("La contraseña actual es requerida"),newPassword:m().trim().required("La contraseña nueva es requerida").matches("^(?=(?:.*\\d))(?=.*[A-Z])(?=.*[a-z])(?=.*[_\\-.\\@])\\S{8,16}$","La contraseña debe contener al menos 8 caracteres, una mayúscula, una minúscula , un número y un carácter especial [ - _ . @]"),verifyNewPassword:m().trim().oneOf([W("newPassword"),null],"Las contraseñas no coinciden").required("La confirmación de la contraseña es requerida"),authCode:m().required("El código de autorización es requerido")}),l=V({initialValues:{currentPassword:"",newPassword:"",verifyNewPassword:"",authCode:""},enableReinitialize:!0,validationSchema:d,onSubmit:(i,{setSubmitting:f,setFieldTouched:H})=>{const z=Q(i);w(z,{onSuccess:()=>{f(!1),r()},onError:()=>{f(!1)}})}}),{isSubmitting:o,setFieldValue:u,values:P,errors:x}=l,n=o||p,y=i=>{u("authCode",i)},b=i=>_(i);return e.jsx(G,{formik:l,children:e.jsxs(a,{spacing:2,p:3,children:[e.jsxs(T,{severity:"info",children:[e.jsx(E,{children:"Código de Autorización"}),"Enviamos un correo electrónico a"," ",e.jsxs(C,{component:"span",fontWeight:"bold",children:[s==null?void 0:s.email," "]}),"con el código de autorización."]}),e.jsxs(a,{spacing:1,children:[e.jsx(t,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Contraseña Actual *"}),e.jsx(g,{size:"small",name:"currentPassword",disabled:n,required:!0,placeholder:"********"})]}),e.jsxs(a,{spacing:1,children:[e.jsx(t,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Contraseña Nueva *"}),e.jsx(g,{size:"small",name:"newPassword",placeholder:"********",disabled:n,required:!0})]}),e.jsxs(a,{spacing:1,children:[e.jsx(t,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Repetir Contraseña Nueva *"}),e.jsx(g,{size:"small",placeholder:"********",name:"verifyNewPassword",disabled:n,required:!0})]}),e.jsxs(a,{spacing:1,children:[e.jsxs(a,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(t,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Código de Autorización *"}),e.jsx(I,{size:"small",onClick:h,color:"info",disabled:c,"aria-haspopup":"true",title:"Reenviar",children:e.jsx(Z,{width:20,height:20})})]}),e.jsxs(a,{children:[e.jsx($,{length:6,value:P.authCode,onChange:y,validateChar:b,sx:{gap:{xs:1.5,sm:2,md:3}},TextFieldsProps:{placeholder:"-",error:!!x.authCode,disabled:n,size:"small"}}),!!x.authCode&&e.jsx(C,{mt:1,children:e.jsx(t,{variant:"caption",color:"error",children:x.authCode})})]})]}),e.jsx(a,{pt:2,children:e.jsx(B,{loading:n,variant:"contained",color:"primary",fullWidth:!0,type:"submit",sx:{fontWeight:"bold"},children:"Guardar"})})]})})};D.propTypes={onSuccess:k.func};export{D as default};
