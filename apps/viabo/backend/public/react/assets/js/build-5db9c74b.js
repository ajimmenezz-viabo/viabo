import{n as S,at as I,g as A,o as L,P as b,j as e,a5 as M,S as n,T as l,L as E,r as v,c_ as T,J as w,K as N,I as q,az as F,H as $,cn as O}from"./build-64a25fd4.js";import{d as R,C as D,a as _}from"./build-6c823b45.js";import{u as z}from"./build-0a1457f9.js";import{a as B}from"./build-395776f7.js";import{c as U,a as x}from"./build-43ec3615.js";import{g as X}from"./build-7b77a3a8.js";import{c as V,u as W,L as G}from"./build-7b81a95f.js";import{R as g}from"./build-6e98428f.js";import{F as H,M as J}from"./build-81b4defd.js";import{I as y}from"./build-8fe9665e.js";import{P as K}from"./build-29655094.js";import{E as Q}from"./build-3077ef03.js";import{R as Z}from"./build-88ac29fe.js";import{f as Y}from"./build-977b7120.js";import"./build-d41b3d80.js";import"./build-9cd5ca94.js";import"./build-7837c44d.js";import"./build-fc19efb2.js";import"./build-6b17aba2.js";import"./build-7d9da98f.js";import"./build-e303152c.js";import"./build-ab3ce0c4.js";import"./build-77003c42.js";import"./build-66e8ef2d.js";import"./build-78598d2c.js";import"./build-4a3935ac.js";import"./build-bee6630b.js";import"./build-8a62fdc4.js";const ee=(r,o)=>{var a;const i={commerceId:r==null?void 0:r.commerceId,terminalId:r==null?void 0:r.terminalId,amount:parseFloat((o==null?void 0:o.amount.toString())===""?"0":(a=o==null?void 0:o.amount)==null?void 0:a.toString().replace(/,/g,"")).toString(),fullName:o==null?void 0:o.name,email:o==null?void 0:o.email,phone:o==null?void 0:o.phone,description:o==null?void 0:o.concept};return X(i)},oe=(r={})=>{const o=S(V,r);return{...o,mutate:async(a,m)=>{const{onSuccess:p,onError:c,mutationOptions:u}=m;try{await I.promise(o.mutateAsync(a,u),{pending:"generando Liga de Pago ...",success:{render({data:t}){return p(t),"Se creó la liga de pago con éxito"}}})}catch(t){const d=A(t,"No se puede realizar esta operacion en este momento. Intente nuevamente o reporte a sistemas");c(d),I.error(d,{type:L(t)})}}}},re=1,ne=2e4,P=({onSuccess:r})=>{const{mutate:o,isLoading:i}=oe(),a=W(s=>s.terminal),m=U({amount:x().required("El monto es requerido"),name:x().required("El nombre es requerido"),email:x().email("Ingresa un correo valido").required("El correo es requerido"),phone:x().test("longitud","El telefono es muy corto",s=>!(s&&s.replace(/[\s+]/g,"").length<10)).required("El telefono es requerido")}),p=z({initialValues:{amount:"",name:"",email:"",phone:"",concept:""},validationSchema:m,onSubmit:(s,{setSubmitting:f})=>{const k=ee(a,s);o(k,{onSuccess:j=>{f(!1),r({id:j==null?void 0:j.urlCode,amount:s.amount})},onError:()=>{f(!1)}})}}),{errors:c,touched:u,isSubmitting:t,setFieldValue:d,values:C}=p,h=t||i;return e.jsx(M,{containerProps:{sx:{flexGrow:0,height:"auto"}},children:e.jsx(H,{formik:p,children:e.jsxs(n,{spacing:3,sx:{p:3},children:[e.jsxs(n,{spacing:1,children:[e.jsx(l,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Monto *"}),e.jsx(g,{fullWidth:!0,name:"amount",required:!0,placeholder:"0.00",disabled:h,autoComplete:"off",InputProps:{startAdornment:e.jsx("span",{style:{marginRight:"5px"},children:"$"}),endAdornment:e.jsx(y,{position:"end",children:"MXN"}),inputComponent:J,inputProps:{mask:Number,radix:".",thousandsSeparator:",",padFractionalZeros:!0,min:re,max:ne,scale:2,value:C.amount,onAccept:s=>{d("amount",s)}}}})]}),e.jsxs(n,{spacing:1,children:[e.jsx(l,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre Completo *"}),e.jsx(g,{name:"name",required:!0,placeholder:"Usuario",disabled:h,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(K,{})})}})]}),e.jsxs(n,{spacing:1,children:[e.jsx(l,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Correo Electrónico *"}),e.jsx(g,{name:"email",required:!0,placeholder:"usuario@dominio.com",disabled:h,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Q,{})})}})]}),e.jsxs(n,{spacing:1,children:[e.jsx(l,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Telefono *"}),e.jsx(B,{name:"phone",fullWidth:!0,langOfCountryName:"es",preferredCountries:["MX","US"],continents:["NA","SA"],value:C.phone||"+52",disabled:h,onChange:(s,f)=>{d("phone",s)},error:u.phone&&!!c.phone,helperText:u.phone&&c.phone})]}),e.jsxs(n,{spacing:1,children:[e.jsx(l,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Mensaje"}),e.jsx(g,{name:"concept",multiline:!0,disabled:h,rows:2,placeholder:"Pago por .."})]}),e.jsx(n,{sx:{pt:3},children:e.jsx(E,{loading:t,variant:"contained",color:"primary",fullWidth:!0,type:"submit",startIcon:e.jsx(G,{}),children:"Generar"})})]})})})};P.propTypes={onSuccess:b.func};const te=({open:r,setOpen:o})=>{const[i,a]=v.useState(null),[m,p]=v.useState(!1),c=`${window.location.host}/cobro/${i==null?void 0:i.id}`,u=()=>{o(!1),a(null)};return e.jsx(Z,{open:r,handleClose:u,title:"Liga de Pago",onSuccess:t=>{a(t)},children:i?e.jsxs(n,{flexDirection:"column",alignItems:"center",justifyContent:"space-between",spacing:2,p:5,children:[e.jsxs(n,{flexDirection:"column",alignItems:"center",spacing:2,children:[e.jsx(T,{sx:{width:40,height:40},color:"success"}),e.jsx(l,{textAlign:"center",variant:"subtitle2",children:"Comparte la siguiente liga de pago para realizar el cobro por:"}),e.jsxs(n,{direction:"row",spacing:1,alignItems:"center",children:[e.jsxs(l,{variant:"h3",children:[" ",Y(i.amount)]}),e.jsx(l,{variant:"caption",children:"MXN"})]})]}),e.jsx(n,{flexDirection:"column",alignItems:"center",justifyContent:"space-between",spacing:0,children:e.jsxs(n,{justifyContent:"center",alignItems:"center",direction:"row",spacing:1,children:[e.jsx(R,{}),e.jsx(w,{component:N,underline:"always",to:c,href:c,target:"_blank",color:"info.main",children:c}),e.jsx(q,{variant:"outlined",size:"small",color:m?"success":"inherit",onClick:()=>{p(!0),F(c),setTimeout(()=>{p(!1)},1e3)},children:m?e.jsx(D,{sx:{color:"success"}}):e.jsx(_,{sx:{color:"text.disabled"}})})]})}),e.jsx(l,{variant:"caption",color:"text.disabled",children:$(new Date,"dd MMM yyyy hh:mm a",{locale:O})})]}):e.jsx(P,{onSuccess:t=>{a(t)}})})};te.propTypes={open:b.any,setOpen:b.func};export{te as default};
