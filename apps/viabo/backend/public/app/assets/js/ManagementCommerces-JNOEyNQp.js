import{r as T,q as g,g as P,P as L,o as I,H as w,J as D,L as y,_ as M}from"./index-8bg0y4NY.js";import{i as e,a4 as b,a6 as j,bM as z,aK as N,bN as V,P as m,r as x,w as H,V as p,T as c,B as v,aH as R,X as k,a3 as B,t as F,e as U,x as W}from"./vendor-VdGvLetj.js";import{L as _}from"./TextMaxLine-uRN92Fbv.js";import{g as G}from"./operationTypes-lL07g00g.js";import{M as $,C as K}from"./managementCommercesAdapter-gDr6KWvJ.js";import{M as q,C as J,H as Q}from"./HeaderPage-ECrT8_CG.js";import{u as X}from"./useMaterialTable-amx9ppYv.js";const Y={commerce:null,openCommerceDetails:!1,openCommerceCommissions:!1,openCommerceServices:!1},Z=(s,t)=>({...Y,setCommerce:o=>{s(r=>({commerce:o}))},setOpenCommerceDetails:o=>{s(r=>({openCommerceDetails:o}),!1,"SET_OPEN_COMMERCE_DETAILS")},setOpenCommerceCommissions:o=>{s(r=>({openCommerceCommissions:o}),!1,"SET_OPEN_COMMERCE_COMMISSIONS")},setOpenCommerceServices:o=>{s(r=>({openCommerceServices:o}),!1,"SET_OPEN_COMMERCE_SERVICES")}}),ee=T(Z);function se(s){const{row:t,closeMenu:o}=s,{original:r}=t,{setCommerce:n,setOpenCommerceDetails:i,setOpenCommerceCommissions:a,setOpenCommerceServices:d}=ee(u=>u);return[e.jsxs(b,{onClick:()=>{n(r),i(!0),o()},sx:{m:0},children:[e.jsx(j,{children:e.jsx(z,{color:"info"})}),"Ver Detalles"]},"details"),e.jsxs(b,{onClick:()=>{n(r),a(!0),o()},sx:{m:0},children:[e.jsx(j,{children:e.jsx(N,{color:"primary"})}),"Comisiones"]},"commissions"),e.jsxs(b,{onClick:()=>{n(r),d(!0),o()},sx:{m:0},children:[e.jsx(j,{children:e.jsx(V,{})}),"Servicios"]},"services")]}const A=({open:s,anchorEl:t,handlePopoverClose:o,data:r})=>{var n;return r?e.jsx(H,{id:"mouse-over-popover",sx:{pointerEvents:"none"},open:s,anchorEl:t,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},onClose:o,disableRestoreFocus:!0,slotProps:{paper:{sx:{mt:1.5,ml:.5,overflow:"inherit",boxShadow:i=>i.customShadows.z20,border:i=>`solid 1px ${i.palette.grey[5008]}`,width:200}}},children:e.jsxs(p,{spacing:2,p:2,children:[e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.name)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.phone)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Fecha Registro:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.register)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Último Inicio de Sesión:"}),e.jsx(c,{variant:"body2",children:(r==null?void 0:r.lastLogged)??"-"})]}),e.jsxs(p,{spacing:.5,flex:1,children:[e.jsx(c,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Estado:"}),e.jsx(v,{children:e.jsx(_,{variant:"ghost",color:((n=r==null?void 0:r.status)==null?void 0:n.toLowerCase())==="activo"?"success":"error",sx:{textTransform:"uppercase"},children:(r==null?void 0:r.status)??"-"})})]})]})}):null};A.propTypes={anchorEl:m.any,data:m.shape({lastLogged:m.string,name:m.string,phone:m.string,register:m.string,status:m.string}),handlePopoverClose:m.any,open:m.any};const re=x.memo(A),O=({row:s})=>{var a;const[t,o]=x.useState(null),r=d=>{o(d.currentTarget)},n=()=>{o(null)},i=!!t;return e.jsxs(e.Fragment,{children:[e.jsx(re,{anchorEl:t,open:i,handlePopoverClose:n,data:s==null?void 0:s.account}),e.jsx(v,{sx:{display:"flex",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:1},children:e.jsx(R,{color:"info.main",sx:{cursor:"auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},underline:"none",variant:"subtitle2",component:c,"aria-owns":i?"mouse-over-popover":void 0,"aria-haspopup":"true",onMouseEnter:d=>{r(d)},onMouseLeave:n,children:(a=s==null?void 0:s.account)==null?void 0:a.name})})]})};O.propTypes={row:m.shape({account:m.shape({name:m.any})})};const te={COMMERCE_LIST:"commerceList",COMMERCE_DETAILS:"commerce-details"},oe=async()=>{const{data:s}=await g.get("/api/commerces");return $(s)},Se=async s=>{const{data:t}=await g.get(`/api/commerce/${s}`);return K(t)},be=async s=>{const{data:t}=await g.post("/api/commerce/commissions/register",s);return t},je=async s=>{const{data:t}=await g.post("/api/backoffice/commerce/update",s);return t},ye=async s=>{const{data:t}=await g.put("/api/backoffice/commerce/service/update",s);return t},ne=[{id:1,name:"Registro",color:"info"},{id:2,name:"Validacion",color:"warning"},{id:3,name:"Afiliacion",color:"primary"},{id:4,name:"Cancelado",color:"error"}],ie=s=>{var t;return((t=ne.find(o=>o.id.toString()===s.toString()))==null?void 0:t.color)||"info"},ae=()=>x.useMemo(()=>[{id:"name",accessorKey:"name",header:"Nombre",enableHiding:!1,size:150,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>e.jsx(c,{fontWeight:"bold",variant:"subtitle2",children:r})},{id:"legalRepresentative",accessorFn:s=>{var t;return(t=s==null?void 0:s.account)==null?void 0:t.name},header:"Representante Legal",size:100,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>{const{original:n}=o;return e.jsx(O,{row:n})}},{id:"services",accessorFn:s=>{var t,o;return(o=(t=s==null?void 0:s.services)==null?void 0:t.names)==null?void 0:o.toString()},header:"Servicios",Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>{var a,d;const{original:n}=o,i=[];return(d=(a=n==null?void 0:n.services)==null?void 0:a.names)==null||d.forEach(l=>{const u=G(l);u&&i.push({component:u==null?void 0:u.component,name:l,width:l==="NUBE"?20:25,height:l==="NUBE"?20:25,color:l==="NUBE"?"primary.main":"inherit"})}),e.jsxs(p,{flexDirection:"row",alignItems:"center",gap:1,divider:e.jsx(k,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"double"}}),children:[(i==null?void 0:i.length)===0&&e.jsx(c,{variant:"subtitle2",fontWeight:"bold",color:"warning.main",children:"Sin Servicios"}),i==null?void 0:i.map(({component:l,width:u,height:E,name:S,color:f},h)=>e.jsx(B,{title:S,children:e.jsx(v,{display:"flex",children:e.jsx(l,{sx:{width:u,height:E,color:f}})})},h))]})}},{id:"register-status",accessorFn:s=>{var t;return(t=s==null?void 0:s.status)==null?void 0:t.step},header:"Estado Registro",minSize:100,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>e.jsx(p,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.jsx(c,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variant:"subtitle2",title:r,children:r})})},{id:"status",accessorFn:s=>{var t;return(t=s==null?void 0:s.status)==null?void 0:t.name},header:"Estado",size:70,Cell:({cell:s,column:t,row:o,renderedCellValue:r})=>{var i,a;const{original:n}=o;return e.jsx(p,{children:e.jsx(_,{size:"sm",variant:"filled",color:ie((i=n==null?void 0:n.status)==null?void 0:i.id),sx:{textTransform:"uppercase"},children:(a=n==null?void 0:n.status)==null?void 0:a.name})})}}],[]),ce=(s={})=>{const{enqueueSnackbar:t}=F(),[o,r]=x.useState(null);return{...U([te.COMMERCE_LIST],oe,{staleTime:60*5e3,onError:i=>{const a=P(i,"No se puede obtener la lista de comercios");r(a),t(a,{variant:"error",autoHideDuration:5e3})},...s}),error:o||null}};function le(){const{data:s,isLoading:t,isError:o,error:r,isFetching:n}=ce(),i=ae(),a=X(o,r,{columns:i,data:s||[],enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowActions:!0,enableRowSelection:!0,enableDensityToggle:!1,positionActionsColumn:"last",selectAllMode:"all",initialState:{density:"compact",sorting:[{id:"name",desc:!1}]},state:{isLoading:t,showAlertBanner:o,showProgressBars:n},displayColumnDefOptions:{"mrt-row-select":{maxSize:10},"mrt-row-actions":{header:"Acciones",maxSize:80}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},enableColumnResizing:!0,layoutMode:"grid",renderTopToolbarCustomActions:()=>e.jsx(v,{}),renderRowActionMenuItems:se}),d=(l=1)=>{const u=a.refs.tableContainerRef.current.offsetWidth,E=a.getState().density==="spacious"?40:a.getState().density==="comfortable"?32:16,S=20;let f=0;const h=a.getAllColumns();for(let C=0;C<h.length;C++)f+=h[C].getSize()+E,f+S>u?C>l&&h[C].toggleVisibility(!1):h[C].toggleVisibility(!0)};return x.useEffect(()=>{d(3);function l(){d(3)}window.addEventListener("resize",l)},[a,a.getState().density]),e.jsx(W,{children:e.jsx(q,{table:a})})}const me=y(x.lazy(()=>M(()=>import("./CommerceDetails-2ArfMK15.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19])))),de=y(x.lazy(()=>M(()=>import("./CommerceCommissions-doDRaE3J.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19])))),ue=y(x.lazy(()=>M(()=>import("./CommerceServices-_fH-kV8Z.js"),__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))));function pe(){return e.jsx(L,{title:"Administración Comercios",children:e.jsxs(J,{children:[e.jsx(Q,{name:"Comercios",links:[{name:"Inicio",href:I.root},{name:"Administración",href:w.commerces},{name:D.commerces.name}]}),e.jsx(le,{}),e.jsx(me,{}),e.jsx(de,{}),e.jsx(ue,{})]})})}const Me=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{te as M,je as a,be as b,ye as c,Me as d,Se as g,ee as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/CommerceDetails-2ArfMK15.js","assets/js/index-8bg0y4NY.js","assets/js/vendor-VdGvLetj.js","assets/css/build-K0YT2apu.css","assets/js/TextMaxLine-uRN92Fbv.js","assets/js/formik.esm-qswtkH0w.js","assets/js/UploadSingleFile-NApPu5jt.js","assets/js/fade-HpdRXKiE.js","assets/js/transition-Uc7vb3zK.js","assets/js/formatNumber-v_3o-PH6.js","assets/js/operationTypes-lL07g00g.js","assets/js/viabo-card-zH8OCAbq.js","assets/js/viabo-pay-zEF68lUW.js","assets/js/managementCommercesAdapter-gDr6KWvJ.js","assets/js/processList-0DUGlmod.js","assets/js/crypto-X2gsqmc7.js","assets/js/formatTime-26vjoVpy.js","assets/js/matchTypes-Lmz382Bt.js","assets/js/HeaderPage-ECrT8_CG.js","assets/js/useMaterialTable-amx9ppYv.js","assets/js/CommerceCommissions-doDRaE3J.js","assets/js/CommerceServices-_fH-kV8Z.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=ManagementCommerces-JNOEyNQp.js.map
