import{t as T,j as e,c as A,av as N,r as f,_ as B,B as j,a7 as L,S as d,a4 as _,L as E,a2 as W,T as m,ad as M,a5 as V,a8 as $,Z as U,a9 as Q,P as u,ab as q,a6 as G,af as K,ai as X,aj as Y,a as k,b as Z,g as J,aM as ee,l as se,ak as O,f as te,al as ne,am as oe,an as re}from"./build-ff249ccd.js";import{A as ae}from"./build-033677ad.js";import{a as ie,A as ce,S as le,N as de,C as he}from"./build-2a3ebcb1.js";import{D as pe}from"./build-d3854add.js";import{C as xe}from"./build-a95cd612.js";import{S as ue}from"./build-53b2acc6.js";import{L as fe,f as je}from"./build-7a360ede.js";import{L as ge,S as me,a as ye,b as Se,c as C,d as P}from"./build-82de5cdf.js";import{E as be,C as Ie,H as ve}from"./build-45c14002.js";import"./build-c35749b2.js";import{I as Ce}from"./build-c7c745f5.js";import{I as Te}from"./build-d0cdcec7.js";import{S as Le}from"./build-584ef5c3.js";const we=T(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM8.46 14.45l-1.36-.62c.28-.61.41-1.24.4-1.86-.01-.63-.14-1.24-.4-1.8l1.36-.63c.35.75.53 1.56.54 2.4.01.86-.17 1.7-.54 2.51zm3.07 1.56-1.3-.74c.52-.92.78-1.98.78-3.15 0-1.19-.27-2.33-.8-3.4l1.34-.67c.64 1.28.96 2.65.96 4.07 0 1.43-.33 2.74-.98 3.89zm3.14 1.32-1.35-.66c.78-1.6 1.18-3.18 1.18-4.69 0-1.51-.4-3.07-1.18-4.64l1.34-.67c.9 1.78 1.34 3.56 1.34 5.31 0 1.74-.44 3.54-1.33 5.35z"}),"ContactlessSharp"),Ee=T(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}),"Link"),Oe=T(e.jsx("path",{d:"M17 2H7c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 4H7V4h10v2zm3 16H4c-1.1 0-2-.9-2-2v-1h20v1c0 1.1-.9 2-2 2zm-1.47-11.81C18.21 9.47 17.49 9 16.7 9H7.3c-.79 0-1.51.47-1.83 1.19L2 18h20l-3.47-7.81zM9.5 16h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5z"}),"PointOfSale"),Pe={terminal:null},Ae=(t,s)=>({...Pe,setTerminal:a=>{const{terminal:r}=s();t(n=>({terminal:{...r,...a}}),!1,"SET_TERMINAL_SELECTED")},resetTerminal:()=>{t(a=>({pos:null}),!1,"RESET_TERMINAL_SELECTED")},addTerminalInfo:a=>{const{terminal:r}=s();t(n=>({terminal:{...r,...a}}),!1,"SET_TERMINAL_INFO")}}),S=A(Ae),_e={terminals:[],isOpenList:!0,isCollapse:!1},Me=(t,s)=>({..._e,setTerminals:a=>{t(r=>({terminals:a}),!1,"SET_TERMINAL")},setOpenList:a=>{t(r=>({isOpenList:a}),!1,"SET_OPEN_LIST")},setCollapse:a=>{t(r=>({isCollapse:a}),!1,"SET_COLLAPSE")}}),h=A(Me),ke=N(f.lazy(()=>B(()=>import("./build-9d89dcb4.js"),["assets/js/build-9d89dcb4.js","assets/js/build-ff249ccd.js","assets/css/build-2e53629c.css","assets/js/build-28b97cf9.js","assets/js/build-c35749b2.js","assets/js/build-7b23cd65.js","assets/js/build-8afc3184.js","assets/js/build-d0cdcec7.js","assets/js/build-21c8fd33.js","assets/js/build-2de398c6.js","assets/js/build-d4a81a0e.js","assets/js/build-c7c745f5.js","assets/js/build-7a360ede.js","assets/js/build-bee6630b.js","assets/js/build-2c06b33d.js","assets/js/build-177bd3ad.js","assets/js/build-deaba545.js","assets/js/build-a95cd612.js","assets/js/build-45c14002.js","assets/js/build-fb7eb957.js","assets/js/build-033677ad.js","assets/js/build-2a3ebcb1.js","assets/js/build-d3854add.js","assets/js/build-d6522b34.js","assets/js/build-0f64fb7c.js","assets/js/build-d81db254.js","assets/js/build-53b2acc6.js","assets/js/build-82de5cdf.js","assets/js/build-584ef5c3.js"]))),Re=()=>{S(n=>n.terminal);const[t,s]=f.useState(!1),[a,r]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{mb:2},children:e.jsx(L,{children:e.jsxs(d,{direction:"row",divider:e.jsx(_,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:3},spacing:1,children:[e.jsx(d,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(E,{startIcon:e.jsx(Ee,{}),variant:"contained",color:"info",onClick:()=>s(!0),children:"Liga de Pago"})}),e.jsx(d,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(E,{startIcon:e.jsx(ae,{}),color:"info",variant:"contained",onClick:()=>r(!0),children:"Terminal Virtual"})})]})})}),t&&e.jsx(ke,{open:t,setOpen:s})]})},De=()=>{const t=S(s=>s.terminal);return e.jsx(W,{sx:s=>({borderRadius:1,position:"relative",zIndex:1,backgroundColor:s.palette.primary.light,color:"white",minHeight:"auto!important",height:{xs:"auto",sm:"auto"}}),children:e.jsx(d,{flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",sx:{width:1},gap:2,py:2,alignItems:"center",children:e.jsxs(d,{flexDirection:"column",spacing:0,alignItems:{xs:"center",md:"start"},children:[e.jsx(d,{flexDirection:"row",gap:1,alignItems:"center",children:e.jsx(m,{variant:"subtitle2",children:"Disponible"})}),e.jsxs(d,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(m,{variant:"h3",children:t==null?void 0:t.balanceFormatted}),e.jsx(m,{variant:"caption",children:"MXN"})]})]})})})},ze=()=>{const[t,s]=f.useState(new Date);S(n=>n.terminal),S(n=>n.addTerminalInfo);const a=[],r=[{name:"description",label:"Descripcion",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const o=a[n],i=(o==null?void 0:o.type)==="ingreso";return e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(j,{sx:{position:"relative"},children:[e.jsx(M,{sx:{width:48,height:48,color:"text.secondary",bgcolor:"background.neutral"},children:e.jsx(ce,{width:24,height:24})}),e.jsx(j,{sx:{right:0,bottom:0,width:20,height:20,display:"flex",borderRadius:"50%",position:"absolute",alignItems:"center",color:"common.white",bgcolor:"error.main",justifyContent:"center",...i&&{bgcolor:"success.main"}},children:i?e.jsx(le,{sx:{width:15,height:15}}):e.jsx(de,{sx:{width:15,height:15}})})]}),e.jsxs(j,{sx:{ml:2},children:[e.jsx(m,{variant:"body2",sx:{color:"text.secondary"},children:i?"Recibe dinero de: ":"Retiro de dinero en:"}),e.jsxs(m,{variant:"subtitle2",children:[" ",o==null?void 0:o.description]}),(o==null?void 0:o.concept)!==""&&e.jsxs(m,{variant:"overline",color:"text.disabled",fontStyle:"italic",children:["concepto : ",o==null?void 0:o.concept]})]})]})}}},{name:"date",label:"Fecha",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const o=a[n];return e.jsxs(d,{children:[e.jsx(m,{variant:"subtitle2",children:o==null?void 0:o.date}),e.jsx(m,{variant:"body2",sx:{color:"text.secondary"},children:o==null?void 0:o.time})]})}}},{name:"amount",label:"Cantidad",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const o=a[n],i=(o==null?void 0:o.type)==="ingreso";return e.jsx(m,{variant:"subtitle2",fontWeight:"bold",color:i?"success.main":"error",children:i?`+ ${o==null?void 0:o.amount}`:`- ${o==null?void 0:o.amount}`})}}}];return e.jsxs(xe,{children:[e.jsx(ie,{currentMonth:t,setCurrentMonth:s,isLoading:!1}),e.jsx(_,{sx:{borderStyle:"dashed"}}),e.jsx(pe,{title:"Movimientos",data:a||[],columns:r,options:{responsive:"simple",rowHover:!0,selectableRows:"single",selectableRowsOnClick:!1,selectToolbarPlacement:"replace",sortOrder:{name:"date",direction:"desc"},downloadOptions:{filename:"movimientos.csv",filterOptions:{useDisplayedColumnsOnly:!1}}}})]})},Fe=()=>{const t=S(s=>s.terminal);return V(),e.jsxs(d,{sx:s=>({pl:{xs:0,lg:2},overflow:"hidden",flexDirection:"column",flexGrow:1}),children:[t&&e.jsxs(e.Fragment,{children:[e.jsx(De,{}),e.jsx(Re,{}),e.jsx(L,{children:e.jsx(d,{pt:0,pb:4,px:2,children:e.jsx(ze,{})})})]}),!t&&e.jsxs(d,{spacing:3,sx:{height:"100%",width:"100%"},children:[e.jsx($,{variant:"filled",severity:"info",children:"Debe seleccionar una terminal para ver sus detalles!"}),e.jsx(d,{alignItems:"center",children:e.jsx(ue,{sx:{width:"30%"}})})]})]})},He=U(Q)(({theme:t})=>({borderRadius:"8px!important",width:1,justifyContent:"center",display:"flex",alignItems:"center",mb:1})),R=({terminal:t})=>{const s=h(i=>i.isOpenList),a=h(i=>i.setOpenList),r=S(i=>i.setTerminal),n=S(i=>i.terminal);(t==null?void 0:t.id)===(n==null?void 0:n.id)&&n&&(n==null||n.cardON);const c=(t==null?void 0:t.id)===(n==null?void 0:n.id),o=i=>{var g;!((g=i.target)==null?void 0:g.type)&&!c&&(r(t),a(!1))};return e.jsx(q,{title:t==null?void 0:t.name,arrow:!0,placement:"right",children:e.jsx(fe,{sx:{mb:1,padding:0,borderRadius:1,"& :hover":{color:"text.primary"}},disablePadding:!0,children:e.jsxs(He,{onClick:o,sx:{...c&&{bgcolor:"secondary.light",color:"black","& :hover":{color:"text.primary"}},"& :hover":{color:"text.primary"},width:1,py:1,gap:1},children:[e.jsx(ge,{sx:{ml:2,m:0},children:e.jsx(j,{sx:{position:"relative"},children:e.jsx(M,{sx:i=>({width:32,height:32,m:0,color:i.palette.primary.contrastText,backgroundColor:i.palette.primary.main}),children:e.jsx(we,{sx:{width:20,height:20},color:"white"})})})}),s&&e.jsx(e.Fragment,{children:e.jsx(d,{sx:{width:1},children:e.jsx(m,{noWrap:!0,variant:"subtitle2",children:t==null?void 0:t.name})})})]})})})};R.propTypes={terminal:u.shape({alias:u.any,id:u.any})};const D=({terminalsQuery:t,sx:s,...a})=>{const{isLoading:r,data:n,error:c,isError:o,refetch:i}=t,y=h(l=>l.isOpenList),g=h(l=>l.terminals);return o&&y&&!n&&!r?e.jsx(G,{errorMessage:c,handleButton:i}):n&&y&&(n==null?void 0:n.length)===0&&!r?e.jsx(be,{pt:2.5,message:"No hay terminales activas para este comercio"}):e.jsx(K,{disablePadding:!0,sx:s,...a,children:(r?[...Array(12)]:g).map((l,p)=>l!=null&&l.id?e.jsx(R,{terminal:l},l==null?void 0:l.id):e.jsx(me,{isOpenSideBar:y},p))})};D.propTypes={sx:u.any,terminalsQuery:u.shape({data:u.array,error:u.any,isError:u.any,isLoading:u.any,refetch:u.any})};const z=({commerceTerminals:t=[]})=>{const s=h(x=>x.isOpenList),a=h(x=>x.setOpenList),r=h(x=>x.setTerminals),n=h(x=>x.terminals),c=h(x=>x.isCollapse),[o,i]=f.useState(""),[y,g]=f.useState(!1),l=async x=>{try{const{value:I}=x.target;if(i(I),I){const H=(t==null?void 0:t.filter(b=>{var w;return(b==null?void 0:b.alias)&&((w=b==null?void 0:b.alias)==null?void 0:w.toLowerCase().indexOf(I.toLowerCase()))!==-1}))||[];r(H)}else r(t)}catch(I){console.error(I)}},p=()=>{s&&(i(""),r(t)),a(!s)},v=()=>{g(!0)},F=()=>{g(!1)};return f.useEffect(()=>{t&&r(t)},[t]),f.useEffect(()=>{if(!s)return g(!1)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{p:2,px:0},children:e.jsxs(d,{direction:"row",justifyContent:s?"flex-end":"center",alignItems:"center",spacing:2,children:[!c&&e.jsx(he,{onClickAway:F,children:e.jsx(Ce,{fullWidth:!0,size:"small",value:o,onFocus:v,onChange:l,placeholder:"Buscar Terminales...",InputProps:{startAdornment:e.jsx(Te,{position:"start",children:e.jsx(Le,{sx:{color:"text.disabled",width:20,height:20}})})}})}),e.jsx(d,{direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(ye,{size:"small",sx:{...!s&&{transform:"rotate(180deg)"}},onClick:p,children:X})})]})}),(n==null?void 0:n.length)===0&&(t==null?void 0:t.length)>0&&e.jsx(Y,{sx:{p:1,display:"flex",flexDirection:"column",alignItems:"center"},searchQuery:o})]})};z.propTypes={commerceTerminals:u.array};const Ne={LIST:"commerce-terminals"},Be=t=>(t==null?void 0:t.map(s=>{var a,r,n,c;return{id:s==null?void 0:s.id,commerceId:s==null?void 0:s.commerceId,terminalId:s==null?void 0:s.terminalId,terminalON:((a=s==null?void 0:s.apiData)==null?void 0:a.status)===1,country:(r=s==null?void 0:s.apiData)==null?void 0:r.country,date:{created:(n=s==null?void 0:s.apiData)==null?void 0:n.created_at,updated:(c=s==null?void 0:s.apiData)==null?void 0:c.updated_at,register:s==null?void 0:s.registerDate},name:(s==null?void 0:s.name)!==""?s==null?void 0:s.name.toString().toUpperCase():`TERMINAL-${s==null?void 0:s.terminalId}`,active:(s==null?void 0:s.active)==="1",balanceFormatted:je("0")}}))||[],We=async()=>{const{data:t}=await k.get("/api/commerces/terminals");return Be(t)},rs=async t=>{const{data:s}=await k.post("/api/commerce/pay/new",t);return s},Ve=(t={})=>{const[s,a]=f.useState(null);return{...Z([Ne.LIST],We,{staleTime:6e4,refetchOnMount:"always",onError:n=>{const c=J(n,"No se puede obtener la lista de terminales del comercio. Intente nuevamente o reporte a sistemas");a(c)},...t}),error:s||null}},$e=()=>{const t=S(p=>{var v;return(v=p.terminal)==null?void 0:v.id}),s=h(p=>p.setOpenList),a=h(p=>p.setCollapse),r=h(p=>p.isOpenList),n=Ve(),c=ee(),o=se("up","md"),i=o&&!r,y=()=>{s(!1)},g=()=>{s(!r)};f.useEffect(()=>{if(!o)return y()},[o,t]),f.useEffect(()=>{a(i)},[i]);const l=e.jsx(L,{sx:{height:.98},children:e.jsxs(d,{px:r?1:0,children:[e.jsx(z,{commerceTerminals:(n==null?void 0:n.data)||[]}),e.jsx(D,{terminalsQuery:n})]})});return e.jsxs(e.Fragment,{children:[!o&&!r&&e.jsx(Se,{onClick:g,children:e.jsx(Oe,{sx:{width:16,height:16}})}),o?e.jsx(O,{open:r,variant:"persistent",PaperProps:{sx:{height:1,borderRightStyle:"none",bgcolor:"background.default"}},sx:{height:1,width:C,transition:c.transitions.create("width"),"& .MuiDrawer-paper":{position:"static",backgroundColor:"transparent!important",width:C},...i&&{width:P,"& .MuiDrawer-paper":{width:P,backgroundColor:"transparent!important",position:"static",transform:"none !important",visibility:"visible !important"}}},children:l}):e.jsx(O,{ModalProps:{keepMounted:!0},open:r,onClose:y,sx:{height:1,"& .MuiDrawer-paper":{width:C,p:2}},children:l})]})},Ue=()=>e.jsx(te,{title:"Lista de Terminales Punto de Venta",children:e.jsx(Ie,{children:e.jsxs(j,{display:"flex",overflow:"hidden",sx:{height:"100vH",maxHeight:"100%",flexDirection:"column"},children:[e.jsx(j,{px:1,children:e.jsx(ve,{name:"Terminales Punto de Venta",links:[{name:"Inicio",href:ne.root},{name:"Administracion",href:oe.cards},{name:re.terminals.name}]})}),e.jsxs(j,{display:"flex",overflow:"hidden",sx:{flex:"1 1 0%"},children:[e.jsx(j,{display:"block",width:1,position:"absolute"}),e.jsx($e,{}),e.jsx(Fe,{})]})]})})}),as=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"}));export{Ee as L,as as P,rs as c,S as u};
