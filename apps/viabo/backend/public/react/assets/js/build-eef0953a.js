import{ai as W,ah as G,W as w,am as oe,cJ as $,ac as T,d as F,r as P,aj as V,a9 as H,j as n,ad as M,ak as Q,u as q,az as J,k as K,g as te,S as I,T as E,B as ae,a1 as re,$ as se,L as ne,P as ie}from"./build-7986a927.js";import{u as le,C as Y,d as ce,p as de}from"./build-e9129f91.js";import{u as pe}from"./build-2addef6c.js";import{P as _}from"./build-695b9228.js";import{h as ue}from"./build-4f2abe34.js";import{u as ge,C as me}from"./build-a5ba9859.js";import{G as N}from"./build-6189385c.js";import{C as fe}from"./build-ed51d6ef.js";import"./build-2919a9d2.js";import"./build-e603dc94.js";import"./build-bee6630b.js";function Ce(e){return G("MuiToggleButton",e)}const xe=W("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge"]),U=xe,be=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],ve=e=>{const{classes:o,fullWidth:t,selected:a,disabled:i,size:c,color:u}=e,d={root:["root",a&&"selected",i&&"disabled",t&&"fullWidth",`size${$(c)}`,u]};return Q(d,Ce,o)},ye=w(oe,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.root,o[`size${$(t.size)}`]]}})(({theme:e,ownerState:o})=>{let t=o.color==="standard"?e.palette.text.primary:e.palette[o.color].main,a;return e.vars&&(t=o.color==="standard"?e.vars.palette.text.primary:e.vars.palette[o.color].main,a=o.color==="standard"?e.vars.palette.text.primaryChannel:e.vars.palette[o.color].mainChannel),T({},e.typography.button,{borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active},o.fullWidth&&{width:"100%"},{[`&.${U.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:F(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${U.selected}`]:{color:t,backgroundColor:e.vars?`rgba(${a} / ${e.vars.palette.action.selectedOpacity})`:F(t,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${a} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:F(t,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${a} / ${e.vars.palette.action.selectedOpacity})`:F(t,e.palette.action.selectedOpacity)}}}},o.size==="small"&&{padding:7,fontSize:e.typography.pxToRem(13)},o.size==="large"&&{padding:15,fontSize:e.typography.pxToRem(15)})}),Te=P.forwardRef(function(o,t){const a=V({props:o,name:"MuiToggleButton"}),{children:i,className:c,color:u="standard",disabled:d=!1,disableFocusRipple:C=!1,fullWidth:x=!1,onChange:m,onClick:h,selected:R,size:g="medium",value:v}=a,l=H(a,be),y=T({},a,{color:u,disabled:d,disableFocusRipple:C,fullWidth:x,size:g}),A=ve(y),O=s=>{h&&(h(s,v),s.defaultPrevented)||m&&m(s,v)};return n.jsx(ye,T({className:M(A.root,c),disabled:d,focusRipple:!C,ref:t,onClick:O,onChange:m,value:v,ownerState:y,"aria-pressed":R},l,{children:i}))}),z=Te;function he(e,o){return o===void 0||e===void 0?!1:Array.isArray(o)?o.indexOf(e)>=0:e===o}function Re(e){return G("MuiToggleButtonGroup",e)}const Oe=W("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical"]),f=Oe,De=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Pe=e=>{const{classes:o,orientation:t,fullWidth:a,disabled:i}=e,c={root:["root",t==="vertical"&&"vertical",a&&"fullWidth"],grouped:["grouped",`grouped${$(t)}`,i&&"disabled"]};return Q(c,Re,o)},Ae=w("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[{[`& .${f.grouped}`]:o.grouped},{[`& .${f.grouped}`]:o[`grouped${$(t.orientation)}`]},o.root,t.orientation==="vertical"&&o.vertical,t.fullWidth&&o.fullWidth]}})(({ownerState:e,theme:o})=>T({display:"inline-flex",borderRadius:(o.vars||o).shape.borderRadius},e.orientation==="vertical"&&{flexDirection:"column"},e.fullWidth&&{width:"100%"},{[`& .${f.grouped}`]:T({},e.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${f.selected} + .${f.grouped}.${f.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${f.selected} + .${f.grouped}.${f.selected}`]:{borderTop:0,marginTop:0}})})),Ee=P.forwardRef(function(o,t){const a=V({props:o,name:"MuiToggleButtonGroup"}),{children:i,className:c,color:u="standard",disabled:d=!1,exclusive:C=!1,fullWidth:x=!1,onChange:m,orientation:h="horizontal",size:R="medium",value:g}=a,v=H(a,De),l=T({},a,{disabled:d,fullWidth:x,orientation:h,size:R}),y=Pe(l),A=(s,b)=>{if(!m)return;const r=g&&g.indexOf(b);let p;g&&r>=0?(p=g.slice(),p.splice(r,1)):p=g?g.concat(b):[b],m(s,p)},O=(s,b)=>{m&&m(s,g===b?null:b)};return n.jsx(Ae,T({role:"group",className:M(y.root,c),ref:t,ownerState:l},v,{children:P.Children.map(i,s=>P.isValidElement(s)?P.cloneElement(s,{className:M(y.grouped,s.props.className),onChange:C?O:A,selected:s.props.selected===void 0?he(s.props.value,g):s.props.selected,size:s.props.size||R,fullWidth:x,color:s.props.color||u,disabled:s.props.disabled||d}):null)}))}),je=Ee,Se=(e,o,t)=>{let a=e;t==="2"&&(a={...e,ACTA_CONSTITUTIVA:null,DOCUMENTO_PODER:null,CEDULA_FISCAL_EMPRESA:null});const i=new FormData,c=new FormData;for(const[u,d]of Object.entries(a))if(d!==null)i.append(u,d);else{const C="",x=new File([C],`${u}.txt`,{type:"text/plain"});c.append(u,x)}return i.append("commerceId",o),c.append("commerceId",o),{uploadDocumentsForm:i,deleteDocumentsForm:c}},k={ACTA_CONSTITUTIVA:"Acta Constitutiva",DOCUMENTO_PODER:"Documento Poder",IDENTIFICACION:"Identificación",CEDULA_FISCAL_EMPRESA:"Cédula Fiscal de la Empresa",CEDULA_FISCAL_APODERADO:"Cédula Fiscal del Apoderado",COMPROBANTE_DOMICILIO:"Comprobante de Domicilio"},D={ACTA_CONSTITUTIVA:{accept:{"image/*":[".jpeg",".png"],"application/pdf":[".pdf"]},maxFiles:1,expiration:null,moralPerson:!0},DOCUMENTO_PODER:{accept:{"image/*":[".jpeg",".png"],"application/pdf":[".pdf"]},maxFiles:1,expiration:null,moralPerson:!0},IDENTIFICACION:{accept:{"image/*":[".jpeg",".png"],"application/pdf":[".pdf"]},maxFiles:1,expiration:null,moralPerson:"all"},CEDULA_FISCAL_EMPRESA:{accept:{"image/*":[".jpeg",".png"],"application/pdf":[".pdf"]},maxFiles:1,expiration:"No Mayor a 2 meses",moralPerson:!0},CEDULA_FISCAL_APODERADO:{accept:{"image/*":[".jpeg",".png"],"application/pdf":[".pdf"]},maxFiles:1,expiration:"No Mayor a 2 meses",moralPerson:"all"},COMPROBANTE_DOMICILIO:{accept:{"image/*":[".jpeg",".png"],"application/pdf":[".pdf"]},maxFiles:1,expiration:"No Mayor a 2 meses",moralPerson:"all"}},Fe=(e={})=>{const{enqueueSnackbar:o}=q(),t=J();return K({mutationFn:le,onSuccess:()=>{t.invalidateQueries([Y.COMMERCE_PROCESS]),o("Se agregaron los documentos al proceso!",{variant:"success"})},onError:a=>{const i=te(a,"No se puede agregar los doumentos al proceso");o(i,{variant:(a==null?void 0:a.status)===500?"error":"warning",autoHideDuration:5e3})},...e})},Ie=(e={})=>{const o=J();return K({mutationFn:ce,onSuccess:()=>{o.invalidateQueries([Y.COMMERCE_PROCESS])},...e})},$e=({name:e,accept:o,setFieldValue:t,file:a})=>{const i=u=>{const d=u[0];d&&t(e,Object.assign(d,{preview:URL.createObjectURL(d)}))},c=()=>{t(e,null)};return n.jsx(n.Fragment,{children:n.jsx(ue,{file:a,accept:o,onDrop:i,onRemove:c,maxSize:3145728})})},Be=$e;Me.propTypes={store:ie.shape(de)};function Me({store:e}){const{resume:o,setActualProcess:t,setLastProcess:a}=e,{files:i,fiscalTypePerson:c}=o,{enqueueSnackbar:u}=q(),{mutate:d,isLoading:C}=Fe(),{mutate:x,isLoading:m}=Ie(),{mutate:h,isLoading:R}=ge(),g=pe({initialValues:Object.keys(k).reduce((r,p)=>{var j;return r[p]=((j=i==null?void 0:i.find(S=>(S==null?void 0:S.Name)===p))==null?void 0:j.storePath)||null,r},{moralPerson:c===""?"1":c}),enableReinitialize:!0,onSubmit:r=>{const{moralPerson:p,...j}=r;if(s==null?void 0:s.some(B=>r[B]!==null)){const{deleteDocumentsForm:B,uploadDocumentsForm:X}=Se(j,o==null?void 0:o.id,p);d(X,{onSuccess:()=>{const L=s==null?void 0:s.every(ee=>r[ee]!==null),Z={...me(o,L?4:3),fiscalPersonType:p};h(Z,{onSuccess:()=>{L&&(t(_.FINISHED_PROCESS),a({info:null,name:_.COMMERCE_DOCUMENTATION}))}})}}),x(B)}else u("Se debe subir al menos un archivo!",{variant:"warning"});y(!1)}}),{handleSubmit:v,values:l,setSubmitting:y,isSubmitting:A,setFieldValue:O}=g,s=P.useMemo(()=>Object.keys(D).filter(r=>l.moralPerson==="1"?r:D[r].moralPerson===!1||D[r].moralPerson==="all"),[l.moralPerson]),b=C||A||R||m;return n.jsxs(n.Fragment,{children:[n.jsxs(I,{direction:"column",width:1,spacing:1,children:[n.jsx(E,{variant:"h4",color:"textPrimary",align:"center",children:"Documentación del Comercio"}),n.jsx(E,{paragraph:!0,align:"center",variant:"body1",color:"text.secondary",whiteSpace:"pre-line",children:"Ingrese los documentos necesarios del comercio para continuar con el proceso"})]}),n.jsx(ae,{width:1,py:4,component:"form",onSubmit:v,children:n.jsxs(I,{spacing:4,justifyContent:"center",alignItems:"center",children:[n.jsxs(je,{color:"primary",value:l==null?void 0:l.moralPerson,exclusive:!0,onChange:(r,p)=>{O("moralPerson",p)},"aria-label":"Platform",children:[n.jsx(z,{value:"1",children:"Persona Moral"}),n.jsx(z,{value:"2",children:"Persona Física"})]}),n.jsx(N,{container:!0,spacing:2,children:s==null?void 0:s.map(r=>{var p;return n.jsx(N,{item:!0,xs:12,md:6,lg:4,xl:4,children:n.jsxs(fe,{sx:{p:0,borderRadius:1},children:[n.jsx(E,{pt:2,variant:"subtitle2",color:"textPrimary",align:"center",children:k[r]}),l[r]&&typeof l[r]=="object"&&n.jsx(I,{sx:{textAlign:"center",align:"center"},children:n.jsx(E,{variant:"caption",color:"textPrimary",align:"center",children:(p=l[r])==null?void 0:p.path})}),l[r]&&typeof l[r]!="object"&&n.jsx(I,{sx:{textAlign:"center",align:"center"},children:n.jsx(re,{href:l[r],target:"_blank",children:"Ver | Descargar"})}),D[r].expiration&&n.jsx(se,{sx:{borderRadius:0,textAlign:"center",width:"100%",justifyContent:"center",display:"flex"},variant:"standard",icon:!1,color:"warning",children:n.jsx(E,{variant:"caption",color:"textSecondary",align:"center",children:D[r].expiration})}),n.jsx(Be,{name:r,accept:D[r].accept,setFieldValue:O,file:l[r]})]})},r)})}),n.jsx(ne,{loading:b,color:"primary",variant:"contained",fullWidth:!0,type:"submit",sx:{textTransform:"uppercase"},children:"Guardar"})]})})]})}export{Me as default};
