import{z as pe,j as e,C as q,r as a,_ as K,B as w,D as he,S as h,E as xe,L as se,q as ie,d as Q,g as U,G as N,H as ne,J as re,Q as X,b as fe,K as J,T as P,N as we,O as f,R as Ie,U as Ee,p as le,I as De,V as Oe,W as Re,X as Pe,Y as ge,Z as ae,m as Y,$ as Ae,a0 as Te,a1 as _e,a2 as Le,a3 as ke,a4 as Fe,a5 as Be,a6 as Ne,n as He,a7 as Ve,a8 as ze,a9 as $e,aa as We,k as qe,P as Ke,ab as Qe,ac as Ue,ad as Ge}from"./index-C406R3ty.js";import{C as A}from"./build-qjKQWaxY.js";import{u as S,M as Ye,L as Xe,F as Je}from"./build-FS0Ht2r1.js";import{u as Ce}from"./build-_2q_8fXh.js";import{C as Ze,s as et,a as tt}from"./build--__9i5ZG.js";import"./build-GJTBy67J.js";import{g as st,a as nt,b as rt,c as ot,d as it}from"./build-hKsrxe5O.js";import{L as at,I as lt}from"./build-ldM02251.js";import"./build-ZZxQy3PQ.js";import{B as ct,a as dt}from"./build-ykbm84ot.js";import{g as mt}from"./build-UXLMi8zu.js";import{M as ut}from"./build-79GBda30.js";import{u as pt}from"./build-QOkr5aEI.js";import{C as je}from"./build-38iB6sZP.js";import{C as ht}from"./build-aKDSGjg5.js";import{u as xt}from"./build-YX_hrHtz.js";import{C as ft}from"./build-Ok9bdxQY.js";import"./build-btaGkTMs.js";import{S as gt}from"./build-tho4U_WW.js";import{S as Ct}from"./build-_cs3AHNl.js";import{A as jt}from"./build-c97ZKUI0.js";import{C as yt,a as St,H as bt}from"./build-UypUDUag.js";import{M as vt}from"./build-39p-QRwT.js";import{L as Mt}from"./build-3wi0y6zP.js";import{L as wt,S as It,a as Et,b as Dt,c as te,d as ce}from"./build-4ztnasGs.js";import{s as Ot}from"./build-km8eR9Zl.js";import{E as de}from"./build-4S4YMhHj.js";import{I as Rt}from"./build-GHuRHZx5.js";import{S as Pt}from"./build-hf2Z-lwv.js";import{C as At}from"./build-7XWeDX-u.js";import{D as me}from"./build-6A_Z079A.js";import{C as Tt}from"./build-08ImWFYS.js";import"./build-ysCbZUYd.js";import"./build-UYjh2_VD.js";import"./build--uzdFUXB.js";import"./build-_XBbYtHg.js";import"./build-9E9tHrZa.js";import"./build-uh7Bczik.js";import"./build-xPOX7B9L.js";import"./build-KIH6eYLU.js";import"./build-_6vnnb0s.js";import"./build-3eCihODq.js";import"./build-OsaRfRsO.js";import"./build-5t1lJgEW.js";import"./build-SlSoc0xV.js";import"./build-arySZ8p4.js";import"./build-BzeQqsN5.js";import"./build-hJEO-Ml4.js";import"./build-wZYASfTh.js";import"./build-S6p02zpV.js";import"./build-zH8OCAbq.js";import"./build-zEF68lUW.js";import"./build-Ccv5rkT2.js";import"./build-UlczVlm5.js";import"./build-XbXyf4hh.js";import"./build-a2xF6bjU.js";import"./build-Uc7vb3zK.js";import"./build-v6oTCMsm.js";const ue=pe(e.jsx("path",{d:"M2 17h20v2H2v-2zm1.15-4.05L4 11.47l.85 1.48 1.3-.75-.85-1.48H7v-1.5H5.3l.85-1.47L4.85 7 4 8.47 3.15 7l-1.3.75.85 1.47H1v1.5h1.7l-.85 1.48 1.3.75zm6.7-.75 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H15v-1.5h-1.7l.85-1.47-1.3-.75L12 8.47 11.15 7l-1.3.75.85 1.47H9v1.5h1.7l-.85 1.48zM23 9.22h-1.7l.85-1.47-1.3-.75L20 8.47 19.15 7l-1.3.75.85 1.47H17v1.5h1.7l-.85 1.48 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H23v-1.5z"}),"PasswordTwoTone"),_t=pe(e.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm-8 6H8v1h3c.55 0 1 .45 1 1v3c0 .55-.45 1-1 1h-1v1H8v-1H6v-2h4v-1H7c-.55 0-1-.45-1-1V9c0-.55.45-1 1-1h1V7h2v1h2v2zm4 6.25-2-2h4l-2 2zM14 10l2-2 2 2h-4z"}),"PriceChange"),Lt=q(a.lazy(()=>K(()=>import("./build-Xu-XCazp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43])))),kt=q(a.lazy(()=>K(()=>import("./build-A065NZUw.js"),__vite__mapDeps([44,1,2,19,18,20,21,22,5,16,17,4,11,40,28,45,6,7,8,9,10,12,13,14,15,23,24,25,26,27,29,30,31,32,33,34,35,36,37,38,39,41,42]))));function Ft(){const[t,r]=a.useState(!1),[o,l]=a.useState(!1),i=S(s=>s.card),d=Ce([A.CARD_INFO,i==null?void 0:i.id])===1;return e.jsxs(e.Fragment,{children:[e.jsx(w,{children:e.jsx(he,{children:e.jsxs(h,{direction:"row",divider:e.jsx(xe,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:3},spacing:1,children:[e.jsx(h,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(se,{disabled:d,startIcon:e.jsx(_t,{}),variant:"outlined",onClick:()=>l(!0),children:"Enviar Pago"})}),e.jsx(h,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(se,{disabled:(i==null?void 0:i.balance)===0||!(i!=null&&i.cardON)||d,startIcon:e.jsx(Ze,{}),variant:"outlined",onClick:()=>r(!0),children:"Transferir"})})]})})}),e.jsx(Lt,{setOpen:r,open:t}),e.jsx(kt,{setOpen:l,open:o})]})}ie("div")({display:"flex",justifyContent:"space-between"});const Bt=(t,r={})=>{const[o,l]=a.useState(null);return{...Q([A.CARDS_COMMERCE_LIST,t],()=>st(t),{staleTime:6e4,refetchOnMount:"always",onError:d=>{const s=U(d,"No se puede obtener la lista de tarjetas. Intente nuevamente o reporte a sistemas");l(s)},...r}),error:o||null}},Nt=(t,r={})=>{const[o,l]=a.useState(null);return{...Q([A.CARD_INFO,t],({signal:d})=>nt(t,d),{staleTime:6e4,onError:d=>{const s=U(d,"No se puede obtener la informacion de la tarjeta. Intente nuevamente o reporte a sistemas");l(s)},refetchOnWindowFocus:!1,...r}),error:o||null}},Ht=(t,r,o,l={})=>{if(!r||!o)return null;const i=N(ne(r),"yyyy-MM-dd"),d=N(re(o),"yyyy-MM-dd"),[s,n]=a.useState(null),m=S(y=>y.addInfoCard);return{...Q([A.CARD_MOVEMENTS,t],({signal:y})=>rt(t,i,d,y),{staleTime:6e4,retry:!1,refetchOnWindowFocus:!1,onError:y=>{const g=U(y,"No se puede obtener la lista de movimientos de la tarjeta. Intente nuevamente o reporte a sistemas");n(g),X.error(g,{type:fe(y)}),m({monthBalance:null,filterDate:{startDate:ne(r),endDate:re(o),text:`${N(r,"dd MMMM yyyy",{locale:J})} - ${N(o,"dd MMMM yyyy",{locale:J})}`},movements:[],expenses:"$0.00",income:"$0.00",balanceMovements:"$0.00"})},...l}),error:s||null}},Vt=q(a.lazy(()=>K(()=>import("./build-_A5cIx0N.js"),__vite__mapDeps([46,1,2,9,5,10,11,19,35,36,37,38,18,20,21,22,16,17,4,39,24,25,26,27,28,40,45])))),zt=q(a.lazy(()=>K(()=>import("./build-oQRX_DfE.js"),__vite__mapDeps([47,1,2,35,36,37,38])))),$t=q(a.lazy(()=>K(()=>import("./build-xJR-hwI2.js"),__vite__mapDeps([48,1,2,35,36,37,38,22,5,24,25,21,9,10,11,26,27,28,4,20]))));function Wt(){var W,B;const[t,r]=a.useState(!1),[o,l]=a.useState(!1),[i,d]=a.useState(!1),[s,n]=a.useState(null),m=S(u=>u.card),I=S(u=>u.addInfoCard),y=new Date,g=et(y,{days:30}),b=y,[E,T]=a.useState(g),[D,k]=a.useState(b),{data:O,isLoading:H,refetch:Z,isFetching:j,isError:V,error:z}=Ht(m==null?void 0:m.id,E,D,{enabled:!1}),G=(O==null?void 0:O.movements)||[],F=a.useMemo(()=>[{accessorKey:"description",header:"Movimiento",enableHiding:!1,minSize:200,Cell:({cell:u,column:C,row:x})=>{const{original:c}=x;return e.jsx(Ye,{row:c})}},{accessorKey:"serverDate",header:"Fecha",size:120,Cell:({cell:u,column:C,row:x})=>{const{original:c}=x;return e.jsx(h,{children:e.jsx(P,{variant:"subtitle2",children:c==null?void 0:c.fullDate})})}},{accessorKey:"operationType",header:"Tipo",filterVariant:"multi-select",size:100,Cell:({cell:u,column:C,row:x})=>{const{original:c}=x,M=mt(c==null?void 0:c.operationType),p=M==null?void 0:M.component;return e.jsx(w,{children:M?e.jsx(p,{sx:{width:25,height:25}}):e.jsx(Xe,{size:22})})}},{accessorKey:"amount",header:"Monto",size:100,Cell:({cell:u,column:C,row:x})=>{const{original:c}=x,M=(c==null?void 0:c.type)==="ingreso",p=(c==null?void 0:c.type)==="terminal";return e.jsx(P,{variant:"subtitle2",fontWeight:"bold",color:M||p?"success.main":"error",children:M||p?`+ ${c==null?void 0:c.amountFormat}`:`- ${c==null?void 0:c.amountFormat}`})}},{accessorKey:"verified",header:"ComprobaciÃ³n",size:80,Cell:({cell:u,column:C,row:x})=>{const{original:c}=x;return e.jsx(h,{flexDirection:"row",width:1,justifyContent:"center",alignItems:"center",gap:1,mr:2,color:"primary",children:c!=null&&c.verified?e.jsx(ct,{color:"green",fontWeight:"bold",fontSize:"18px"}):e.jsx(dt,{fontSize:"18px",color:"red"})})}}],[]);a.useEffect(()=>{E&&D&&Z()},[E,D]),a.useEffect(()=>{T(g),k(b)},[m==null?void 0:m.id]),a.useEffect(()=>{if(O){const u={startDate:ne(E),endDate:re(D),text:`${N(E,"dd MMMM yyyy",{locale:J})} - ${N(D,"dd MMMM yyyy",{locale:J})}`};I({...O,filterDate:u})}},[O,m==null?void 0:m.id,E,D]);const v=pt(V,z,{columns:F,data:G||[],enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowActions:!0,enableRowSelection:!0,positionActionsColumn:"last",enableDensityToggle:!1,selectAllMode:"all",initialState:{density:"compact",sorting:[{id:"serverDate",desc:!0}]},state:{isLoading:H,showAlertBanner:V,showProgressBars:j},displayColumnDefOptions:{"mrt-row-select":{maxSize:10},"mrt-row-actions":{header:"Acciones",maxSize:80}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},renderTopToolbarCustomActions:({table:u})=>e.jsx(w,{sx:{display:"flex",gap:"1rem"},children:e.jsx(se,{loading:j,onClick:L(u),disabled:$(),startIcon:e.jsx(je,{width:24,height:24}),variant:"outlined",children:"Comprobar"})}),renderRowActionMenuItems:({row:u,closeMenu:C})=>[e.jsx(we,{onClick:()=>{const{original:x}=u;n(x),C(),r(!0)},children:"Incidencia"},"incidence")]}),_=((W=v==null?void 0:v.getSelectedRowModel().flatRows)==null?void 0:W.map(u=>u.original))??[],$=a.useCallback(()=>{var x;const u=_.length>0?(x=_[0])==null?void 0:x.paymentProcessor:null;return!!!(_.every(c=>c.paymentProcessor===u)&&(v!=null&&v.getIsSomeRowsSelected()))},[_,v]),L=u=>()=>{var M;const C=((M=u==null?void 0:u.getSelectedRowModel().flatRows)==null?void 0:M.map(p=>p.original))??[],x=C==null?void 0:C.some(p=>p==null?void 0:p.verified),c=C==null?void 0:C.some(p=>(p==null?void 0:p.operationType)!=="OTROS CARGOS");return x?X.warn("Existen movimientos que ya se encuentran comprobados, verifique los movimientos seleccionados."):c?X.warn("Existen movimientos que no se pueden comprobar, verifique el tipo de movimiento."):l(!0)},ee=u=>{const{startDate:C,endDate:x}=u;x!==null&&C!==null&&(k(x),T(C))};return e.jsxs(e.Fragment,{children:[e.jsxs(ht,{children:[e.jsx(tt,{startDate:E,endDate:D,onChangeDateRange:ee,onOpenBalance:()=>d(!0),loading:j}),e.jsx(ut,{table:v})]}),e.jsx(Vt,{open:t,setOpen:r,selectedMovement:s}),e.jsx(zt,{open:o,setOpen:l,movements:_??[]}),e.jsx($t,{open:i,card:m,dateRange:(B=m==null?void 0:m.filterDate)==null?void 0:B.text,onClose:()=>{d(!1)}})]})}const qt=ie(t=>e.jsx(gt,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(({theme:t})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:t.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:t.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:t.palette.error.main,opacity:1,transition:t.transitions.create(["background-color"],{duration:500})}}));function ye({card:t}){const[r,o]=a.useState(!1),[l,i]=a.useState(!1),[d,s]=a.useState(!1),{mutate:n,isLoading:m}=xt(),I=Ce([A.CARD_INFO,t==null?void 0:t.id])===1;a.useEffect(()=>{o(!1),i(!1)},[t==null?void 0:t.id]);const y=g=>{n({...t,cardON:!(t!=null&&t.cardON)})};return e.jsx(Ie,{sx:g=>({borderRadius:1,position:"relative",zIndex:1,backgroundColor:g.palette.primary.light,color:g.palette.primary.contrastText,minHeight:"auto!important",height:{xs:1,sm:"auto"},py:{xs:0,sm:2}}),children:e.jsxs(h,{flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",sx:{width:1},gap:2,alignItems:"center",children:[e.jsxs(h,{flexDirection:"column",spacing:0,alignItems:{xs:"center",md:"start"},children:[e.jsxs(h,{flexDirection:"row",gap:1,alignItems:"center",children:[e.jsx(P,{variant:"subtitle2",children:"Disponible"}),m||I?e.jsx(Ee,{size:30,containerProps:{display:"flex",ml:1}}):e.jsx(qt,{disabled:m,color:t!=null&&t.cardON?"success":"error",checked:(t==null?void 0:t.cardON)||!1,onChange:y,sx:{m:1},inputProps:{"aria-label":"controlled"}})]}),e.jsxs(h,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(P,{variant:"h3",children:t==null?void 0:t.balanceFormatted}),e.jsx(P,{variant:"caption",children:"MXN"})]})]}),e.jsxs(h,{justifyContent:"flex-end",spacing:1,alignItems:{xs:"center",md:"end"},children:[e.jsx(ft,{card:t}),e.jsxs(h,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",gap:1,divider:e.jsx(xe,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),children:[e.jsx(P,{variant:"subtitle2",children:t==null?void 0:t.expiration}),e.jsx(le,{startIcon:r?e.jsx(oe,{handleFinish:()=>o(!1)}):e.jsx(ue,{}),color:"inherit",onClick:()=>o(g=>!g),sx:{px:0,mx:0},children:r?e.jsx(h,{px:1,children:t==null?void 0:t.cvv}):"CVV"}),e.jsx(le,{startIcon:l?e.jsx(oe,{handleFinish:()=>i(!1)}):e.jsx(ue,{}),color:"inherit",onClick:()=>i(g=>!g),children:l?e.jsx(h,{px:1,children:t==null?void 0:t.nip}):"NIP"}),e.jsx(De,{variant:"outlined",title:`Copiar SPEI - ${t==null?void 0:t.SPEI}`,color:d?"success":"inherit",onClick:g=>{s(!0),Oe(t==null?void 0:t.SPEI),setTimeout(()=>{s(!1)},1e3)},children:d?e.jsx(je,{sx:{color:"success",width:25,height:25}}):e.jsx(Re,{sx:{width:25,height:25},invert:!0})})]})]})]})})}ye.propTypes={card:f.shape({balanceFormatted:f.any,cardON:f.bool,cvv:f.any,expiration:f.any,id:f.any,nip:f.any})};function oe({handleFinish:t,duration:r=10}){const[o,l]=a.useState(100);return a.useEffect(()=>{let i;return o>0?i=setInterval(()=>{l(d=>d-100/r)},1e3):t(),()=>clearInterval(i)},[o,r]),e.jsxs(w,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(Pe,{color:"secondary",variant:"determinate",value:o}),e.jsx(w,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(P,{variant:"caption",component:"div",color:"text.primary.contrastText",children:`${Math.ceil(r*o/100)} `})})]})}oe.propTypes={duration:f.number,handleFinish:f.func};function Kt(){const t=S(n=>n.card),r=S(n=>n.addInfoCard),{data:o,isLoading:l,isError:i,error:d,refetch:s}=Nt(t==null?void 0:t.id,{enabled:!!(t!=null&&t.id)});return a.useEffect(()=>{o&&r(o)},[o]),e.jsx(h,{sx:n=>({pl:{xs:0,sm:2,lg:2},overflow:"hidden",flexDirection:"column",flexGrow:1}),children:e.jsxs(jt,{children:[l&&t&&e.jsx(ge,{}),i&&!o&&!l&&e.jsx(ae,{sx:{justifyContent:"flex-start"},errorMessage:d,handleButton:s}),t&&!l&&!i&&o&&e.jsxs(e.Fragment,{children:[e.jsx(Y.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsxs(h,{sx:n=>({overflow:"hidden",flexDirection:"column",flexGrow:1}),children:[e.jsx(ye,{card:t}),e.jsx(Ft,{})]})}),e.jsx(w,{sx:{overflowY:"auto"},children:e.jsx(Y.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsx(h,{pt:2,pb:4,children:e.jsx(Wt,{})})})})]}),!t&&e.jsx(Y.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsxs(h,{spacing:3,sx:{height:"100%",width:"100%"},children:[e.jsx(Ae,{variant:"filled",severity:"info",children:"Debe seleccionar una tarjeta para ver sus detalles!"}),e.jsx(h,{alignItems:"center",children:e.jsx(Ct,{sx:{width:"30%"}})})]})})]})})}const Qt=ie(Te)(({theme:t})=>({borderRadius:"8px!important",width:1,justifyContent:"center",display:"flex",alignItems:"center",mb:1}));Se.propTypes={isOpenSidebar:f.bool,card:f.object,onOpenDetails:f.func};function Se({isOpenSidebar:t,card:r,onOpenDetails:o}){const{id:l,cardUserNumber:i,cardType:d}=r,s=S(b=>b.setCard),n=S(b=>b.card),m=S(b=>b.addInfoCard),I=l===(n==null?void 0:n.id)&&n?(n==null?void 0:n.cardON)===!0?"online":"offline":"invisible",y=l===(n==null?void 0:n.id),g=b=>{var T;!((T=b.target)==null?void 0:T.type)&&!y&&(s(r),m({movements:[],expenses:"$0.00",income:"$0.00",balanceMovements:"$0.00"}),o())};return e.jsx(_e,{title:t?"":i,arrow:!0,placement:"right",children:e.jsx(Mt,{sx:{mb:1,padding:0,borderRadius:1,"& :hover":{color:"text.primary"}},disablePadding:!0,children:e.jsxs(Qt,{onClick:g,sx:{...y&&{bgcolor:"secondary.light",color:"text.primary.contrastText","& :hover":{color:"text.primary"}},"& :hover":{color:"text.primary"},width:1,py:1,gap:1},children:[e.jsx(wt,{sx:{ml:2,m:0},children:e.jsxs(w,{sx:{position:"relative"},children:[e.jsx(Le,{sx:b=>({width:30,height:30,m:0,color:b.palette.primary.contrastText,backgroundColor:b.palette.primary.light}),children:d==="Carnet"?e.jsx(yt,{basedOnTheme:!0,sx:{width:20}}):e.jsx(vt,{sx:{width:20}})}),e.jsx(ke,{status:I,sx:{right:0,bottom:0,position:"absolute"}})]})}),t&&e.jsx(e.Fragment,{children:e.jsx(h,{sx:{width:1},children:e.jsx(P,{noWrap:!0,variant:"subtitle2",children:i})})})]})})})}const Ut=a.memo(Se);be.propTypes={cards:f.array,isOpenSidebar:f.bool,onOpenDetails:f.func,isLoading:f.bool,sx:f.object};function be({cards:t,isOpenSidebar:r,isLoading:o,sx:l,onOpenDetails:i,...d}){return e.jsx(Fe,{disablePadding:!0,sx:l,...d,children:(o?[...Array(5)]:t).map((s,n)=>s!=null&&s.id?e.jsx(Ut,{isOpenSidebar:r,card:s,onOpenDetails:i},s==null?void 0:s.id):e.jsx(It,{isOpenSideBar:r},n))})}function ve({cardTypes:t,isLoading:r,isError:o,refetch:l}){const i=S(n=>n.setCardTypeSelected),d=S(n=>n.cardTypeSelected),s=n=>{i(n==null?void 0:n.id)};return e.jsxs(w,{display:"flex",children:[r&&e.jsx(ge,{}),o&&!r&&e.jsx(ae,{errorMessage:"No existen tipos de tarjetas para este comercio",handleButton:l}),!r&&!o&&(t==null?void 0:t.map(n=>{const m=d===(n==null?void 0:n.id);return e.jsx(at,{variant:m?"ghost":"filled",color:Be((n==null?void 0:n.name)||"inherit"),sx:{textTransform:"uppercase",marginRight:1,marginBottom:2,cursor:"pointer",border:m?3:0,borderColor:m?I=>I.palette.primary.main:"inherit"},children:e.jsx(Y.div,{onClick:()=>s(n),whileHover:{scale:1.03},whileTap:{scale:.8},children:n==null?void 0:n.name},n==null?void 0:n.id)},n==null?void 0:n.id)}))]})}ve.propTypes={cardTypes:f.array,isError:f.any,isLoading:f.any,refetch:f.any};const Gt=(t={})=>{const[r,o]=a.useState(null),l=S(s=>s.setCardTypeSelected),i=S(s=>s.cardTypeSelected);return{...Q([A.PAYMENT_PROCESSORS],ot,{staleTime:6e4,refetchOnMount:"always",onError:s=>{const n=U(s,"No se puede obtener la lista de los tipos de tarjetas. Intente nuevamente o reporte a sistemas");o(n)},onSuccess:s=>{const n=(s==null?void 0:s.find(m=>(m==null?void 0:m.id)==="2"))||Array.isArray(s)&&(s==null?void 0:s.length)>0&&s[0]||null;n&&!i&&l(n==null?void 0:n.id)},...t}),error:r||null}},Yt=(t,r={})=>{const[o,l]=a.useState(null),i=S(s=>s.setMainCard);return{...Q([A.MAIN_CARD],({signal:s})=>it(t,s),{staleTime:6e4,refetchOnWindowFocus:!1,onError:s=>{const n=U(s,"No se puede obtener la informacion de la tarjeta principal");l(n),i(null),X.error(n,{type:fe(s)})},onSuccess:s=>{i(s)},...r}),error:o||null}};function Xt(){const t=S(p=>{var R;return(R=p.card)==null?void 0:R.id}),r=S(p=>p.cardTypeSelected),{data:o,isLoading:l,isError:i,refetch:d}=Gt(),{data:s,isLoading:n,isRefetching:m,isError:I,error:y,refetch:g,isSuccess:b}=Bt(r,{enabled:!1}),{data:E,refetch:T,isLoading:D}=Yt(r,{enabled:!1}),k=Ne(),O=(k==null?void 0:k.permissions)??[],H=n||m,Z=He(),[j,V]=a.useState(!0),[z,G]=a.useState(""),[F,v]=a.useState(s||[]),[_,$]=a.useState(!1),L=Ve("up","md"),ee=z&&_,W=L&&!j;a.useEffect(()=>{r&&g(),r&&O.includes(ze.COMMERCE_CARDS)&&T()},[r]),a.useEffect(()=>{if(!L)return B()},[L,t]),a.useEffect(()=>{if(!j)return $(!1)},[j]),a.useEffect(()=>{s&&v(s)},[s]);const B=()=>{V(!1)},u=()=>{V(p=>(p&&(G(""),v(s)),!p))},C=()=>{$(!1)},x=async p=>{try{const{value:R}=p.target;if(G(R),R){const Me=Ot(s,R)||[];v(Me)}else v(s)}catch(R){console.error(R)}},c=()=>{$(!0)},M=e.jsxs(e.Fragment,{children:[e.jsxs(h,{children:[j&&e.jsx(ve,{cardTypes:o,isLoading:l,isError:i,refetch:d}),!r&&j&&!l&&e.jsx(de,{pt:2.5,message:"Seleccione un tipo de tarjeta para obtener la lista de tarjetas"})]}),r&&!l&&!i&&e.jsxs(e.Fragment,{children:[e.jsx(w,{sx:{p:2,px:0},children:e.jsxs(h,{direction:"row",justifyContent:j?"flex-end":"center",alignItems:"center",spacing:2,children:[!W&&e.jsx(Tt,{onClickAway:C,children:e.jsx(lt,{fullWidth:!0,size:"small",value:z,onFocus:c,onChange:x,placeholder:"Buscar Tarjetas...",InputProps:{startAdornment:e.jsx(Rt,{position:"start",children:e.jsx(Pt,{sx:{color:"text.disabled",width:20,height:20}})})}})}),e.jsx(h,{direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(Et,{size:"small",sx:{...!j&&{transform:"rotate(180deg)"}},onClick:u,children:$e})})]})}),I&&j&&!s&&!H&&e.jsx(ae,{errorMessage:y,handleButton:g}),s&&j&&(s==null?void 0:s.length)===0&&!H&&e.jsx(de,{pt:2.5,message:"No hay tarjetas activas en este tipo de tarjeta"}),e.jsx(he,{sx:{height:.98},children:e.jsxs(e.Fragment,{children:[e.jsx(be,{isOpenSidebar:j,cards:F||[],isLoading:H,onOpenDetails:B}),ee&&(F==null?void 0:F.length)===0&&(s==null?void 0:s.length)>0&&e.jsx(We,{sx:{p:1,display:"flex",flexDirection:"column",alignItems:"center"},searchQuery:z})]})})]})]});return e.jsxs(e.Fragment,{children:[!L&&!j&&e.jsx(Dt,{onClick:u,children:e.jsx(At,{sx:{width:16,height:16}})}),L?e.jsx(me,{open:j,variant:"persistent",PaperProps:{sx:{height:1,borderRightStyle:"none",bgcolor:"background.default"}},sx:{height:1,width:te,transition:Z.transitions.create("width"),"& .MuiDrawer-paper":{position:"static",backgroundColor:"transparent!important",width:te},...W&&{width:ce,"& .MuiDrawer-paper":{width:ce,backgroundColor:"transparent!important",position:"static",transform:"none !important",visibility:"visible !important"}}},children:M}):e.jsx(me,{ModalProps:{keepMounted:!0},open:j,onClose:B,sx:{height:1,"& .MuiDrawer-paper":{width:te,p:2}},children:M})]})}function sn(){const t=qe();return a.useEffect(()=>()=>{const r=Object.values(A);t.cancelQueries(r)},[]),e.jsx(Ke,{title:"Lista de Tarjetas",children:e.jsxs(St,{children:[e.jsxs(w,{display:"flex",overflow:"hidden",sx:{height:"100vH",maxHeight:"100%",flexDirection:"column"},children:[e.jsx(w,{px:1,children:e.jsx(bt,{name:"Lista de Tarjetas",links:[{name:"Inicio",href:Qe.root},{name:"Viabo Card",href:Ue.cards},{name:Ge.cards.name}]})}),e.jsxs(w,{display:"flex",overflow:"hidden",sx:{flex:"1 1 0%"},children:[e.jsx(w,{display:"block",width:1,position:"absolute"}),e.jsx(Xt,{}),e.jsx(Kt,{})]})]}),e.jsx(Je,{})]})})}export{sn as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/build-Xu-XCazp.js","assets/js/index-C406R3ty.js","assets/css/build-D8PjCv5v.css","assets/js/build-qjKQWaxY.js","assets/js/build-3wi0y6zP.js","assets/js/build-uh7Bczik.js","assets/js/build-FS0Ht2r1.js","assets/js/build-ysCbZUYd.js","assets/js/build-UYjh2_VD.js","assets/js/build-UypUDUag.js","assets/js/build-v6oTCMsm.js","assets/js/build-5t1lJgEW.js","assets/js/build-39p-QRwT.js","assets/js/build--uzdFUXB.js","assets/js/build-_XBbYtHg.js","assets/js/build-GJTBy67J.js","assets/js/build-c97ZKUI0.js","assets/js/build-Uc7vb3zK.js","assets/js/build-ldM02251.js","assets/js/build-KIH6eYLU.js","assets/js/build-tho4U_WW.js","assets/js/build-UlczVlm5.js","assets/js/build-9E9tHrZa.js","assets/js/build-xPOX7B9L.js","assets/js/build-79GBda30.js","assets/js/build-Ccv5rkT2.js","assets/js/build-arySZ8p4.js","assets/js/build-_6vnnb0s.js","assets/js/build-GHuRHZx5.js","assets/js/build-08ImWFYS.js","assets/js/build-hKsrxe5O.js","assets/js/build-BzeQqsN5.js","assets/js/build-hJEO-Ml4.js","assets/js/build-wZYASfTh.js","assets/js/build-S6p02zpV.js","assets/js/build-btaGkTMs.js","assets/js/build-aKDSGjg5.js","assets/js/build-6A_Z079A.js","assets/js/build-4S4YMhHj.js","assets/js/build-3eCihODq.js","assets/js/build-OsaRfRsO.js","assets/js/build-38iB6sZP.js","assets/js/build-SlSoc0xV.js","assets/js/build-605KQGNE.js","assets/js/build-A065NZUw.js","assets/js/build-U-pYa7Fh.js","assets/js/build-_A5cIx0N.js","assets/js/build-oQRX_DfE.js","assets/js/build-xJR-hwI2.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}