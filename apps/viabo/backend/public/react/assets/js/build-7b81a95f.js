import{t as T,j as e,c as A,av as B,r as f,_ as N,B as j,a5 as L,S as d,a3 as _,L as E,a1 as W,T as m,ab as M,a4 as V,a6 as $,Z as Q,a7 as U,P as u,a9 as q,O as G,ad as K,ag as X,ah as Y,a as k,b as Z,g as J,aM as ee,l as se,ai as O,f as te,aj as ne,ak as re,al as oe}from"./build-64a25fd4.js";import{A as ae}from"./build-7837c44d.js";import{a as ie,A as ce,S as le,N as de,C as he}from"./build-fc19efb2.js";import{D as pe}from"./build-6b17aba2.js";import{C as xe}from"./build-77003c42.js";import{S as ue}from"./build-66e8ef2d.js";import{L as fe,f as je}from"./build-977b7120.js";import{L as ge,S as me,a as ye,b as Se,c as C,d as P}from"./build-78598d2c.js";import{E as be,C as ve,H as Ie}from"./build-d41b3d80.js";import"./build-0a1457f9.js";import{I as Ce}from"./build-81b4defd.js";import{I as Te}from"./build-8fe9665e.js";import{S as Le}from"./build-4a3935ac.js";const we=T(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM8.46 14.45l-1.36-.62c.28-.61.41-1.24.4-1.86-.01-.63-.14-1.24-.4-1.8l1.36-.63c.35.75.53 1.56.54 2.4.01.86-.17 1.7-.54 2.51zm3.07 1.56-1.3-.74c.52-.92.78-1.98.78-3.15 0-1.19-.27-2.33-.8-3.4l1.34-.67c.64 1.28.96 2.65.96 4.07 0 1.43-.33 2.74-.98 3.89zm3.14 1.32-1.35-.66c.78-1.6 1.18-3.18 1.18-4.69 0-1.51-.4-3.07-1.18-4.64l1.34-.67c.9 1.78 1.34 3.56 1.34 5.31 0 1.74-.44 3.54-1.33 5.35z"}),"ContactlessSharp"),Ee=T(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}),"Link"),Oe=T(e.jsx("path",{d:"M17 2H7c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 4H7V4h10v2zm3 16H4c-1.1 0-2-.9-2-2v-1h20v1c0 1.1-.9 2-2 2zm-1.47-11.81C18.21 9.47 17.49 9 16.7 9H7.3c-.79 0-1.51.47-1.83 1.19L2 18h20l-3.47-7.81zM9.5 16h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5z"}),"PointOfSale"),Pe={terminal:null},Ae=(t,s)=>({...Pe,setTerminal:a=>{const{terminal:o}=s();t(n=>({terminal:{...o,...a}}),!1,"SET_TERMINAL_SELECTED")},resetTerminal:()=>{t(a=>({pos:null}),!1,"RESET_TERMINAL_SELECTED")},addTerminalInfo:a=>{const{terminal:o}=s();t(n=>({terminal:{...o,...a}}),!1,"SET_TERMINAL_INFO")}}),S=A(Ae),_e={terminals:[],isOpenList:!0,isCollapse:!1},Me=(t,s)=>({..._e,setTerminals:a=>{t(o=>({terminals:a}),!1,"SET_TERMINAL")},setOpenList:a=>{t(o=>({isOpenList:a}),!1,"SET_OPEN_LIST")},setCollapse:a=>{t(o=>({isCollapse:a}),!1,"SET_COLLAPSE")}}),h=A(Me),ke=B(f.lazy(()=>N(()=>import("./build-5db9c74b.js"),["assets/js/build-5db9c74b.js","assets/js/build-64a25fd4.js","assets/css/build-2e53629c.css","assets/js/build-6c823b45.js","assets/js/build-0a1457f9.js","assets/js/build-395776f7.js","assets/js/build-9cd5ca94.js","assets/js/build-8fe9665e.js","assets/js/build-43ec3615.js","assets/js/build-7b77a3a8.js","assets/js/build-6e98428f.js","assets/js/build-81b4defd.js","assets/js/build-977b7120.js","assets/js/build-bee6630b.js","assets/js/build-29655094.js","assets/js/build-3077ef03.js","assets/js/build-88ac29fe.js","assets/js/build-77003c42.js","assets/js/build-d41b3d80.js","assets/js/build-8a62fdc4.js","assets/js/build-7837c44d.js","assets/js/build-fc19efb2.js","assets/js/build-6b17aba2.js","assets/js/build-7d9da98f.js","assets/js/build-e303152c.js","assets/js/build-ab3ce0c4.js","assets/js/build-66e8ef2d.js","assets/js/build-78598d2c.js","assets/js/build-4a3935ac.js"]))),Re=()=>{S(n=>n.terminal);const[t,s]=f.useState(!1),[a,o]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{mb:2},children:e.jsx(L,{children:e.jsxs(d,{direction:"row",divider:e.jsx(_,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:3},spacing:1,children:[e.jsx(d,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(E,{startIcon:e.jsx(Ee,{}),variant:"contained",color:"info",onClick:()=>s(!0),children:"Liga de Pago"})}),e.jsx(d,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(E,{startIcon:e.jsx(ae,{}),color:"info",variant:"contained",onClick:()=>o(!0),children:"Terminal Virtual"})})]})})}),t&&e.jsx(ke,{open:t,setOpen:s})]})},De=()=>{const t=S(s=>s.terminal);return e.jsx(W,{sx:s=>({borderRadius:1,position:"relative",zIndex:1,backgroundColor:s.palette.primary.light,color:"white",minHeight:"auto!important",height:{xs:"auto",sm:"auto"}}),children:e.jsx(d,{flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",sx:{width:1},gap:2,py:2,alignItems:"center",children:e.jsxs(d,{flexDirection:"column",spacing:0,alignItems:{xs:"center",md:"start"},children:[e.jsx(d,{flexDirection:"row",gap:1,alignItems:"center",children:e.jsx(m,{variant:"subtitle2",children:"Disponible"})}),e.jsxs(d,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(m,{variant:"h3",children:t==null?void 0:t.balanceFormatted}),e.jsx(m,{variant:"caption",children:"MXN"})]})]})})})},ze=()=>{const[t,s]=f.useState(new Date);S(n=>n.terminal),S(n=>n.addTerminalInfo);const a=[],o=[{name:"description",label:"Descripcion",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const r=a[n],i=(r==null?void 0:r.type)==="ingreso";return e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(j,{sx:{position:"relative"},children:[e.jsx(M,{sx:{width:48,height:48,color:"text.secondary",bgcolor:"background.neutral"},children:e.jsx(ce,{width:24,height:24})}),e.jsx(j,{sx:{right:0,bottom:0,width:20,height:20,display:"flex",borderRadius:"50%",position:"absolute",alignItems:"center",color:"common.white",bgcolor:"error.main",justifyContent:"center",...i&&{bgcolor:"success.main"}},children:i?e.jsx(le,{sx:{width:15,height:15}}):e.jsx(de,{sx:{width:15,height:15}})})]}),e.jsxs(j,{sx:{ml:2},children:[e.jsx(m,{variant:"body2",sx:{color:"text.secondary"},children:i?"Recibe dinero de: ":"Retiro de dinero en:"}),e.jsxs(m,{variant:"subtitle2",children:[" ",r==null?void 0:r.description]}),(r==null?void 0:r.concept)!==""&&e.jsxs(m,{variant:"overline",color:"text.disabled",fontStyle:"italic",children:["concepto : ",r==null?void 0:r.concept]})]})]})}}},{name:"date",label:"Fecha",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const r=a[n];return e.jsxs(d,{children:[e.jsx(m,{variant:"subtitle2",children:r==null?void 0:r.date}),e.jsx(m,{variant:"body2",sx:{color:"text.secondary"},children:r==null?void 0:r.time})]})}}},{name:"amount",label:"Cantidad",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const r=a[n],i=(r==null?void 0:r.type)==="ingreso";return e.jsx(m,{variant:"subtitle2",fontWeight:"bold",color:i?"success.main":"error",children:i?`+ ${r==null?void 0:r.amount}`:`- ${r==null?void 0:r.amount}`})}}}];return e.jsxs(xe,{children:[e.jsx(ie,{currentMonth:t,setCurrentMonth:s,isLoading:!1}),e.jsx(_,{sx:{borderStyle:"dashed"}}),e.jsx(pe,{title:"Movimientos",data:a||[],columns:o,options:{responsive:"simple",rowHover:!0,selectableRows:"single",selectableRowsOnClick:!1,selectToolbarPlacement:"replace",sortOrder:{name:"date",direction:"desc"},downloadOptions:{filename:"movimientos.csv",filterOptions:{useDisplayedColumnsOnly:!1}}}})]})},Fe=()=>{const t=S(s=>s.terminal);return V(),e.jsxs(d,{sx:s=>({pl:{xs:0,lg:2},overflow:"hidden",flexDirection:"column",flexGrow:1}),children:[t&&e.jsxs(e.Fragment,{children:[e.jsx(De,{}),e.jsx(Re,{}),e.jsx(L,{children:e.jsx(d,{pt:0,pb:4,px:2,children:e.jsx(ze,{})})})]}),!t&&e.jsxs(d,{spacing:3,sx:{height:"100%",width:"100%"},children:[e.jsx($,{variant:"filled",severity:"info",children:"Debe seleccionar una terminal para ver sus detalles!"}),e.jsx(d,{alignItems:"center",children:e.jsx(ue,{sx:{width:"30%"}})})]})]})},He=Q(U)(({theme:t})=>({borderRadius:"8px!important",width:1,justifyContent:"center",display:"flex",alignItems:"center",mb:1})),R=({terminal:t})=>{const s=h(i=>i.isOpenList),a=h(i=>i.setOpenList),o=S(i=>i.setTerminal),n=S(i=>i.terminal);(t==null?void 0:t.id)===(n==null?void 0:n.id)&&n&&(n==null||n.cardON);const c=(t==null?void 0:t.id)===(n==null?void 0:n.id),r=i=>{var g;!((g=i.target)==null?void 0:g.type)&&!c&&(o(t),a(!1))};return e.jsx(q,{title:t==null?void 0:t.name,arrow:!0,placement:"right",children:e.jsx(fe,{sx:{mb:1,padding:0,borderRadius:1,"& :hover":{color:"text.primary"}},disablePadding:!0,children:e.jsxs(He,{onClick:r,sx:{...c&&{bgcolor:"secondary.light",color:"black","& :hover":{color:"text.primary"}},"& :hover":{color:"text.primary"},width:1,py:1,gap:1},children:[e.jsx(ge,{sx:{ml:2,m:0},children:e.jsx(j,{sx:{position:"relative"},children:e.jsx(M,{sx:i=>({width:32,height:32,m:0,color:i.palette.primary.contrastText,backgroundColor:i.palette.primary.main}),children:e.jsx(we,{sx:{width:20,height:20},color:"white"})})})}),s&&e.jsx(e.Fragment,{children:e.jsx(d,{sx:{width:1},children:e.jsx(m,{noWrap:!0,variant:"subtitle2",children:t==null?void 0:t.name})})})]})})})};R.propTypes={terminal:u.shape({alias:u.any,id:u.any})};const D=({terminalsQuery:t,sx:s,...a})=>{const{isLoading:o,data:n,error:c,isError:r,refetch:i}=t,y=h(l=>l.isOpenList),g=h(l=>l.terminals);return r&&y&&!n&&!o?e.jsx(G,{errorMessage:c,handleButton:i}):n&&y&&(n==null?void 0:n.length)===0&&!o?e.jsx(be,{pt:2.5,message:"No hay terminales activas para este comercio"}):e.jsx(K,{disablePadding:!0,sx:s,...a,children:(o?[...Array(12)]:g).map((l,p)=>l!=null&&l.id?e.jsx(R,{terminal:l},l==null?void 0:l.id):e.jsx(me,{isOpenSideBar:y},p))})};D.propTypes={sx:u.any,terminalsQuery:u.shape({data:u.array,error:u.any,isError:u.any,isLoading:u.any,refetch:u.any})};const z=({commerceTerminals:t=[]})=>{const s=h(x=>x.isOpenList),a=h(x=>x.setOpenList),o=h(x=>x.setTerminals),n=h(x=>x.terminals),c=h(x=>x.isCollapse),[r,i]=f.useState(""),[y,g]=f.useState(!1),l=async x=>{try{const{value:v}=x.target;if(i(v),v){const H=(t==null?void 0:t.filter(b=>{var w;return(b==null?void 0:b.alias)&&((w=b==null?void 0:b.alias)==null?void 0:w.toLowerCase().indexOf(v.toLowerCase()))!==-1}))||[];o(H)}else o(t)}catch(v){console.error(v)}},p=()=>{s&&(i(""),o(t)),a(!s)},I=()=>{g(!0)},F=()=>{g(!1)};return f.useEffect(()=>{t&&o(t)},[t]),f.useEffect(()=>{if(!s)return g(!1)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{p:2,px:0},children:e.jsxs(d,{direction:"row",justifyContent:s?"flex-end":"center",alignItems:"center",spacing:2,children:[!c&&e.jsx(he,{onClickAway:F,children:e.jsx(Ce,{fullWidth:!0,size:"small",value:r,onFocus:I,onChange:l,placeholder:"Buscar Terminales...",InputProps:{startAdornment:e.jsx(Te,{position:"start",children:e.jsx(Le,{sx:{color:"text.disabled",width:20,height:20}})})}})}),e.jsx(d,{direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(ye,{size:"small",sx:{...!s&&{transform:"rotate(180deg)"}},onClick:p,children:X})})]})}),(n==null?void 0:n.length)===0&&(t==null?void 0:t.length)>0&&e.jsx(Y,{sx:{p:1,display:"flex",flexDirection:"column",alignItems:"center"},searchQuery:r})]})};z.propTypes={commerceTerminals:u.array};const Be={LIST:"commerce-terminals"},Ne=t=>(t==null?void 0:t.map(s=>{var a,o,n,c;return{id:s==null?void 0:s.id,commerceId:s==null?void 0:s.commerceId,terminalId:s==null?void 0:s.terminalId,terminalON:((a=s==null?void 0:s.apiData)==null?void 0:a.status)===1,country:(o=s==null?void 0:s.apiData)==null?void 0:o.country,date:{created:(n=s==null?void 0:s.apiData)==null?void 0:n.created_at,updated:(c=s==null?void 0:s.apiData)==null?void 0:c.updated_at,register:s==null?void 0:s.registerDate},name:s==null?void 0:s.name,active:(s==null?void 0:s.active)==="1",balanceFormatted:je("0")}}))||[],We=async()=>{const{data:t}=await k.get("/api/commerces/terminals");return Ne(t)},os=async t=>{const{data:s}=await k.post("/api/commerce/pay/new",t);return s},Ve=(t={})=>{const[s,a]=f.useState(null);return{...Z([Be.LIST],We,{staleTime:6e4,refetchOnMount:"always",onError:n=>{const c=J(n,"No se puede obtener la lista de terminales del comercio. Intente nuevamente o reporte a sistemas");a(c)},...t}),error:s||null}},$e=()=>{const t=S(p=>{var I;return(I=p.terminal)==null?void 0:I.id}),s=h(p=>p.setOpenList),a=h(p=>p.setCollapse),o=h(p=>p.isOpenList),n=Ve(),c=ee(),r=se("up","md"),i=r&&!o,y=()=>{s(!1)},g=()=>{s(!o)};f.useEffect(()=>{if(!r)return y()},[r,t]),f.useEffect(()=>{a(i)},[i]);const l=e.jsx(L,{sx:{height:.98},children:e.jsxs(d,{px:o?1:0,children:[e.jsx(z,{commerceTerminals:(n==null?void 0:n.data)||[]}),e.jsx(D,{terminalsQuery:n})]})});return e.jsxs(e.Fragment,{children:[!r&&!o&&e.jsx(Se,{onClick:g,children:e.jsx(Oe,{sx:{width:16,height:16}})}),r?e.jsx(O,{open:o,variant:"persistent",PaperProps:{sx:{height:1,borderRightStyle:"none",bgcolor:"background.default"}},sx:{height:1,width:C,transition:c.transitions.create("width"),"& .MuiDrawer-paper":{position:"static",backgroundColor:"transparent!important",width:C},...i&&{width:P,"& .MuiDrawer-paper":{width:P,backgroundColor:"transparent!important",position:"static",transform:"none !important",visibility:"visible !important"}}},children:l}):e.jsx(O,{ModalProps:{keepMounted:!0},open:o,onClose:y,sx:{height:1,"& .MuiDrawer-paper":{width:C,p:2}},children:l})]})},Qe=()=>e.jsx(te,{title:"Lista de Terminales Punto de Venta",children:e.jsx(ve,{children:e.jsxs(j,{display:"flex",overflow:"hidden",sx:{height:"100vH",maxHeight:"100%",flexDirection:"column"},children:[e.jsx(j,{px:1,children:e.jsx(Ie,{name:"Terminales Punto de Venta",links:[{name:"Inicio",href:ne.root},{name:"Administracion",href:re.cards},{name:oe.terminals.name}]})}),e.jsxs(j,{display:"flex",overflow:"hidden",sx:{flex:"1 1 0%"},children:[e.jsx(j,{display:"block",width:1,position:"absolute"}),e.jsx($e,{}),e.jsx(Fe,{})]})]})})}),as=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));export{Ee as L,as as P,os as c,S as u};
