import{W as I,_ as b,p as q,e as P,q as Q,g as X,j as u,i as Y,l as G,o as se,n as ce,U as j,T as V,t as J,V as le,X as de,Q as Z,O as U,E as $,C as ue,w as N,F as z}from"./index-21571737.js";import{T as pe}from"./TextField-7ca732a0.js";import{g as ee,p as ge,S as fe,C as he,P as me}from"./CommerceRegister-43a2c944.js";import{u as ve,a as be,b as xe}from"./useSendValidationCode-a2dc56fb.js";import{u as Ce,v as ye,g as Re}from"./CommerceRepository-8e325193.js";import{C as ke}from"./commerceKeys-5c6f325c.js";import{g as Te}from"./dividerClasses-0b1fbde2.js";import"./useId-a16d032f.js";const De=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],Fe=e=>{const{absolute:t,children:r,classes:o,flexItem:d,light:a,orientation:p,textAlign:i,variant:l}=e;return G({root:["root",t&&"absolute",l,a&&"light",p==="vertical"&&"vertical",d&&"flexItem",r&&"withChildren",r&&p==="vertical"&&"withChildrenVertical",i==="right"&&p!=="vertical"&&"textAlignRight",i==="left"&&p!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",p==="vertical"&&"wrapperVertical"]},Te,o)},Ae=I("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,r.orientation==="vertical"&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&r.orientation==="vertical"&&t.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&t.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&t.textAlignLeft]}})(({theme:e,ownerState:t})=>b({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:q(e.palette.divider,.08)},t.variant==="inset"&&{marginLeft:72},t.variant==="middle"&&t.orientation==="horizontal"&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},t.variant==="middle"&&t.orientation==="vertical"&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},t.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"}),({theme:e,ownerState:t})=>b({},t.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}}),({theme:e,ownerState:t})=>b({},t.children&&t.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${(e.vars||e).palette.divider}`,transform:"translateX(0%)"}}),({ownerState:e})=>b({},e.textAlign==="right"&&e.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},e.textAlign==="left"&&e.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),Ee=I("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.wrapper,r.orientation==="vertical"&&t.wrapperVertical]}})(({theme:e,ownerState:t})=>b({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},t.orientation==="vertical"&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})),we=P.forwardRef(function(t,r){const o=Q({props:t,name:"MuiDivider"}),{absolute:d=!1,children:a,className:p,component:i=a?"div":"hr",flexItem:l=!1,light:x=!1,orientation:F="horizontal",role:m=i!=="hr"?"separator":void 0,textAlign:v="center",variant:C="fullWidth"}=o,T=X(o,De),g=b({},o,{absolute:d,component:i,flexItem:l,light:x,orientation:F,role:m,textAlign:v,variant:C}),h=Fe(g);return u(Ae,b({as:i,className:Y(h.root,p),role:m,ref:r,ownerState:g},T,{children:a?u(Ee,{className:h.wrapper,ownerState:g,children:a}):null}))}),Se=we;function Ve(e){return ce("MuiLink",e)}const Pe=se("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),Me=Pe,te={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},$e=e=>te[e]||e,Ie=({theme:e,ownerState:t})=>{const r=$e(t.color),o=j(e,`palette.${r}`,!1)||t.color,d=j(e,`palette.${r}Channel`);return"vars"in e&&d?`rgba(${d} / 0.4)`:q(o,.4)},Le=Ie,Ne=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Be=e=>{const{classes:t,component:r,focusVisible:o,underline:d}=e,a={root:["root",`underline${J(d)}`,r==="button"&&"button",o&&"focusVisible"]};return G(a,Ve,t)},_e=I(V,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`underline${J(r.underline)}`],r.component==="button"&&t.button]}})(({theme:e,ownerState:t})=>b({},t.underline==="none"&&{textDecoration:"none"},t.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},t.underline==="always"&&b({textDecoration:"underline"},t.color!=="inherit"&&{textDecorationColor:Le({theme:e,ownerState:t})},{"&:hover":{textDecorationColor:"inherit"}}),t.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Me.focusVisible}`]:{outline:"auto"}})),Oe=P.forwardRef(function(t,r){const o=Q({props:t,name:"MuiLink"}),{className:d,color:a="primary",component:p="a",onBlur:i,onFocus:l,TypographyClasses:x,underline:F="always",variant:m="inherit",sx:v}=o,C=X(o,Ne),{isFocusVisibleRef:T,onBlur:g,onFocus:h,ref:y}=le(),[A,w]=P.useState(!1),D=de(r,y),R=f=>{g(f),T.current===!1&&w(!1),i&&i(f)},E=f=>{h(f),T.current===!0&&w(!0),l&&l(f)},S=b({},o,{color:a,component:p,focusVisible:A,underline:F,variant:m}),M=Be(S);return u(_e,b({color:a,className:Y(M.root,d),classes:x,component:p,onBlur:R,onFocus:E,ref:D,ownerState:S,variant:m,sx:[...Object.keys(te).includes(a)?[]:[{color:a}],...Array.isArray(v)?v:[v]]},C))}),We=Oe;function je(e){const t=typeof e=="number",r=Ue(e);return(t||r&&e!=="")&&!isNaN(Number(e))}function Ue(e){return typeof e=="string"||e instanceof String}const ze=(e={})=>{const{enqueueSnackbar:t}=Z();return Ce({mutationFn:ye,onError:r=>{const o=ee(r,"No se puede validar el cÃ³digo");t(o,{variant:(r==null?void 0:r.status)===500?"error":"warning",autoHideDuration:5e3})},...e})},He=(e,t={})=>{const{enqueueSnackbar:r}=Z();return ve([ke.COMMERCE_PROCESS],()=>Re(e),{staleTime:60*5e3,onError:o=>{const d=ee(o,"ðŸ˜Ÿ Error al obtener el proceso del comercio");r(d,{variant:"error",autoHideDuration:5e3})},...t})},Ke=I(pe)`
  input {
    text-align: center;
  }
`,qe={TextFieldStyled:Ke},Qe=e=>u(qe.TextFieldStyled,{...e}),B={left:"ArrowLeft",right:"ArrowRight",backspace:"Backspace"};function Xe(e,t){return e<=0?[]:Array.from({length:e},t)}function Ye(e,t,r){return e.map((o,d)=>t===d?r:o)}function H(e){return e.join("")}function K(e,t){return[...e,t]}function Ge(e,t,r){return e.reduce((o,d,a)=>{const{characters:p,restArrayMerged:i}=o;if(a<r)return{restArrayMerged:i,characters:K(p,d)};const[l,...x]=i;return{restArrayMerged:x,characters:K(p,l||"")}},{restArrayMerged:t,characters:[]}).characters}function Je(e){return e.split("")}const re=U.forwardRef((e,t)=>{const{value:r,length:o,autoFocus:d,onChange:a,TextFieldsProps:p,onComplete:i,validateChar:l,className:x,...F}=e,{onPaste:m,onFocus:v,onKeyDown:C,className:T,...g}=p||{},h=Xe(o,(n,c)=>({character:r[c]||"",inputRef:U.createRef()})),y=n=>h.findIndex(({inputRef:c})=>c.current===n),A=()=>h.map(({character:n})=>n),w=(n,c)=>{const s=Ye(A(),n,c);return H(s)},D=n=>{var c,s;(s=(c=h[n])==null?void 0:c.inputRef.current)==null||s.focus()},R=n=>{var c,s;(s=(c=h[n])==null?void 0:c.inputRef.current)==null||s.select()},E=n=>{n+1!==o&&(h[n+1].character?R(n+1):D(n+1))},S=n=>{n>0&&R(n-1)},M=n=>{const c=n.target.value[0]||"",s=y(n.target);if(typeof l=="function"&&!l(c,s))return;const k=w(s,c);a==null||a(k),k.length===o&&(i==null||i(k)),c!==""?k.length<o?E(k.length-1):E(s):k[s]?R(s):S(s)},f=n=>{n.preventDefault(),n.target.select(),v==null||v(n)},_=n=>{const c=n.target,s=y(c);c.value===n.key?(n.preventDefault(),E(s)):!c.value&&B.backspace===n.key||B.left===n.key?(n.preventDefault(),R(s-1)):B.right===n.key&&(n.preventDefault(),R(s+1)),C==null||C(n)},ne=n=>{n.preventDefault();const c=n.target,s=n.clipboardData.getData("text/plain"),k=y(c),oe=A(),O=Ge(oe,Je(s),k),W=O.findIndex((ie,ae)=>ae>k&&ie===""),L=H(O);if(a==null||a(L),L.length===o){i==null||i(L),D(o-1);return}W!==-1&&D(W),m==null||m(n)};return u($,{display:"flex",gap:"20px",alignItems:"center",ref:t,className:`MuiOtpInput-Box ${x||""}`,...F,children:h.map(({character:n,inputRef:c},s)=>u(Qe,{autoFocus:d?s===0:!1,autoComplete:"one-time-code",value:n,inputRef:c,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${s+1} ${T||""}`,onPaste:ne,onFocus:f,onChange:M,onKeyDown:_,...g},s))})});re.defaultProps={value:"",length:4,autoFocus:!1,validateChar:()=>!0,onChange:()=>{},onComplete:()=>{},TextFieldsProps:{}};const Ze="/react/assets/img/mail-a33a291d.svg";et.propTypes={store:ue.shape(ge)};function et({store:e}){const{lastProcess:t,setActualProcess:r,setLastProcess:o,setToken:d,token:a,setResume:p,resume:i}=e,{info:l}=t,{mutate:x,isLoading:F}=be(),{mutate:m,isLoading:v,isError:C,reset:T}=ze(),{data:g,isError:h}=xe(l==null?void 0:l.email,{enabled:!!(l!=null&&l.email)}),{data:y,isSuccess:A}=He(a,{enabled:!!a});P.useEffect(()=>{g&&d(g==null?void 0:g.token)},[g]),P.useEffect(()=>{p(y&&A?y:null)},[y,A]);const[w,D]=P.useState(""),R=f=>{D(f),T()},E=(f,_)=>je(f),S=f=>{m({verificationCode:f,token:a},{onSuccess:()=>{i!=null&&i.step?r(i==null?void 0:i.step):r(me.SERVICES_SELECTION),o()},onError:()=>{D("")}})},M=()=>{x({token:g==null?void 0:g.token})};return N(z,{children:[u($,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",my:4},children:u("img",{className:"animate__animated animate__pulse",src:Ze,width:"25%",alt:"Sent Mail"})}),u(V,{variant:"h4",color:"textPrimary",align:"center",children:"VerificaciÃ³n de Cuenta"}),N(V,{paragraph:!0,sx:{mb:4,mt:2},align:"center",variant:"body2",color:"text.secondary",whiteSpace:"pre-line",children:["Enviamos un correo electrÃ³nico a ",l==null?void 0:l.email," con el cÃ³digo de verificacion de tu cuenta, ingrese el cÃ³digo en el cuadro a continuaciÃ³n para verificar su cuenta."]}),u(re,{length:6,value:w,onComplete:S,onChange:R,validateChar:E,sx:{gap:{xs:1.5,sm:2,md:3}},TextFieldsProps:{placeholder:"-",error:C,disabled:v}}),!!C&&u($,{mt:1,children:u(V,{variant:"caption",color:"error",children:"CÃ³digo incorrecto"})}),u($,{mb:5,children:u(Se,{sx:{my:4},children:u(fe,{direction:"row",spacing:1,justifyContent:"center",children:F?u(he,{wid:!0,sx:{mx:3}}):N(z,{children:[u(V,{variant:"body2",children:"Â¿No tengo un cÃ³digo?"}),u(We,{underline:"hover",sx:{cursor:"pointer"},onClick:M,children:u(V,{variant:"body2",color:"primary",children:"Reenviar cÃ³digo"})})]})})})})]})}export{et as default};
