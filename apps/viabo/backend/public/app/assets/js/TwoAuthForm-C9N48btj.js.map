{"version":3,"file":"TwoAuthForm-C9N48btj.js","sources":["../../../../../frontend/src/app/authentication/components/TwoAuthForm.jsx"],"sourcesContent":["import { useState } from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport { CheckCircle, HdrStrongTwoTone } from '@mui/icons-material'\nimport {\n  Button,\n  CircularProgress,\n  Link,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Stack,\n  Typography\n} from '@mui/material'\nimport { format } from 'date-fns'\nimport { es } from 'date-fns/locale'\nimport { MuiOtpInput } from 'mui-one-time-password-input'\n\nimport { Image } from '@/shared/components/images'\nimport { Scrollbar } from '@/shared/components/scroll'\nimport { matchIsNumeric, setSession } from '@/shared/utils'\n\nconst TwoAuthForm = ({ onFinish, mutateTwoAuth, googleCode }) => {\n  const { mutate, isLoading, isSuccess } = mutateTwoAuth\n\n  const [otp, setOtp] = useState('')\n\n  const handleChange = newValue => {\n    setOtp(newValue)\n  }\n\n  const validateChar = value => matchIsNumeric(value)\n\n  const handleComplete = value => {\n    setOtp('')\n    mutate(\n      { code: value, secret: googleCode?.key },\n      {\n        onSuccess: data => {\n          if (data?.token) {\n            setSession(data?.token)\n          }\n        },\n        onError: () => {\n          setOtp('')\n        }\n      }\n    )\n  }\n\n  return (\n    <Scrollbar containerProps={{ sx: { flexGrow: 0, height: 'auto' } }}>\n      <Stack gap={2} p={3} pb={6}>\n        {isSuccess && <SuccessTwoAuth onFinish={onFinish} />}\n        {!isSuccess && (\n          <>\n            <Stack>\n              <List dense={false}>\n                <ListItem sx={{ px: 0 }}>\n                  <ListItemIcon>\n                    <HdrStrongTwoTone />\n                  </ListItemIcon>\n                  <ListItemText\n                    primary={\n                      <Typography variant=\"body2\" fontWeight={600} sx={{ color: 'text.secondary', textWrap: 'wrap' }}>\n                        Descarga la aplicación Google Authenticator en tu teléfono &nbsp;\n                        <Link\n                          color=\"primary\"\n                          rel=\"noreferrer\"\n                          target=\"_blank\"\n                          href={\n                            'https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&pcampaignid=web_share'\n                          }\n                          sx={{ cursor: 'pointer' }}\n                        >\n                          Android\n                        </Link>\n                        &nbsp; ó &nbsp;\n                        <Link\n                          color=\"primary\"\n                          rel=\"noreferrer\"\n                          target=\"_blank\"\n                          href={'https://apps.apple.com/es/app/google-authenticator/id388497605'}\n                          sx={{ cursor: 'pointer' }}\n                        >\n                          IOS\n                        </Link>\n                      </Typography>\n                    }\n                  />\n                </ListItem>\n                <ListItem sx={{ px: 0 }}>\n                  <ListItemIcon>\n                    <HdrStrongTwoTone />\n                  </ListItemIcon>\n                  <ListItemText\n                    primary={\n                      <Typography variant=\"body2\" fontWeight={600} sx={{ color: 'text.secondary', textWrap: 'wrap' }}>\n                        En la Aplicación configura tu cuenta\n                      </Typography>\n                    }\n                  />\n                </ListItem>\n                <ListItem sx={{ px: 0 }}>\n                  <ListItemIcon>\n                    <HdrStrongTwoTone />\n                  </ListItemIcon>\n                  <ListItemText\n                    primary={\n                      <Typography variant=\"body2\" fontWeight={600} sx={{ color: 'text.secondary', textWrap: 'wrap' }}>\n                        Elige la opción de escanear un código QR\n                      </Typography>\n                    }\n                  />\n                </ListItem>\n\n                <ListItem sx={{ px: 0 }}>\n                  <ListItemIcon>\n                    <HdrStrongTwoTone />\n                  </ListItemIcon>\n                  <ListItemText\n                    primary={\n                      <Typography variant=\"body2\" fontWeight={600} sx={{ color: 'text.secondary', textWrap: 'wrap' }}>\n                        Escanea el siguiente QR e ingresa el código\n                      </Typography>\n                    }\n                  />\n                </ListItem>\n              </List>\n            </Stack>\n            {isLoading ? (\n              <Stack spacing={1} justifyContent={'center'} alignItems={'center'}>\n                <CircularProgress />\n                <Typography variant=\"body2\" fontWeight={600} sx={{ color: 'text.primary', textWrap: 'wrap' }}>\n                  Configurando dispositivo...\n                </Typography>\n                <Typography variant=\"body2\" sx={{ color: 'text.disabled', textWrap: 'wrap' }}>\n                  No cierres la ventana hasta que se complete la configuración\n                </Typography>\n              </Stack>\n            ) : (\n              <>\n                <Stack justifyContent={'center'} alignItems={'center'}>\n                  <Image src={googleCode?.qr} sx={{ width: 150, m: 0, p: 0 }} />\n                </Stack>\n                <MuiOtpInput\n                  length={6}\n                  value={otp}\n                  onComplete={handleComplete}\n                  onChange={handleChange}\n                  validateChar={validateChar}\n                  sx={{ gap: { xs: 1.5, sm: 2, md: 3 } }}\n                  TextFieldsProps={{ placeholder: '0' }}\n                />\n              </>\n            )}\n          </>\n        )}\n      </Stack>\n    </Scrollbar>\n  )\n}\n\nTwoAuthForm.propTypes = {\n  googleCode: PropTypes.shape({\n    key: PropTypes.any,\n    qr: PropTypes.any\n  }),\n  mutateTwoAuth: PropTypes.shape({\n    isLoading: PropTypes.any,\n    isSuccess: PropTypes.any,\n    mutate: PropTypes.func\n  }),\n  onFinish: PropTypes.any\n}\n\nexport default TwoAuthForm\n\nfunction SuccessTwoAuth({ onFinish }) {\n  return (\n    <Stack flexDirection=\"column\" alignItems={'center'} spacing={2} mt={3}>\n      <CheckCircle sx={{ width: 50, height: 50 }} color={'success'} />\n      <Stack alignItems={'center'} spacing={1}>\n        <Typography variant=\"h6\">{`Configuración Exitosa`}</Typography>\n        <Typography variant=\"caption\" color={'text.disabled'}>\n          {format(new Date(), 'dd MMM yyyy hh:mm a', { locale: es })}\n        </Typography>\n      </Stack>\n      <Stack sx={{ px: 9, pt: 3 }}>\n        <Button type=\"button\" size=\"large\" variant=\"contained\" sx={{ fontWeight: 'bold' }} onClick={onFinish}>\n          Finalizar\n        </Button>\n      </Stack>\n    </Stack>\n  )\n}\n\nSuccessTwoAuth.propTypes = {\n  onFinish: PropTypes.any\n}\n"],"names":["TwoAuthForm","onFinish","mutateTwoAuth","googleCode","mutate","isLoading","isSuccess","otp","setOtp","useState","handleChange","newValue","validateChar","matchIsNumeric","value","handleComplete","code","secret","key","onSuccess","data","token","setSession","onError","jsx","Scrollbar","sx","flexGrow","height","Stack","SuccessTwoAuth","jsxs","Fragment","List","ListItem","px","ListItemIcon","HdrStrongTwoTone","ListItemText","Typography","color","textWrap","Link","cursor","CircularProgress","Image","qr","width","m","p","MuiOtpInput","gap","xs","sm","md","placeholder","propTypes","PropTypes","shape","any","func","CheckCircle","format","Date","locale","es","pt","Button","fontWeight"],"mappings":"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"}