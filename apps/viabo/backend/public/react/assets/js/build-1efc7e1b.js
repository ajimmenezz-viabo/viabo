import{t as T,j as e,av as A,r as p,_ as M,B as j,a7 as L,S as x,a4 as R,L as O,c as k,ad as z,T as S,a8 as W,Z as $,a9 as U,P as l,ab as Q,a6 as q,af as G,ai as K,aj as Y,a as E,b as Z,g as J,aM as X,l as ee,ak as _,f as se,al as te,am as ne,an as oe}from"./build-66521f42.js";import{A as re}from"./build-98dd2718.js";import{a as ae,A as ie,S as ce,N as de,C as le}from"./build-87558fae.js";import{D as he}from"./build-765dfa32.js";import{C as pe}from"./build-72bf0ad7.js";import{S as xe}from"./build-142b2c6d.js";import{L as ue,f as fe}from"./build-c4917e3a.js";import{L as je,S as ge,a as ye,b as Se,c as C,d as P}from"./build-651eceb1.js";import{E as me,C as be,H as ve}from"./build-0161e1e2.js";import"./build-1da746e9.js";import{I as Ie}from"./build-6460db89.js";import{I as Ce}from"./build-337ca852.js";import{S as Te}from"./build-6c4e1a9a.js";const D=T(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM8.46 14.45l-1.36-.62c.28-.61.41-1.24.4-1.86-.01-.63-.14-1.24-.4-1.8l1.36-.63c.35.75.53 1.56.54 2.4.01.86-.17 1.7-.54 2.51zm3.07 1.56-1.3-.74c.52-.92.78-1.98.78-3.15 0-1.19-.27-2.33-.8-3.4l1.34-.67c.64 1.28.96 2.65.96 4.07 0 1.43-.33 2.74-.98 3.89zm3.14 1.32-1.35-.66c.78-1.6 1.18-3.18 1.18-4.69 0-1.51-.4-3.07-1.18-4.64l1.34-.67c.9 1.78 1.34 3.56 1.34 5.31 0 1.74-.44 3.54-1.33 5.35z"}),"ContactlessSharp"),Le=T(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}),"Link"),Ee=T(e.jsx("path",{d:"M17 2H7c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 4H7V4h10v2zm3 16H4c-1.1 0-2-.9-2-2v-1h20v1c0 1.1-.9 2-2 2zm-1.47-11.81C18.21 9.47 17.49 9 16.7 9H7.3c-.79 0-1.51.47-1.83 1.19L2 18h20l-3.47-7.81zM9.5 16h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5z"}),"PointOfSale"),we=A(p.lazy(()=>M(()=>import("./build-6a8ff930.js"),["assets/js/build-6a8ff930.js","assets/js/build-66521f42.js","assets/css/build-f63bc8fe.css","assets/js/build-67e2d0d2.js","assets/js/build-1da746e9.js","assets/js/build-84629e21.js","assets/js/build-7e86f35e.js","assets/js/build-337ca852.js","assets/js/build-47ea8464.js","assets/js/build-300c7970.js","assets/js/build-7828142a.js","assets/js/build-6460db89.js","assets/js/build-c4917e3a.js","assets/js/build-bee6630b.js","assets/js/build-76229e8f.js","assets/js/build-9f4a53d7.js","assets/js/build-9329eefd.js","assets/js/build-72bf0ad7.js","assets/js/build-0161e1e2.js","assets/js/build-ba5534ae.js","assets/js/build-98dd2718.js","assets/js/build-87558fae.js","assets/js/build-765dfa32.js","assets/js/build-56d4435a.js","assets/js/build-e23acde9.js","assets/js/build-6e1d55ad.js","assets/js/build-142b2c6d.js","assets/js/build-651eceb1.js","assets/js/build-6c4e1a9a.js"]))),Oe=A(p.lazy(()=>M(()=>import("./build-5f933882.js"),["assets/js/build-5f933882.js","assets/js/build-66521f42.js","assets/css/build-f63bc8fe.css","assets/js/build-1da746e9.js","assets/js/build-84629e21.js","assets/js/build-7e86f35e.js","assets/js/build-337ca852.js","assets/js/build-47ea8464.js","assets/js/build-300c7970.js","assets/js/build-7828142a.js","assets/js/build-6460db89.js","assets/js/build-c4917e3a.js","assets/js/build-bee6630b.js","assets/js/build-fe187947.js","assets/js/build-ad134dca.js","assets/js/build-a6d123aa.js","assets/js/build-c2476d0d.js","assets/js/build-76229e8f.js","assets/js/build-9f4a53d7.js","assets/js/build-251e00de.js","assets/js/build-e23acde9.js","assets/js/build-6e1d55ad.js","assets/js/build-9329eefd.js","assets/js/build-72bf0ad7.js","assets/js/build-0161e1e2.js","assets/js/build-ba5534ae.js","assets/js/build-98dd2718.js","assets/js/build-87558fae.js","assets/js/build-765dfa32.js","assets/js/build-56d4435a.js","assets/js/build-142b2c6d.js","assets/js/build-651eceb1.js","assets/js/build-6c4e1a9a.js"]))),_e=()=>{const[t,s]=p.useState(!1),[a,r]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{mb:2},children:e.jsx(L,{children:e.jsxs(x,{direction:"row",divider:e.jsx(R,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:3},spacing:1,children:[e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(O,{startIcon:e.jsx(Le,{}),variant:"contained",color:"info",onClick:()=>s(!0),children:"Liga de Pago"})}),e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(O,{startIcon:e.jsx(re,{}),color:"info",variant:"contained",onClick:()=>r(!0),children:"Terminal Virtual"})})]})})}),t&&e.jsx(we,{open:t,setOpen:s}),a&&e.jsx(Oe,{open:a,setOpen:r})]})},Pe={terminal:null},Ae=(t,s)=>({...Pe,setTerminal:a=>{const{terminal:r}=s();t(n=>({terminal:{...r,...a}}),!1,"SET_TERMINAL_SELECTED")},resetTerminal:()=>{t(a=>({pos:null}),!1,"RESET_TERMINAL_SELECTED")},addTerminalInfo:a=>{const{terminal:r}=s();t(n=>({terminal:{...r,...a}}),!1,"SET_TERMINAL_INFO")}}),b=k(Ae),Me={terminals:[],isOpenList:!0,isCollapse:!1},Re=(t,s)=>({...Me,setTerminals:a=>{t(r=>({terminals:a}),!1,"SET_TERMINAL")},setOpenList:a=>{t(r=>({isOpenList:a}),!1,"SET_OPEN_LIST")},setCollapse:a=>{t(r=>({isCollapse:a}),!1,"SET_COLLAPSE")}}),h=k(Re),ke=()=>{const[t,s]=p.useState(new Date);b(n=>n.terminal),b(n=>n.addTerminalInfo);const a=[],r=[{name:"description",label:"Descripcion",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const o=a[n],i=(o==null?void 0:o.type)==="ingreso";return e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(j,{sx:{position:"relative"},children:[e.jsx(z,{sx:{width:48,height:48,color:"text.secondary",bgcolor:"background.neutral"},children:e.jsx(ie,{width:24,height:24})}),e.jsx(j,{sx:{right:0,bottom:0,width:20,height:20,display:"flex",borderRadius:"50%",position:"absolute",alignItems:"center",color:"common.white",bgcolor:"error.main",justifyContent:"center",...i&&{bgcolor:"success.main"}},children:i?e.jsx(ce,{sx:{width:15,height:15}}):e.jsx(de,{sx:{width:15,height:15}})})]}),e.jsxs(j,{sx:{ml:2},children:[e.jsx(S,{variant:"body2",sx:{color:"text.secondary"},children:i?"Recibe dinero de: ":"Retiro de dinero en:"}),e.jsxs(S,{variant:"subtitle2",children:[" ",o==null?void 0:o.description]}),(o==null?void 0:o.concept)!==""&&e.jsxs(S,{variant:"overline",color:"text.disabled",fontStyle:"italic",children:["concepto : ",o==null?void 0:o.concept]})]})]})}}},{name:"date",label:"Fecha",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const o=a[n];return e.jsxs(x,{children:[e.jsx(S,{variant:"subtitle2",children:o==null?void 0:o.date}),e.jsx(S,{variant:"body2",sx:{color:"text.secondary"},children:o==null?void 0:o.time})]})}}},{name:"amount",label:"Cantidad",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(n,c)=>{const o=a[n],i=(o==null?void 0:o.type)==="ingreso";return e.jsx(S,{variant:"subtitle2",fontWeight:"bold",color:i?"success.main":"error",children:i?`+ ${o==null?void 0:o.amount}`:`- ${o==null?void 0:o.amount}`})}}}];return e.jsxs(pe,{children:[e.jsx(ae,{currentMonth:t,setCurrentMonth:s,isLoading:!1}),e.jsx(R,{sx:{borderStyle:"dashed"}}),e.jsx(he,{title:"Movimientos",data:a||[],columns:r,options:{responsive:"simple",rowHover:!0,selectableRows:"single",selectableRowsOnClick:!1,selectToolbarPlacement:"replace",sortOrder:{name:"date",direction:"desc"},downloadOptions:{filename:"movimientos.csv",filterOptions:{useDisplayedColumnsOnly:!1}}}})]})},ze=()=>{const t=b(s=>s.terminal);return e.jsxs(x,{sx:s=>({pl:{xs:0,lg:2},overflow:"hidden",flexDirection:"column",flexGrow:1}),children:[t&&e.jsxs(e.Fragment,{children:[(t==null?void 0:t.isVirtual)&&e.jsx(_e,{}),e.jsx(L,{children:e.jsx(x,{pt:0,pb:4,px:2,children:e.jsx(ke,{})})})]}),!t&&e.jsxs(x,{spacing:3,sx:{height:"100%",width:"100%"},children:[e.jsx(W,{variant:"filled",severity:"info",children:"Debe seleccionar una terminal para ver sus detalles!"}),e.jsx(x,{alignItems:"center",children:e.jsx(xe,{sx:{width:"30%"}})})]})]})},De=$(U)(({theme:t})=>({borderRadius:"8px!important",width:1,justifyContent:"center",display:"flex",alignItems:"center",mb:1})),B=({terminal:t})=>{const s=h(i=>i.isOpenList),a=h(i=>i.setOpenList),r=b(i=>i.setTerminal),n=b(i=>i.terminal);(t==null?void 0:t.id)===(n==null?void 0:n.id)&&n&&(n==null||n.cardON);const c=(t==null?void 0:t.id)===(n==null?void 0:n.id),o=i=>{var g;!((g=i.target)==null?void 0:g.type)&&!c&&(r(t),a(!1))};return e.jsx(Q,{title:t==null?void 0:t.name,arrow:!0,placement:"right",children:e.jsx(ue,{sx:{mb:1,padding:0,borderRadius:1,"& :hover":{color:"text.primary"}},disablePadding:!0,children:e.jsxs(De,{onClick:o,sx:{...c&&{bgcolor:"secondary.light",color:"black","& :hover":{color:"text.primary"}},"& :hover":{color:"text.primary"},width:1,py:1,gap:1},children:[e.jsx(je,{sx:{ml:2,m:0},children:e.jsx(j,{sx:{position:"relative"},children:e.jsx(z,{sx:i=>({width:32,height:32,m:0,backgroundColor:i.palette.primary.main,"& :hover":{color:"white"}}),children:t!=null&&t.isVirtual?e.jsx(D,{sx:{width:20,height:20,color:"white"}}):e.jsx(Ee,{sx:{width:16,height:16,color:"white"}})})})}),s&&e.jsx(e.Fragment,{children:e.jsx(x,{sx:{width:1},children:e.jsx(S,{noWrap:!0,variant:"subtitle2",children:t==null?void 0:t.name})})})]})})})};B.propTypes={terminal:l.shape({alias:l.any,id:l.any,isVirtual:l.any,name:l.any})};const F=({terminalsQuery:t,sx:s,...a})=>{const{isLoading:r,data:n,error:c,isError:o,refetch:i}=t,y=h(d=>d.isOpenList),g=h(d=>d.terminals);return o&&y&&!n&&!r?e.jsx(q,{errorMessage:c,handleButton:i}):n&&y&&(n==null?void 0:n.length)===0&&!r?e.jsx(me,{pt:2.5,message:"No hay terminales activas para este comercio"}):e.jsx(G,{disablePadding:!0,sx:s,...a,children:(r?[...Array(12)]:g).map((d,u)=>d!=null&&d.id?e.jsx(B,{terminal:d},d==null?void 0:d.id):e.jsx(ge,{isOpenSideBar:y},u))})};F.propTypes={sx:l.any,terminalsQuery:l.shape({data:l.array,error:l.any,isError:l.any,isLoading:l.any,refetch:l.any})};const N=({commerceTerminals:t=[]})=>{const s=h(f=>f.isOpenList),a=h(f=>f.setOpenList),r=h(f=>f.setTerminals),n=h(f=>f.terminals),c=h(f=>f.isCollapse),[o,i]=p.useState(""),[y,g]=p.useState(!1),d=async f=>{try{const{value:v}=f.target;if(i(v),v){const V=(t==null?void 0:t.filter(m=>{var w;return(m==null?void 0:m.name)&&((w=m==null?void 0:m.name)==null?void 0:w.toLowerCase().indexOf(v.toLowerCase()))!==-1}))||[];r(V)}else r(t)}catch(v){console.error(v)}},u=()=>{s&&(i(""),r(t)),a(!s)},I=()=>{g(!0)},H=()=>{g(!1)};return p.useEffect(()=>{t&&r(t)},[t]),p.useEffect(()=>{if(!s)return g(!1)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{p:2,px:0},children:e.jsxs(x,{direction:"row",justifyContent:s?"flex-end":"center",alignItems:"center",spacing:2,children:[!c&&e.jsx(le,{onClickAway:H,children:e.jsx(Ie,{fullWidth:!0,size:"small",value:o,onFocus:I,onChange:d,placeholder:"Buscar Terminales...",InputProps:{startAdornment:e.jsx(Ce,{position:"start",children:e.jsx(Te,{sx:{color:"text.disabled",width:20,height:20}})})}})}),e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(ye,{size:"small",sx:{...!s&&{transform:"rotate(180deg)"}},onClick:u,children:K})})]})}),(n==null?void 0:n.length)===0&&(t==null?void 0:t.length)>0&&e.jsx(Y,{sx:{p:1,display:"flex",flexDirection:"column",alignItems:"center"},searchQuery:o})]})};N.propTypes={commerceTerminals:l.array};const Be={LIST:"commerce-terminals"},Fe=t=>(t==null?void 0:t.map(s=>{var a,r,n,c;return{id:s==null?void 0:s.id,commerceId:s==null?void 0:s.commerceId,terminalId:s==null?void 0:s.terminalId,terminalON:((a=s==null?void 0:s.apiData)==null?void 0:a.status)===1,country:(r=s==null?void 0:s.apiData)==null?void 0:r.country,date:{created:(n=s==null?void 0:s.apiData)==null?void 0:n.created_at,updated:(c=s==null?void 0:s.apiData)==null?void 0:c.updated_at,register:s==null?void 0:s.registerDate},isVirtual:(s==null?void 0:s.typeId)==="1",name:(s==null?void 0:s.name)!==""?s==null?void 0:s.name.toString().toUpperCase():`TERMINAL-${s==null?void 0:s.terminalId}`,active:(s==null?void 0:s.active)==="1",balanceFormatted:fe("0")}}))||[],Ne=async()=>{const{data:t}=await E.get("/api/commerces/terminals");return Fe(t)},ns=async t=>{const{data:s}=await E.post("/api/commerce/pay/new",t);return s},os=async t=>{const{data:s}=await E.post("/api/commerce/virtual-terminal/generate/transaction",t);return s},He=(t={})=>{const[s,a]=p.useState(null);return{...Z([Be.LIST],Ne,{staleTime:6e4,refetchOnMount:"always",onError:n=>{const c=J(n,"No se puede obtener la lista de terminales del comercio. Intente nuevamente o reporte a sistemas");a(c)},...t}),error:s||null}},Ve=()=>{const t=b(u=>{var I;return(I=u.terminal)==null?void 0:I.id}),s=h(u=>u.setOpenList),a=h(u=>u.setCollapse),r=h(u=>u.isOpenList),n=He(),c=X(),o=ee("up","md"),i=o&&!r,y=()=>{s(!1)},g=()=>{s(!r)};p.useEffect(()=>{if(!o)return y()},[o,t]),p.useEffect(()=>{a(i)},[i]);const d=e.jsx(L,{sx:{height:.98},children:e.jsxs(x,{px:r?1:0,children:[e.jsx(N,{commerceTerminals:(n==null?void 0:n.data)||[]}),e.jsx(F,{terminalsQuery:n})]})});return e.jsxs(e.Fragment,{children:[!o&&!r&&e.jsx(Se,{onClick:g,children:e.jsx(D,{sx:{width:20,height:20}})}),o?e.jsx(_,{open:r,variant:"persistent",PaperProps:{sx:{height:1,borderRightStyle:"none",bgcolor:"background.default"}},sx:{height:1,width:C,transition:c.transitions.create("width"),"& .MuiDrawer-paper":{position:"static",backgroundColor:"transparent!important",width:C},...i&&{width:P,"& .MuiDrawer-paper":{width:P,backgroundColor:"transparent!important",position:"static",transform:"none !important",visibility:"visible !important"}}},children:d}):e.jsx(_,{ModalProps:{keepMounted:!0},open:r,onClose:y,sx:{height:1,"& .MuiDrawer-paper":{width:C,p:2}},children:d})]})},We=()=>e.jsx(se,{title:"Lista de Terminales Punto de Venta",children:e.jsx(be,{children:e.jsxs(j,{display:"flex",overflow:"hidden",sx:{height:"100vH",maxHeight:"100%",flexDirection:"column"},children:[e.jsx(j,{px:1,children:e.jsx(ve,{name:"Terminales Punto de Venta",links:[{name:"Inicio",href:te.root},{name:"Administracion",href:ne.terminals},{name:oe.terminals.name}]})}),e.jsxs(j,{display:"flex",overflow:"hidden",sx:{flex:"1 1 0%"},children:[e.jsx(j,{display:"block",width:1,position:"absolute"}),e.jsx(Ve,{}),e.jsx(ze,{})]})]})})}),rs=Object.freeze(Object.defineProperty({__proto__:null,default:We},Symbol.toStringTag,{value:"Module"}));export{Le as L,rs as P,ns as c,os as g,b as u};
