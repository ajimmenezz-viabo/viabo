import{c as F,f as T,a9 as C,i as e,S as o,T as S,B as g,b8 as q,dH as O,e0 as W,dZ as f,e1 as R,aY as w,dr as V,dv as B,a0 as Q,P as j}from"./vendor-FSZoD0Ty.js";import{u as k}from"./formik.esm--ft-gNTR.js";import{c as $,a as l,d as I}from"./index.esm-ZMwb309P.js";import{g as U,a as P}from"./index-c1QoFEuN.js";import{M as m,n as H,S as z,a as Y}from"./useFindSpeiCostCenters-414l-Xwc.js";import{i as v}from"./matchTypes-_pBEYOAq.js";import{F as G,R as b}from"./TextMaxLine-cfAOJylX.js";import{R as K}from"./RFSelect-r0md_kbC.js";import"./UploadSingleFile-tjLGAlpU.js";import"./fade-HpdRXKiE.js";import"./transition-Uc7vb3zK.js";import"./formatNumber-IeezKRXK.js";const Z=r=>{var n,s,E,c,u,t;return{name:(n=r==null?void 0:r.name)==null?void 0:n.trim(),isNewUser:(r==null?void 0:r.method)===m.NEW_ADMIN_USER,assignedUsers:((s=r==null?void 0:r.adminUsers)==null?void 0:s.map(d=>d.value))||[],userName:(E=r==null?void 0:r.adminName)==null?void 0:E.trim(),userLastName:(c=r==null?void 0:r.adminLastName)==null?void 0:c.trim(),userEmail:(u=r==null?void 0:r.adminEmail)==null?void 0:u.trim(),userPhone:(t=r==null?void 0:r.adminPhone)==null?void 0:t.trim()}},J=(r={})=>{const n=F(),s=T(H,r);return{...s,mutate:async(c,u)=>{const{onSuccess:t,onError:d,mutationOptions:N}=u;try{await C.promise(s.mutateAsync(c,N),{pending:"Creando centro de costos...",success:{render({data:i}){return n.invalidateQueries([z.COST_CENTERS_LIST]),v(t)&&t(i),"Se creó el centro de costos con éxito"}}})}catch(i){const p=U(i,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");v(d)&&d(p),C.error(p,{type:P(i)})}}}},X=(r={})=>{const n=F(),s=T(Y,r);return{...s,mutate:async(c,u)=>{const{onSuccess:t,onError:d,mutationOptions:N}=u;try{await C.promise(s.mutateAsync(c,N),{pending:"Actualizando centro de costos...",success:{render({data:i}){return n.invalidateQueries([z.COST_CENTERS_LIST]),v(t)&&t(i),"Se actualizó el centro de costos con éxito"}}})}catch(i){const p=U(i,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");v(d)&&d(p),C.error(p,{type:P(i)})}}}},y=({adminUsers:r,onSuccess:n,costCenter:s})=>{const{mutate:E,isLoading:c}=J(),{mutate:u,isLoading:t}=X(),d=$().shape({name:l().trim().required("Es necesario el nombre del centro de costos"),method:l(),adminUsers:I().when("method",{is:m.ADMIN_USERS,then:a=>a.min(1,"Es necesario al menos un usuario administrador asignado al centro de costos"),otherwise:a=>I()}),adminName:l().trim().when("method",{is:m.NEW_ADMIN_USER,then:a=>a.required("Es necesario el nombre del administrador"),otherwise:a=>l().trim()}),adminLastName:l().trim().when("method",{is:m.NEW_ADMIN_USER,then:a=>a.required("Es necesario los apellidos del administrador"),otherwise:a=>l().trim()}),adminEmail:l().trim().email("Ingrese un correo valido").when("method",{is:m.NEW_ADMIN_USER,then:a=>a.required("Es necesario el correo del administrador"),otherwise:a=>l().trim().email("Ingrese un correo valido")}),adminPhone:l().trim()}),N=(r==null?void 0:r.filter(a=>{var x;return(x=s==null?void 0:s.adminUsers)==null?void 0:x.includes(a==null?void 0:a.value)}))||[],i=k({initialValues:{name:(s==null?void 0:s.name)||"",method:m.ADMIN_USERS,adminUsers:N,adminName:"",adminLastName:"",adminEmail:"",adminPhone:""},enableReinitialize:!0,validationSchema:d,onSubmit:(a,{setSubmitting:x,setFieldValue:ee})=>{const _=Z(a);return s?u({..._,id:s==null?void 0:s.id},{onSuccess:()=>{n(),x(!1)},onError:()=>{x(!1)}}):E(_,{onSuccess:()=>{n(),x(!1)},onError:()=>{x(!1)}})}}),{isSubmitting:p,setFieldValue:L,values:A,setTouched:M,resetForm:D}=i,h=p||c||t;return e.jsx(G,{formik:i,children:e.jsxs(o,{spacing:2,children:[e.jsxs(o,{spacing:1,children:[e.jsxs(S,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Nombre",e.jsx(g,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(b,{inputProps:{maxLength:"18"},required:!0,name:"name",size:"small",disabled:h,placeholder:"Nombre del Centro de Costos..."})]}),e.jsx(o,{children:e.jsxs(q,{disabled:h,children:[e.jsx(O,{id:"demo-row-radio-buttons-group-label",children:"Seleccione al administrador del centro de costos:"}),e.jsxs(W,{value:A.method,onChange:a=>{D(),L("method",a.target.value),M({},!1)},row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"row-radio-buttons-group",children:[e.jsx(f,{value:m.ADMIN_USERS,control:e.jsx(R,{}),label:"Administrador de Centro de Costos Existente"}),e.jsx(f,{value:m.NEW_ADMIN_USER,control:e.jsx(R,{}),label:"Nuevo Administrador de Centro de Costos"})]})]})}),A.method===m.ADMIN_USERS?e.jsxs(o,{spacing:1,children:[e.jsxs(S,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Usuarios Administradores",e.jsx(g,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(K,{multiple:!0,name:"adminUsers",textFieldParams:{placeholder:"Seleccionar ...",size:"small"},options:r||[],disabled:h})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{spacing:1,children:[e.jsxs(S,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Nombre (s)",e.jsx(g,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(b,{name:"adminName",size:"small",required:!0,placeholder:"Nombre Administrador del Centro de Costos...",disabled:h})]}),e.jsxs(o,{spacing:1,children:[e.jsxs(S,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Apellido (s)",e.jsx(g,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(b,{name:"adminLastName",size:"small",required:!0,placeholder:"Apellidos del Administrador del Centro de Costos...",disabled:h})]}),e.jsxs(o,{flexDirection:{md:"row"},gap:2,children:[e.jsxs(o,{spacing:1,flex:1,children:[e.jsxs(S,{type:"email",paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Correo",e.jsx(g,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(b,{name:"adminEmail",size:"small",required:!0,placeholder:"admin.company@domino.com...",InputProps:{startAdornment:e.jsx(w,{position:"start",children:e.jsx(V,{})})},disabled:h})]}),e.jsxs(o,{spacing:1,children:[e.jsx(S,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono"}),e.jsx(b,{name:"adminPhone",type:"tel",size:"small",placeholder:"55 5555 5555",InputProps:{startAdornment:e.jsx(w,{position:"start",children:e.jsx(B,{})})},disabled:h})]})]})]}),e.jsx(o,{sx:{pt:1},children:e.jsx(Q,{size:"large",loading:h,variant:"contained",color:"primary",fullWidth:!0,type:"submit",children:s?"Actualizar":"Crear"})})]})})};y.propTypes={adminUsers:j.array,costCenter:j.shape({adminUsers:j.array,id:j.any,name:j.string}),onSuccess:j.func};export{y as default};
//# sourceMappingURL=SpeiNewCostCenterForm-lzv96BDn.js.map
