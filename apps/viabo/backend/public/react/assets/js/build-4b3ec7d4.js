import{n as L,as as v,g as M,o as S,P as C,j as e,a4 as A,S as r,T as i,L as T,r as P,c_ as w,J as N,K as q,I as $,ay as F,H as O,cm as R}from"./build-776e1a78.js";import{d as _,C as B,a as D}from"./build-a6868340.js";import{u as U}from"./build-8b11a6ef.js";import{a as X}from"./build-f3e23f93.js";import{c as z,d as V,a as j}from"./build-942fb4e6.js";import{c as W,L as G}from"./build-0339f617.js";import{R as g}from"./build-40c25b7f.js";import{F as H}from"./build-5608c06d.js";import{I as f}from"./build-7423c2bf.js";import{P as J}from"./build-68566d96.js";import{E as K}from"./build-519179fc.js";import{R as Q}from"./build-f6846af1.js";import{f as Y}from"./build-53a62661.js";import"./build-cefa4648.js";import"./build-b707106d.js";import"./build-f11286b0.js";import"./build-87aab1f3.js";import"./build-a28a094c.js";import"./build-8b45940b.js";import"./build-281e8c4c.js";import"./build-7412e499.js";import"./build-1e6bf074.js";import"./build-d92832d0.js";import"./build-eb425f3c.js";import"./build-cc1644d9.js";import"./build-bee6630b.js";import"./build-24c1331c.js";const Z=(o={})=>{const p=L(W,o);return{...p,mutate:async(c,l)=>{const{onSuccess:m,onError:s,mutationOptions:u}=l;try{await v.promise(p.mutateAsync(c,u),{pending:"generando Liga de Pago ...",success:{render({data:n}){return m(n),"Se creó la liga de pago con éxito"}}})}catch(n){const h=M(n,"No se puede realizar esta operacion en este momento. Intente nuevamente o reporte a sistemas");s(h),v.error(h,{type:S(n)})}}}},ee=o=>({amount:o==null?void 0:o.amount,fullName:o==null?void 0:o.name,email:o==null?void 0:o.email,phone:o==null?void 0:o.phone,message:o==null?void 0:o.concept}),y=1,b=2e4,I=({onSuccess:o})=>{const{mutate:p,isLoading:a}=Z(),c=z({amount:V().min(y,`El monto mínimo es ${y}.00`).max(b,`El monto máximo es ${b}.00`).required("El monto es requerido"),name:j().required("El nombre es requerido"),email:j().email("Ingresa un correo valido").required("El correo es requerido"),phone:j().test("longitud","El telefono es muy corto",t=>!(t&&t.replace(/[\s+]/g,"").length<10)).required("El telefono es requerido")}),l=U({initialValues:{amount:0,name:"",email:"",phone:"",concept:""},validationSchema:c,onSubmit:(t,{setSubmitting:d})=>{const E=ee(t);p(E,{onSuccess:()=>{d(!1),o({id:"123",amount:t.amount})},onError:()=>{d(!1)}})}}),{errors:m,touched:s,isSubmitting:u,setFieldValue:n,values:h}=l,x=u||a,k=t=>{const d=t.target.value===""?"":Number(t.target.value);n("amount",d)};return e.jsx(A,{containerProps:{sx:{flexGrow:0,height:"auto"}},children:e.jsx(H,{formik:l,children:e.jsxs(r,{spacing:3,sx:{p:3},children:[e.jsxs(r,{spacing:1,children:[e.jsx(i,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Monto *"}),e.jsx(g,{fullWidth:!0,placeholder:"$0.00",name:"amount",type:"number",InputProps:{endAdornment:e.jsx(f,{position:"end",children:"MXN"})},onChange:k,InputLabelProps:{shrink:!0},inputProps:{inputMode:"numeric",min:y,max:b}})]}),e.jsxs(r,{spacing:1,children:[e.jsx(i,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre Completo *"}),e.jsx(g,{name:"name",required:!0,placeholder:"Usuario",disabled:x,InputProps:{startAdornment:e.jsx(f,{position:"start",children:e.jsx(J,{})})}})]}),e.jsxs(r,{spacing:1,children:[e.jsx(i,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Correo Electrónico *"}),e.jsx(g,{name:"email",required:!0,placeholder:"usuario@dominio.com",disabled:x,InputProps:{startAdornment:e.jsx(f,{position:"start",children:e.jsx(K,{})})}})]}),e.jsxs(r,{spacing:1,children:[e.jsx(i,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Telefono *"}),e.jsx(X,{name:"phone",fullWidth:!0,langOfCountryName:"es",preferredCountries:["MX","US"],continents:["NA","SA"],value:h.phone||"+52",disabled:x,onChange:(t,d)=>{n("phone",t)},error:s.phone&&!!m.phone,helperText:s.phone&&m.phone})]}),e.jsxs(r,{spacing:1,children:[e.jsx(i,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Mensaje"}),e.jsx(g,{name:"concept",multiline:!0,disabled:x,rows:2,placeholder:"Pago por .."})]}),e.jsx(r,{sx:{pt:3},children:e.jsx(T,{loading:u,variant:"contained",color:"primary",fullWidth:!0,type:"submit",startIcon:e.jsx(G,{}),children:"Generar"})})]})})})};I.propTypes={onSuccess:C.func};const oe=({open:o,setOpen:p})=>{const[a,c]=P.useState(null),[l,m]=P.useState(!1),s=`${window.location.host}/cobro/${a==null?void 0:a.id}`,u=()=>{p(!1),c(null)};return e.jsx(Q,{open:o,handleClose:u,title:"Liga de Pago",onSuccess:n=>{c(n)},children:a?e.jsxs(r,{flexDirection:"column",alignItems:"center",justifyContent:"space-between",spacing:2,p:5,children:[e.jsxs(r,{flexDirection:"column",alignItems:"center",spacing:2,children:[e.jsx(w,{sx:{width:40,height:40},color:"success"}),e.jsx(i,{textAlign:"center",variant:"subtitle2",children:"Comparte la siguiente liga de pago para realizar el cobro por:"}),e.jsxs(r,{direction:"row",spacing:1,alignItems:"center",children:[e.jsxs(i,{variant:"h3",children:[" ",Y(a.amount)]}),e.jsx(i,{variant:"caption",children:"MXN"})]})]}),e.jsx(r,{flexDirection:"column",alignItems:"center",justifyContent:"space-between",spacing:0,children:e.jsxs(r,{justifyContent:"center",alignItems:"center",direction:"row",spacing:1,children:[e.jsx(_,{}),e.jsx(N,{component:q,underline:"always",to:s,href:s,target:"_blank",color:"info.main",children:s}),e.jsx($,{variant:"outlined",size:"small",color:l?"success":"inherit",onClick:()=>{m(!0),F(s),setTimeout(()=>{m(!1)},1e3)},children:l?e.jsx(B,{sx:{color:"success"}}):e.jsx(D,{sx:{color:"text.disabled"}})})]})}),e.jsx(i,{variant:"caption",color:"text.disabled",children:O(new Date,"dd MMM yyyy hh:mm a",{locale:R})})]}):e.jsx(I,{onSuccess:n=>{c(n)}})})};oe.propTypes={open:C.any,setOpen:C.func};export{oe as default};
