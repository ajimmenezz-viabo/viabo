import{y as he,j as e,r as d,d as T,g as H,S as l,T as u,B as C,I as $,z as ue,p as A,Z as J,C as p,D as me,E as fe,G as je,H as ge,J as Ce,R as Z,K as _,m as D,N as be,O as Se,Q as ye,U as ve,V as we,W as Ie,X as Me,Y as Ee,b as De,_ as Ae,n as Oe,$ as ke,a0 as Fe,a1 as Re,a2 as Pe,a3 as Le,k as Ne,P as Be,a4 as Te,a5 as He,a6 as _e}from"./index-2496077c.js";import{g as Ve,C as w,a as We,b as ze}from"./build-601684bc.js";import{u as h,M as Qe,a as Ge,C as $e,b as Ye,c as qe,d as Xe,F as Ke}from"./build-1c3201b1.js";import{C as U}from"./build-cfe06936.js";import{V as Je}from"./build-f07846cf.js";import{V as Ze}from"./build-fdfe8976.js";import{C as Ue,a as et,b as tt,H as st}from"./build-634946fc.js";import{C as rt}from"./build-1f60c866.js";import{C as it}from"./build-69de0832.js";import{R as nt}from"./build-8f25ece3.js";import{u as ot}from"./build-48db4505.js";import{C as at}from"./build-3f012c0e.js";import"./build-95b4797f.js";import{S as lt,L as ct,I as dt}from"./build-b7e4e580.js";import{u as xt}from"./build-cc167b65.js";import{S as pt}from"./build-42649e7e.js";import{A as ht,L as ut}from"./build-4528a2af.js";import{G as L}from"./build-1feedcb4.js";import{M as mt}from"./build-6d242705.js";import{L as ft,S as jt,a as gt,b as Ct,c as N,d as Y}from"./build-47126281.js";import{s as bt}from"./build-f8fc243b.js";import{E as q}from"./build-2b08c938.js";import{I as St}from"./build-c34bf43d.js";import{S as yt}from"./build-91cb4806.js";import{C as vt}from"./build-e8dc1173.js";import{D as X}from"./build-911f0a07.js";import{C as wt}from"./build-41052105.js";import"./build-965c2e06.js";import"./build-33aa55a0.js";import"./build-e19bcddf.js";import"./build-6d47ef8c.js";import"./build-4e764ad2.js";import"./build-f0449fa5.js";import"./build-6df08918.js";import"./build-96ae8649.js";import"./build-dcb313b0.js";import"./build-4419134f.js";import"./build-9a15ffb7.js";import"./build-a8a4decd.js";import"./build-25fe80fc.js";import"./build-ea96a55f.js";import"./build-ff7bc5ee.js";import"./build-b97028f5.js";import"./build-55187a80.js";import"./build-c99d9899.js";import"./build-bee6630b.js";const K=he(e.jsx("path",{d:"M2 17h20v2H2v-2zm1.15-4.05L4 11.47l.85 1.48 1.3-.75-.85-1.48H7v-1.5H5.3l.85-1.47L4.85 7 4 8.47 3.15 7l-1.3.75.85 1.47H1v1.5h1.7l-.85 1.48 1.3.75zm6.7-.75 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H15v-1.5h-1.7l.85-1.47-1.3-.75L12 8.47 11.15 7l-1.3.75.85 1.47H9v1.5h1.7l-.85 1.48zM23 9.22h-1.7l.85-1.47-1.3-.75L20 8.47 19.15 7l-1.3.75.85 1.47H17v1.5h1.7l-.85 1.48 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H23v-1.5z"}),"PasswordTwoTone"),It=(t,i={})=>{const[n,a]=d.useState(null);return{...T([w.CARD_INFO,t],({signal:c})=>Ve(t,c),{staleTime:6e4,onError:c=>{const s=H(c,"No se puede obtener la informacion de la tarjeta. Intente nuevamente o reporte a sistemas");a(s)},refetchOnWindowFocus:!1,...i}),error:n||null}};function Mt({disabledExpand:t=!1}){const i=h(f=>f.card),[n,a]=d.useState(t),[o,c]=d.useState(!1),[s,r]=d.useState(!1),x=h(f=>f.setOpenFundingOrder),m=h(f=>f.setFundingCard),y=h(f=>f.isMainCardSelected);return e.jsxs(e.Fragment,{children:[e.jsxs(U,{sx:{p:3},children:[e.jsxs(l,{display:"flex",flexDirection:"row",alignItems:"center",children:[e.jsx(u,{variant:"h6",children:y?"Fondear Comercio":"Fondear Tarjeta"}),e.jsx(C,{sx:{flex:"1 1 auto"}}),!t&&e.jsx($,{onClick:()=>{a(f=>!f)},children:n?e.jsx(Je,{sx:{color:"text.disabled"}}):e.jsx(Ze,{sx:{color:"text.disabled"}})})]}),e.jsx(Ue,{in:n,timeout:"auto",children:e.jsxs(l,{spacing:2,children:[e.jsxs(l,{flexDirection:"column",justifyContent:"space-between",alignItems:"baseline",gap:1,sx:{display:"flex",flexWrap:"wrap"},children:[e.jsxs(l,{flexDirection:"row",alignItems:"center",justifyContent:"center",sx:{flexGrow:1,flexWrap:"wrap"},gap:1,children:[e.jsx(u,{variant:"subtitle1",sx:{color:"text.secondary"},children:"SPEI"}),e.jsx($,{variant:"outlined",color:o?"success":"inherit",onClick:()=>{c(!0),ue(i==null?void 0:i.SPEI),setTimeout(()=>{c(!1)},1e3)},children:o?e.jsx(rt,{sx:{color:"success"}}):e.jsx(it,{sx:{color:"text.disabled"}})})]}),e.jsx(u,{variant:"body1",children:i==null?void 0:i.SPEI})]}),e.jsxs(l,{flexDirection:"row",flexWrap:"wrap",gap:3,alignItems:"center",children:[e.jsx(A,{fullWidth:!0,color:"primary",variant:"outlined",startIcon:e.jsx(Qe,{}),onClick:()=>r(!0),children:"Compartir"}),e.jsx(A,{fullWidth:!0,color:"primary",variant:"contained",startIcon:e.jsx(nt,{}),onClick:()=>{x(!0),m(i)},children:"Orden Fondeo"})]})]})})]}),e.jsx(Ge,{card:i,open:s,onClose:()=>{r(!1)}})]})}function Et(){const t=h(n=>n.card),{assignUser:i}=t;return e.jsxs(U,{sx:{p:3},children:[e.jsx(u,{variant:"h6",gutterBottom:!0,children:"Asignado a:"}),e.jsxs(l,{spacing:3,children:[e.jsxs(l,{justifyContent:"space-between",gap:1,children:[e.jsx(u,{variant:"subtitle2",sx:{color:"text.secondary"},textTransform:"capitalize",children:"Nombre"}),e.jsx(u,{variant:"body2",children:i==null?void 0:i.name})]}),(i==null?void 0:i.phone)&&e.jsxs(l,{justifyContent:"space-between",gap:1,children:[e.jsx(u,{variant:"subtitle2",sx:{color:"text.secondary"},children:"Telefono"}),e.jsx(u,{variant:"body2",children:(i==null?void 0:i.phone)||"-"})]}),e.jsxs(l,{justifyContent:"space-between",gap:1,children:[e.jsx(u,{variant:"subtitle2",sx:{color:"text.secondary"},children:"Correo"}),e.jsx(u,{variant:"body2",children:i==null?void 0:i.email})]})]})]})}const Dt=J(t=>e.jsx(lt,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(({theme:t})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:t.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:t.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:t.palette.error.main,opacity:1,transition:t.transitions.create(["background-color"],{duration:500})}}));function ee({card:t}){const[i,n]=d.useState(!1),[a,o]=d.useState(!1),{mutate:c,isLoading:s}=ot(),r=xt([w.CARD_INFO,t==null?void 0:t.id])===1;d.useEffect(()=>{n(!1),o(!1)},[t==null?void 0:t.id]);const x=m=>{c({...t,cardON:!(t!=null&&t.cardON)})};return e.jsx(me,{sx:m=>({borderRadius:1,position:"relative",zIndex:1,backgroundColor:m.palette.primary.light,color:"white",minHeight:"auto!important",height:{xs:1,sm:"auto"},py:{xs:0,sm:2}}),children:e.jsxs(l,{flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",sx:{width:1},gap:2,alignItems:"center",children:[e.jsxs(l,{flexDirection:"column",spacing:0,alignItems:{xs:"center",md:"start"},children:[e.jsxs(l,{flexDirection:"row",gap:1,alignItems:"center",children:[e.jsx(u,{variant:"subtitle2",children:"Disponible"}),s||r?e.jsx(fe,{size:30,containerProps:{display:"flex",ml:1}}):e.jsx(Dt,{disabled:s,color:t!=null&&t.cardON?"success":"error",checked:(t==null?void 0:t.cardON)||!1,onChange:x,sx:{m:1},inputProps:{"aria-label":"controlled"}})]}),e.jsxs(l,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(u,{variant:"h3",children:t==null?void 0:t.balanceFormatted}),e.jsx(u,{variant:"caption",children:"MXN"})]})]}),e.jsxs(l,{justifyContent:"flex-end",spacing:1,alignItems:{xs:"center",md:"end"},children:[e.jsx(at,{card:t,color:"#fff"}),e.jsxs(l,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",gap:1,divider:e.jsx(je,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),children:[e.jsx(u,{color:"#fff",variant:"subtitle2",children:t==null?void 0:t.expiration}),e.jsx(A,{startIcon:i?e.jsx(B,{handleFinish:()=>n(!1)}):e.jsx(K,{}),color:"inherit",onClick:()=>n(m=>!m),sx:{px:0,mx:0},children:i?e.jsx(l,{px:1,children:t==null?void 0:t.cvv}):"CVV"}),e.jsx(A,{startIcon:a?e.jsx(B,{handleFinish:()=>o(!1)}):e.jsx(K,{}),color:"inherit",onClick:()=>o(m=>!m),children:a?e.jsx(l,{px:1,children:t==null?void 0:t.nip}):"NIP"})]})]})]})})}ee.propTypes={card:p.shape({balanceFormatted:p.any,cardON:p.bool,cvv:p.any,expiration:p.any,id:p.any,nip:p.any})};function B({handleFinish:t,duration:i=10}){const[n,a]=d.useState(100);return d.useEffect(()=>{let o;return n>0?o=setInterval(()=>{a(c=>c-100/i)},1e3):t(),()=>clearInterval(o)},[n,i]),e.jsxs(C,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(ge,{variant:"determinate",value:n}),e.jsx(C,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(u,{variant:"caption",component:"div",color:"text.primary",children:`${Math.ceil(i*n/100)} `})})]})}B.propTypes={duration:p.number,handleFinish:p.func};function At(){const t=h(x=>x.card),i=h(x=>x.addInfoCard),{data:n,isLoading:a,isError:o,error:c,refetch:s}=It(t==null?void 0:t.id,{enabled:!!(t!=null&&t.id)}),{isCollapse:r}=Ce();return d.useEffect(()=>{n&&i(n)},[n]),e.jsx(l,{sx:x=>({pl:{xs:0,sm:2,lg:2},overflow:"hidden",flexDirection:"column",flexGrow:1}),children:e.jsxs(ht,{children:[a&&t&&e.jsx(Z,{}),o&&!n&&!a&&e.jsx(_,{sx:{justifyContent:"flex-start"},errorMessage:c,handleButton:s}),t&&!a&&!o&&n&&e.jsxs(e.Fragment,{children:[e.jsx(D.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsxs(l,{sx:x=>({overflow:"hidden",flexDirection:"column",flexGrow:1}),children:[e.jsx(ee,{card:t}),e.jsx($e,{})]})}),e.jsx(C,{sx:{overflowY:"auto"},children:e.jsx(D.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsx(l,{pt:2,pb:4,px:2,children:e.jsxs(L,{container:!0,spacing:3,sx:{p:0,pb:3},children:[e.jsx(L,{item:!0,xs:12,sm:12,md:12,lg:r?4:12,xl:4,children:e.jsxs(l,{spacing:3,children:[e.jsx(Ye,{card:t}),e.jsx(Mt,{}),e.jsx(Et,{})]})}),e.jsx(L,{item:!0,xs:12,sm:12,md:12,lg:r?8:12,xl:8,children:e.jsx(qe,{})})]})})})})]}),!t&&e.jsx(D.div,{exit:{opacity:0},initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:e.jsxs(l,{spacing:3,sx:{height:"100%",width:"100%"},children:[e.jsx(be,{variant:"filled",severity:"info",children:"Debe seleccionar una tarjeta para ver sus detalles!"}),e.jsx(l,{alignItems:"center",children:e.jsx(pt,{sx:{width:"30%"}})})]})})]})})}const Ot=J(Se)(({theme:t})=>({borderRadius:"8px!important",width:1,justifyContent:"center",display:"flex",alignItems:"center",mb:1}));te.propTypes={isOpenSidebar:p.bool,card:p.object,onOpenDetails:p.func};function te({isOpenSidebar:t,card:i,onOpenDetails:n}){const{id:a,cardUserNumber:o,cardType:c}=i,s=h(g=>g.setCard),r=h(g=>g.card),x=h(g=>g.addInfoCard),m=a===(r==null?void 0:r.id)&&r?(r==null?void 0:r.cardON)===!0?"online":"offline":"invisible",y=a===(r==null?void 0:r.id),f=g=>{var I;!((I=g.target)==null?void 0:I.type)&&!y&&(s(i),x({movements:[],expenses:"$0.00",income:"$0.00",balanceMovements:"$0.00"}),n())};return e.jsx(ye,{title:t?"":o,arrow:!0,placement:"right",children:e.jsx(ut,{sx:{mb:1,padding:0,borderRadius:1,"& :hover":{color:"text.primary"}},disablePadding:!0,children:e.jsxs(Ot,{onClick:f,sx:{...y&&{bgcolor:"secondary.light",color:"black","& :hover":{color:"text.primary"}},"& :hover":{color:"text.primary"},width:1,py:1,gap:1},children:[e.jsx(ft,{sx:{ml:2,m:0},children:e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(ve,{sx:g=>({width:30,height:30,m:0,color:g.palette.primary.contrastText,backgroundColor:g.palette.primary.main}),children:c==="Carnet"?e.jsx(et,{sx:{width:20},color:"white"}):e.jsx(mt,{sx:{width:20}})}),e.jsx(we,{status:m,sx:{right:0,bottom:0,position:"absolute"}})]})}),t&&e.jsx(e.Fragment,{children:e.jsx(l,{sx:{width:1},children:e.jsx(u,{noWrap:!0,variant:"subtitle2",children:o})})})]})})})}const kt=d.memo(te);se.propTypes={cards:p.array,isOpenSidebar:p.bool,onOpenDetails:p.func,isLoading:p.bool,sx:p.object};function se({cards:t,isOpenSidebar:i,isLoading:n,sx:a,onOpenDetails:o,...c}){return e.jsx(Ie,{disablePadding:!0,sx:a,...c,children:(n?[...Array(5)]:t).map((s,r)=>s!=null&&s.id?e.jsx(kt,{isOpenSidebar:i,card:s,onOpenDetails:o},s==null?void 0:s.id):e.jsx(jt,{isOpenSideBar:i},r))})}function re({cardTypes:t,isLoading:i,isError:n,refetch:a}){const o=h(r=>r.setCardTypeSelected),c=h(r=>r.cardTypeSelected),s=r=>{o(r==null?void 0:r.id)};return e.jsxs(C,{display:"flex",children:[i&&e.jsx(Z,{}),n&&!i&&e.jsx(_,{errorMessage:"No existen tipos de tarjetas para este comercio",handleButton:a}),!i&&!n&&(t==null?void 0:t.map(r=>{const x=c===(r==null?void 0:r.id);return e.jsx(ct,{variant:x?"ghost":"filled",color:Me((r==null?void 0:r.name)||"inherit"),sx:{textTransform:"uppercase",marginRight:1,marginBottom:2,cursor:"pointer",border:x?3:0,borderColor:x?m=>m.palette.primary.main:"inherit"},children:e.jsx(D.div,{onClick:()=>s(r),whileHover:{scale:1.03},whileTap:{scale:.8},children:r==null?void 0:r.name},r==null?void 0:r.id)},r==null?void 0:r.id)}))]})}re.propTypes={cardTypes:p.array,isError:p.any,isLoading:p.any,refetch:p.any};const Ft=(t={})=>{const[i,n]=d.useState(null),a=h(s=>s.setCardTypeSelected),o=h(s=>s.cardTypeSelected);return{...T([w.PAYMENT_PROCESSORS],We,{staleTime:6e4,refetchOnMount:"always",onError:s=>{const r=H(s,"No se puede obtener la lista de los tipos de tarjetas. Intente nuevamente o reporte a sistemas");n(r)},onSuccess:s=>{const r=(s==null?void 0:s.find(x=>(x==null?void 0:x.id)==="2"))||Array.isArray(s)&&(s==null?void 0:s.length)>0&&s[0]||null;r&&!o&&a(r==null?void 0:r.id)},...t}),error:i||null}},Rt=(t,i={})=>{const[n,a]=d.useState(null),o=h(s=>s.setMainCard);return{...T([w.MAIN_CARD],({signal:s})=>ze(t,s),{staleTime:6e4,refetchOnWindowFocus:!1,onError:s=>{const r=H(s,"No se puede obtener la informacion de la tarjeta principal");a(r),o(null),Ee.error(r,{type:De(s)})},onSuccess:s=>{o(s)},...i}),error:n||null}};function Pt(){const t=h(b=>{var S;return(S=b.card)==null?void 0:S.id}),i=h(b=>b.cardTypeSelected),{data:n,isLoading:a,isError:o,refetch:c}=Ft(),{data:s,isLoading:r,isRefetching:x,isError:m,error:y,refetch:f,isSuccess:g}=Xe(i,{enabled:!1}),{data:ie,refetch:I,isLoading:Lt}=Rt(i,{enabled:!1}),O=Ae(),ne=(O==null?void 0:O.permissions)??[],k=r||x,oe=Oe(),[j,V]=d.useState(!0),[F,W]=d.useState(""),[M,E]=d.useState(s||[]),[ae,R]=d.useState(!1),v=ke("up","md"),le=F&&ae,z=v&&!j;d.useEffect(()=>{i&&f(),i&&ne.includes(Fe.COMMERCE_CARDS)&&I()},[i]),d.useEffect(()=>{if(!v)return P()},[v,t]),d.useEffect(()=>{if(!j)return R(!1)},[j]),d.useEffect(()=>{s&&E(s)},[s]);const P=()=>{V(!1)},Q=()=>{V(b=>(b&&(W(""),E(s)),!b))},ce=()=>{R(!1)},de=async b=>{try{const{value:S}=b.target;if(W(S),S){const pe=bt(s,S)||[];E(pe)}else E(s)}catch(S){console.error(S)}},xe=()=>{R(!0)},G=e.jsxs(e.Fragment,{children:[e.jsxs(l,{children:[j&&e.jsx(re,{cardTypes:n,isLoading:a,isError:o,refetch:c}),!i&&j&&!a&&e.jsx(q,{pt:2.5,message:"Seleccione un tipo de tarjeta para obtener la lista de tarjetas"})]}),i&&!a&&!o&&e.jsxs(e.Fragment,{children:[e.jsx(C,{sx:{p:2,px:0},children:e.jsxs(l,{direction:"row",justifyContent:j?"flex-end":"center",alignItems:"center",spacing:2,children:[!z&&e.jsx(wt,{onClickAway:ce,children:e.jsx(dt,{fullWidth:!0,size:"small",value:F,onFocus:xe,onChange:de,placeholder:"Buscar Tarjetas...",InputProps:{startAdornment:e.jsx(St,{position:"start",children:e.jsx(yt,{sx:{color:"text.disabled",width:20,height:20}})})}})}),e.jsx(l,{direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(gt,{size:"small",sx:{...!j&&{transform:"rotate(180deg)"}},onClick:Q,children:Re})})]})}),m&&j&&!s&&!k&&e.jsx(_,{errorMessage:y,handleButton:f}),s&&j&&(s==null?void 0:s.length)===0&&!k&&e.jsx(q,{pt:2.5,message:"No hay tarjetas activas en este tipo de tarjeta"}),e.jsx(Pe,{sx:{height:.98},children:e.jsxs(e.Fragment,{children:[e.jsx(se,{isOpenSidebar:j,cards:M||[],isLoading:k,onOpenDetails:P}),le&&(M==null?void 0:M.length)===0&&(s==null?void 0:s.length)>0&&e.jsx(Le,{sx:{p:1,display:"flex",flexDirection:"column",alignItems:"center"},searchQuery:F})]})})]})]});return e.jsxs(e.Fragment,{children:[!v&&!j&&e.jsx(Ct,{onClick:Q,children:e.jsx(vt,{sx:{width:16,height:16}})}),v?e.jsx(X,{open:j,variant:"persistent",PaperProps:{sx:{height:1,borderRightStyle:"none",bgcolor:"background.default"}},sx:{height:1,width:N,transition:oe.transitions.create("width"),"& .MuiDrawer-paper":{position:"static",backgroundColor:"transparent!important",width:N},...z&&{width:Y,"& .MuiDrawer-paper":{width:Y,backgroundColor:"transparent!important",position:"static",transform:"none !important",visibility:"visible !important"}}},children:G}):e.jsx(X,{ModalProps:{keepMounted:!0},open:j,onClose:P,sx:{height:1,"& .MuiDrawer-paper":{width:N,p:2}},children:G})]})}function Ds(){const t=Ne();return d.useEffect(()=>()=>{const i=Object.values(w);t.cancelQueries(i)},[]),e.jsx(Be,{title:"Lista de Tarjetas",children:e.jsxs(tt,{children:[e.jsxs(C,{display:"flex",overflow:"hidden",sx:{height:"100vH",maxHeight:"100%",flexDirection:"column"},children:[e.jsx(C,{px:1,children:e.jsx(st,{name:"Lista de Tarjetas",links:[{name:"Inicio",href:Te.root},{name:"Viabo Card",href:He.cards},{name:_e.cards.name}]})}),e.jsxs(C,{display:"flex",overflow:"hidden",sx:{flex:"1 1 0%"},children:[e.jsx(C,{display:"block",width:1,position:"absolute"}),e.jsx(Pt,{}),e.jsx(At,{})]})]}),e.jsx(Ke,{})]})})}export{Ds as default};
