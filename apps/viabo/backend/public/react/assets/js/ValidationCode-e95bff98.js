import{v as he,n as fe,ak as H,A as pe,W as ne,G as D,D as se,_ as A,r as w,B as ve,g as me,al as ye,o as ge,j as R,i as Re,l as be,x as Ce,a5 as Se,am as z,an as G,ao as Ee,ap as Oe,aq as Y,ar as J,as as xe,at as Te,a1 as M,a2 as Ie,T as k,a4 as Qe,au as Fe,ab as j,ac as L,a7 as ke,p as V,aa as X}from"./index-f7bc3d6b.js";import{s as Pe,g as De,u as ie,v as Ae,a as ae,b as Ue,q as Me,p as Le,D as we,S as Ne,C as _e,P as Ve}from"./CommerceRegister-06086fff.js";function Be(t){return fe("MuiLink",t)}const $e=he("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),je=$e,oe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Ke=t=>oe[t]||t,We=({theme:t,ownerState:a})=>{const n=Ke(a.color),i=H(t,`palette.${n}`,!1)||a.color,r=H(t,`palette.${n}Channel`);return"vars"in t&&r?`rgba(${r} / 0.4)`:pe(i,.4)},qe=We,He=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],ze=t=>{const{classes:a,component:n,focusVisible:i,underline:r}=t,e={root:["root",`underline${se(r)}`,n==="button"&&"button",i&&"focusVisible"]};return be(e,Be,a)},Ge=ne(D,{name:"MuiLink",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:n}=t;return[a.root,a[`underline${se(n.underline)}`],n.component==="button"&&a.button]}})(({theme:t,ownerState:a})=>A({},a.underline==="none"&&{textDecoration:"none"},a.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},a.underline==="always"&&A({textDecoration:"underline"},a.color!=="inherit"&&{textDecorationColor:qe({theme:t,ownerState:a})},{"&:hover":{textDecorationColor:"inherit"}}),a.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${je.focusVisible}`]:{outline:"auto"}})),Ye=w.forwardRef(function(a,n){const i=ve({props:a,name:"MuiLink"}),{className:r,color:e="primary",component:u="a",onBlur:s,onFocus:l,TypographyClasses:c,underline:h="always",variant:y="inherit",sx:p}=i,b=me(i,He),{isFocusVisibleRef:d,onBlur:C,onFocus:E,ref:T}=ye(),[I,m]=w.useState(!1),S=ge(n,T),O=Q=>{C(Q),d.current===!1&&m(!1),s&&s(Q)},g=Q=>{E(Q),d.current===!0&&m(!0),l&&l(Q)},P=A({},i,{color:e,component:u,focusVisible:I,underline:h,variant:y}),U=ze(P);return R(Ge,A({color:e,className:Re(U.root,r),classes:c,component:u,onBlur:O,onFocus:g,ref:S,ownerState:P,variant:y,sx:[...Object.keys(oe).includes(e)?[]:[{color:e}],...Array.isArray(p)?p:[p]]},b))}),Je=Ye;var Xe=function(t){Ce(a,t);function a(i,r){var e;return e=t.call(this)||this,e.client=i,e.options=r,e.trackedProps=[],e.selectError=null,e.bindMethods(),e.setOptions(r),e}var n=a.prototype;return n.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},n.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),Z(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},n.onUnsubscribe=function(){this.listeners.length||this.destroy()},n.shouldFetchOnReconnect=function(){return $(this.currentQuery,this.options,this.options.refetchOnReconnect)},n.shouldFetchOnWindowFocus=function(){return $(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},n.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},n.setOptions=function(r,e){var u=this.options,s=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(r),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=u.queryKey),this.updateQuery();var l=this.hasListeners();l&&ee(this.currentQuery,s,this.options,u)&&this.executeFetch(),this.updateResult(e),l&&(this.currentQuery!==s||this.options.enabled!==u.enabled||this.options.staleTime!==u.staleTime)&&this.updateStaleTimeout();var c=this.computeRefetchInterval();l&&(this.currentQuery!==s||this.options.enabled!==u.enabled||c!==this.currentRefetchInterval)&&this.updateRefetchInterval(c)},n.getOptimisticResult=function(r){var e=this.client.defaultQueryObserverOptions(r),u=this.client.getQueryCache().build(this.client,e);return this.createResult(u,e)},n.getCurrentResult=function(){return this.currentResult},n.trackResult=function(r,e){var u=this,s={},l=function(h){u.trackedProps.includes(h)||u.trackedProps.push(h)};return Object.keys(r).forEach(function(c){Object.defineProperty(s,c,{configurable:!1,enumerable:!0,get:function(){return l(c),r[c]}})}),(e.useErrorBoundary||e.suspense)&&l("error"),s},n.getNextResult=function(r){var e=this;return new Promise(function(u,s){var l=e.subscribe(function(c){c.isFetching||(l(),c.isError&&(r!=null&&r.throwOnError)?s(c.error):u(c))})})},n.getCurrentQuery=function(){return this.currentQuery},n.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},n.refetch=function(r){return this.fetch(A({},r,{meta:{refetchPage:r==null?void 0:r.refetchPage}}))},n.fetchOptimistic=function(r){var e=this,u=this.client.defaultQueryObserverOptions(r),s=this.client.getQueryCache().build(this.client,u);return s.fetch().then(function(){return e.createResult(s,u)})},n.fetch=function(r){var e=this;return this.executeFetch(r).then(function(){return e.updateResult(),e.currentResult})},n.executeFetch=function(r){this.updateQuery();var e=this.currentQuery.fetch(this.options,r);return r!=null&&r.throwOnError||(e=e.catch(Se)),e},n.updateStaleTimeout=function(){var r=this;if(this.clearStaleTimeout(),!(z||this.currentResult.isStale||!G(this.options.staleTime))){var e=Ee(this.currentResult.dataUpdatedAt,this.options.staleTime),u=e+1;this.staleTimeoutId=setTimeout(function(){r.currentResult.isStale||r.updateResult()},u)}},n.computeRefetchInterval=function(){var r;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(r=this.options.refetchInterval)!=null?r:!1},n.updateRefetchInterval=function(r){var e=this;this.clearRefetchInterval(),this.currentRefetchInterval=r,!(z||this.options.enabled===!1||!G(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(e.options.refetchIntervalInBackground||Oe.isFocused())&&e.executeFetch()},this.currentRefetchInterval))},n.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},n.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},n.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},n.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},n.createResult=function(r,e){var u=this.currentQuery,s=this.options,l=this.currentResult,c=this.currentResultState,h=this.currentResultOptions,y=r!==u,p=y?r.state:this.currentQueryInitialState,b=y?this.currentResult:this.previousQueryResult,d=r.state,C=d.dataUpdatedAt,E=d.error,T=d.errorUpdatedAt,I=d.isFetching,m=d.status,S=!1,O=!1,g;if(e.optimisticResults){var P=this.hasListeners(),U=!P&&Z(r,e),Q=P&&ee(r,u,e,s);(U||Q)&&(I=!0,C||(m="loading"))}if(e.keepPreviousData&&!d.dataUpdateCount&&(b!=null&&b.isSuccess)&&m!=="error")g=b.data,C=b.dataUpdatedAt,m=b.status,S=!0;else if(e.select&&typeof d.data<"u")if(l&&d.data===(c==null?void 0:c.data)&&e.select===this.selectFn)g=this.selectResult;else try{this.selectFn=e.select,g=e.select(d.data),e.structuralSharing!==!1&&(g=Y(l==null?void 0:l.data,g)),this.selectResult=g,this.selectError=null}catch(o){J().error(o),this.selectError=o}else g=d.data;if(typeof e.placeholderData<"u"&&typeof g>"u"&&(m==="loading"||m==="idle")){var x;if(l!=null&&l.isPlaceholderData&&e.placeholderData===(h==null?void 0:h.placeholderData))x=l.data;else if(x=typeof e.placeholderData=="function"?e.placeholderData():e.placeholderData,e.select&&typeof x<"u")try{x=e.select(x),e.structuralSharing!==!1&&(x=Y(l==null?void 0:l.data,x)),this.selectError=null}catch(o){J().error(o),this.selectError=o}typeof x<"u"&&(m="success",g=x,O=!0)}this.selectError&&(E=this.selectError,g=this.selectResult,T=Date.now(),m="error");var N={status:m,isLoading:m==="loading",isSuccess:m==="success",isError:m==="error",isIdle:m==="idle",data:g,dataUpdatedAt:C,error:E,errorUpdatedAt:T,failureCount:d.fetchFailureCount,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>p.dataUpdateCount||d.errorUpdateCount>p.errorUpdateCount,isFetching:I,isRefetching:I&&m!=="loading",isLoadingError:m==="error"&&d.dataUpdatedAt===0,isPlaceholderData:O,isPreviousData:S,isRefetchError:m==="error"&&d.dataUpdatedAt!==0,isStale:K(r,e),refetch:this.refetch,remove:this.remove};return N},n.shouldNotifyListeners=function(r,e){if(!e)return!0;var u=this.options,s=u.notifyOnChangeProps,l=u.notifyOnChangePropsExclusions;if(!s&&!l||s==="tracked"&&!this.trackedProps.length)return!0;var c=s==="tracked"?this.trackedProps:s;return Object.keys(r).some(function(h){var y=h,p=r[y]!==e[y],b=c==null?void 0:c.some(function(C){return C===h}),d=l==null?void 0:l.some(function(C){return C===h});return p&&!d&&(!c||b)})},n.updateResult=function(r){var e=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!xe(this.currentResult,e)){var u={cache:!0};(r==null?void 0:r.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,e)&&(u.listeners=!0),this.notify(A({},u,r))}},n.updateQuery=function(){var r=this.client.getQueryCache().build(this.client,this.options);if(r!==this.currentQuery){var e=this.currentQuery;this.currentQuery=r,this.currentQueryInitialState=r.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(e==null||e.removeObserver(this),r.addObserver(this))}},n.onQueryUpdate=function(r){var e={};r.type==="success"?e.onSuccess=!0:r.type==="error"&&!Te(r.error)&&(e.onError=!0),this.updateResult(e),this.hasListeners()&&this.updateTimers()},n.notify=function(r){var e=this;M.batch(function(){r.onSuccess?(e.options.onSuccess==null||e.options.onSuccess(e.currentResult.data),e.options.onSettled==null||e.options.onSettled(e.currentResult.data,null)):r.onError&&(e.options.onError==null||e.options.onError(e.currentResult.error),e.options.onSettled==null||e.options.onSettled(void 0,e.currentResult.error)),r.listeners&&e.listeners.forEach(function(u){u(e.currentResult)}),r.cache&&e.client.getQueryCache().notify({query:e.currentQuery,type:"observerResultsUpdated"})})},a}(Ie);function Ze(t,a){return a.enabled!==!1&&!t.state.dataUpdatedAt&&!(t.state.status==="error"&&a.retryOnMount===!1)}function Z(t,a){return Ze(t,a)||t.state.dataUpdatedAt>0&&$(t,a,a.refetchOnMount)}function $(t,a,n){if(a.enabled!==!1){var i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&K(t,a)}return!1}function ee(t,a,n,i){return n.enabled!==!1&&(t!==a||i.enabled===!1)&&(!n.suspense||t.state.status!=="error")&&K(t,n)}function K(t,a){return t.isStaleByTime(a.staleTime)}function et(){var t=!1;return{clearReset:function(){t=!1},reset:function(){t=!0},isReset:function(){return t}}}var tt=k.createContext(et()),rt=function(){return k.useContext(tt)};function nt(t,a){var n=k.useRef(!1),i=k.useState(0),r=i[1],e=Qe(),u=rt(),s=e.defaultQueryObserverOptions(t);s.optimisticResults=!0,s.onError&&(s.onError=M.batchCalls(s.onError)),s.onSuccess&&(s.onSuccess=M.batchCalls(s.onSuccess)),s.onSettled&&(s.onSettled=M.batchCalls(s.onSettled)),s.suspense&&(typeof s.staleTime!="number"&&(s.staleTime=1e3),s.cacheTime===0&&(s.cacheTime=1)),(s.suspense||s.useErrorBoundary)&&(u.isReset()||(s.retryOnMount=!1));var l=k.useState(function(){return new a(e,s)}),c=l[0],h=c.getOptimisticResult(s);if(k.useEffect(function(){n.current=!0,u.clearReset();var y=c.subscribe(M.batchCalls(function(){n.current&&r(function(p){return p+1})}));return c.updateResult(),function(){n.current=!1,y()}},[u,c]),k.useEffect(function(){c.setOptions(s,{listeners:!1})},[s,c]),s.suspense&&h.isLoading)throw c.fetchOptimistic(s).then(function(y){var p=y.data;s.onSuccess==null||s.onSuccess(p),s.onSettled==null||s.onSettled(p,null)}).catch(function(y){u.clearReset(),s.onError==null||s.onError(y),s.onSettled==null||s.onSettled(void 0,y)});if(h.isError&&!u.isReset()&&!h.isFetching&&Pe(s.suspense,s.useErrorBoundary,[h.error,c.getCurrentQuery()]))throw h.error;return s.notifyOnChangeProps==="tracked"&&(h=c.trackResult(h,s)),h}function st(t,a,n){var i=Fe(t,a,n);return nt(i,Xe)}function it(t){const a=typeof t=="number",n=at(t);return(a||n&&t!=="")&&!isNaN(Number(t))}function at(t){return typeof t=="string"||t instanceof String}const ot={TOKEN_COMMERCE:"tokenCommerce",VALIDATION_CODE:"validationCode"},ut=(t,a={})=>{const{enqueueSnackbar:n}=j();return st([ot.TOKEN_COMMERCE],()=>De(t),{staleTime:60*5e3,onError:()=>{n("😟 Error al obtener el comercio",{variant:"error",autoHideDuration:5e3})},enabled:!!t,...a})},ct=(t={})=>{const{enqueueSnackbar:a}=j();return ie({mutationFn:Ae,onError:n=>{const i=ae(n,"No se puede validar el código");a(i,{variant:(n==null?void 0:n.status)===500?"error":"warning",autoHideDuration:5e3})},...t})},lt=(t={})=>{const{enqueueSnackbar:a}=j();return ie({mutationFn:Ue,onSuccess:()=>{a("Código Enviado!",{variant:"success"})},onError:n=>{const i=ae(n,"No se puede enviar el código");a(i,{variant:(n==null?void 0:n.status)===500?"error":"warning",autoHideDuration:5e3})},...t})},dt=ne(Me)`
  input {
    text-align: center;
  }
`,ht={TextFieldStyled:dt},ft=t=>R(ht.TextFieldStyled,{...t}),B={left:"ArrowLeft",right:"ArrowRight",backspace:"Backspace"};function pt(t,a){return t<=0?[]:Array.from({length:t},a)}function vt(t,a,n){return t.map((i,r)=>a===r?n:i)}function te(t){return t.join("")}function re(t,a){return[...t,a]}function mt(t,a,n){return t.reduce((i,r,e)=>{const{characters:u,restArrayMerged:s}=i;if(e<n)return{restArrayMerged:s,characters:re(u,r)};const[l,...c]=s;return{restArrayMerged:c,characters:re(u,l||"")}},{restArrayMerged:a,characters:[]}).characters}function yt(t){return t.split("")}const ue=k.forwardRef((t,a)=>{const{value:n,length:i,autoFocus:r,onChange:e,TextFieldsProps:u,onComplete:s,validateChar:l,className:c,...h}=t,{onPaste:y,onFocus:p,onKeyDown:b,className:d,...C}=u||{},E=pt(i,(o,v)=>({character:n[v]||"",inputRef:k.createRef()})),T=o=>E.findIndex(({inputRef:v})=>v.current===o),I=()=>E.map(({character:o})=>o),m=(o,v)=>{const f=vt(I(),o,v);return te(f)},S=o=>{var v,f;(f=(v=E[o])==null?void 0:v.inputRef.current)==null||f.focus()},O=o=>{var v,f;(f=(v=E[o])==null?void 0:v.inputRef.current)==null||f.select()},g=o=>{o+1!==i&&(E[o+1].character?O(o+1):S(o+1))},P=o=>{o>0&&O(o-1)},U=o=>{const v=o.target.value[0]||"",f=T(o.target);if(typeof l=="function"&&!l(v,f))return;const F=m(f,v);e==null||e(F),F.length===i&&(s==null||s(F)),v!==""?F.length<i?g(F.length-1):g(f):F[f]?O(f):P(f)},Q=o=>{o.preventDefault(),o.target.select(),p==null||p(o)},x=o=>{const v=o.target,f=T(v);v.value===o.key?(o.preventDefault(),g(f)):!v.value&&B.backspace===o.key||B.left===o.key?(o.preventDefault(),O(f-1)):B.right===o.key&&(o.preventDefault(),O(f+1)),b==null||b(o)},N=o=>{o.preventDefault();const v=o.target,f=o.clipboardData.getData("text/plain"),F=T(v),ce=I(),W=mt(ce,yt(f),F),q=W.findIndex((le,de)=>de>F&&le===""),_=te(W);if(e==null||e(_),_.length===i){s==null||s(_),S(i-1);return}q!==-1&&S(q),y==null||y(o)};return R(L,{display:"flex",gap:"20px",alignItems:"center",ref:a,className:`MuiOtpInput-Box ${c||""}`,...h,children:E.map(({character:o,inputRef:v},f)=>R(ft,{autoFocus:r?f===0:!1,autoComplete:"one-time-code",value:o,inputRef:v,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${f+1} ${d||""}`,onPaste:N,onFocus:Q,onChange:U,onKeyDown:x,...C},f))})});ue.defaultProps={value:"",length:4,autoFocus:!1,validateChar:()=>!0,onChange:()=>{},onComplete:()=>{},TextFieldsProps:{}};const gt="/react/assets/img/mail-a33a291d.svg";Rt.propTypes={store:ke.shape(Le)};function Rt({store:t}){const{lastProcess:a,setActualProcess:n,setLastProcess:i,setToken:r}=t,{info:e}=a,{mutate:u,isLoading:s}=lt(),{mutate:l,isLoading:c,isError:h,reset:y}=ct(),{data:p,isError:b}=ut(e==null?void 0:e.email);w.useEffect(()=>{p&&r(p==null?void 0:p.token)},[p]);const[d,C]=w.useState(""),E=S=>{C(S),y()},T=(S,O)=>it(S),I=S=>{l({code:S},{onSuccess:()=>{n(Ve.SERVICES_SELECTION),i()},onError:()=>{C("")}})},m=()=>{u({})};return V(X,{children:[R(L,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",my:4},children:R("img",{className:"animate__animated animate__pulse",src:gt,width:"25%",alt:"Sent Mail"})}),R(D,{variant:"h4",color:"textPrimary",align:"center",children:"Verificación de Cuenta"}),V(D,{paragraph:!0,sx:{mb:4,mt:2},align:"center",variant:"body2",color:"text.secondary",whiteSpace:"pre-line",children:["Enviamos un correo electrónico a ",e==null?void 0:e.email," con el código de verificacion de tu cuenta, ingrese el código en el cuadro a continuación para verificar su cuenta."]}),R(ue,{length:6,value:d,onComplete:I,onChange:E,validateChar:T,sx:{gap:{xs:1.5,sm:2,md:3}},TextFieldsProps:{placeholder:"-",error:h,disabled:c}}),!!h&&R(L,{mt:1,children:R(D,{variant:"caption",color:"error",children:"Código incorrecto"})}),R(L,{mb:5,children:R(we,{sx:{my:4},children:R(Ne,{direction:"row",spacing:1,justifyContent:"center",children:s?R(_e,{wid:!0,sx:{mx:3}}):V(X,{children:[R(D,{variant:"body2",children:"¿No tengo un código?"}),R(Je,{underline:"hover",sx:{cursor:"pointer"},onClick:m,children:R(D,{variant:"body2",color:"primary",children:"Reenviar código"})})]})})})})]})}export{Rt as default};
