import{o as ee,n as te,X as j,p as ne,W,T as S,t as K,_ as A,e as L,q as re,g as oe,Y as ae,O as se,j as l,i as ie,l as ce,S as le,Q as O,E,C as ue,w,F as U}from"./index-3c15f187.js";import{T as de}from"./commerceKeys-73898a6d.js";import{g as pe,p as me,S as fe,C as ge,P as he}from"./CommerceRegister-2b274463.js";import{u as ye,a as Ce}from"./useSendValidationCode-84014f90.js";import{u as xe,v as ve}from"./CommerceRepository-cb9bcdbe.js";import{D as be}from"./Divider-bbf7b4de.js";function ke(e){return te("MuiLink",e)}const Fe=ee("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),Te=Fe,q={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},De=e=>q[e]||e,Se=({theme:e,ownerState:n})=>{const r=De(n.color),s=j(e,`palette.${r}`,!1)||n.color,u=j(e,`palette.${r}Channel`);return"vars"in e&&u?`rgba(${u} / 0.4)`:ne(s,.4)},Re=Se,Ve=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Pe=e=>{const{classes:n,component:r,focusVisible:s,underline:u}=e,i={root:["root",`underline${K(u)}`,r==="button"&&"button",s&&"focusVisible"]};return ce(i,ke,n)},Ne=W(S,{name:"MuiLink",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:r}=e;return[n.root,n[`underline${K(r.underline)}`],r.component==="button"&&n.button]}})(({theme:e,ownerState:n})=>A({},n.underline==="none"&&{textDecoration:"none"},n.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},n.underline==="always"&&A({textDecoration:"underline"},n.color!=="inherit"&&{textDecorationColor:Re({theme:e,ownerState:n})},{"&:hover":{textDecorationColor:"inherit"}}),n.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Te.focusVisible}`]:{outline:"auto"}})),Ee=L.forwardRef(function(n,r){const s=re({props:n,name:"MuiLink"}),{className:u,color:i="primary",component:c="a",onBlur:d,onFocus:g,TypographyClasses:x,underline:R="always",variant:h="inherit",sx:y}=s,p=oe(s,Ve),{isFocusVisibleRef:V,onBlur:P,onFocus:f,ref:v}=ae(),[F,T]=L.useState(!1),b=se(r,v),m=k=>{P(k),V.current===!1&&T(!1),d&&d(k)},D=k=>{f(k),V.current===!0&&T(!0),g&&g(k)},N=A({},s,{color:i,component:c,focusVisible:F,underline:R,variant:h}),I=Pe(N);return l(Ne,A({color:i,className:ie(I.root,u),classes:x,component:c,onBlur:m,onFocus:D,ref:b,ownerState:N,variant:h,sx:[...Object.keys(q).includes(i)?[]:[{color:i}],...Array.isArray(y)?y:[y]]},p))}),Ae=Ee;function Le(e){const n=typeof e=="number",r=Ie(e);return(n||r&&e!=="")&&!isNaN(Number(e))}function Ie(e){return typeof e=="string"||e instanceof String}const Me=(e={})=>{const{enqueueSnackbar:n}=le();return xe({mutationFn:ve,onError:r=>{const s=pe(r,"No se puede validar el código");n(s,{variant:(r==null?void 0:r.status)===500?"error":"warning",autoHideDuration:5e3})},...e})},we=W(de)`
  input {
    text-align: center;
  }
`,$e={TextFieldStyled:we},Be=e=>l($e.TextFieldStyled,{...e}),$={left:"ArrowLeft",right:"ArrowRight",backspace:"Backspace"};function _e(e,n){return e<=0?[]:Array.from({length:e},n)}function je(e,n,r){return e.map((s,u)=>n===u?r:s)}function z(e){return e.join("")}function H(e,n){return[...e,n]}function Oe(e,n,r){return e.reduce((s,u,i)=>{const{characters:c,restArrayMerged:d}=s;if(i<r)return{restArrayMerged:d,characters:H(c,u)};const[g,...x]=d;return{restArrayMerged:x,characters:H(c,g||"")}},{restArrayMerged:n,characters:[]}).characters}function Ue(e){return e.split("")}const Q=O.forwardRef((e,n)=>{const{value:r,length:s,autoFocus:u,onChange:i,TextFieldsProps:c,onComplete:d,validateChar:g,className:x,...R}=e,{onPaste:h,onFocus:y,onKeyDown:p,className:V,...P}=c||{},f=_e(s,(t,a)=>({character:r[a]||"",inputRef:O.createRef()})),v=t=>f.findIndex(({inputRef:a})=>a.current===t),F=()=>f.map(({character:t})=>t),T=(t,a)=>{const o=je(F(),t,a);return z(o)},b=t=>{var a,o;(o=(a=f[t])==null?void 0:a.inputRef.current)==null||o.focus()},m=t=>{var a,o;(o=(a=f[t])==null?void 0:a.inputRef.current)==null||o.select()},D=t=>{t+1!==s&&(f[t+1].character?m(t+1):b(t+1))},N=t=>{t>0&&m(t-1)},I=t=>{const a=t.target.value[0]||"",o=v(t.target);if(typeof g=="function"&&!g(a,o))return;const C=T(o,a);i==null||i(C),C.length===s&&(d==null||d(C)),a!==""?C.length<s?D(C.length-1):D(o):C[o]?m(o):N(o)},k=t=>{t.preventDefault(),t.target.select(),y==null||y(t)},X=t=>{const a=t.target,o=v(a);a.value===t.key?(t.preventDefault(),D(o)):!a.value&&$.backspace===t.key||$.left===t.key?(t.preventDefault(),m(o-1)):$.right===t.key&&(t.preventDefault(),m(o+1)),p==null||p(t)},Y=t=>{t.preventDefault();const a=t.target,o=t.clipboardData.getData("text/plain"),C=v(a),G=F(),B=Oe(G,Ue(o),C),_=B.findIndex((J,Z)=>Z>C&&J===""),M=z(B);if(i==null||i(M),M.length===s){d==null||d(M),b(s-1);return}_!==-1&&b(_),h==null||h(t)};return l(E,{display:"flex",gap:"20px",alignItems:"center",ref:n,className:`MuiOtpInput-Box ${x||""}`,...R,children:f.map(({character:t,inputRef:a},o)=>l(Be,{autoFocus:u?o===0:!1,autoComplete:"one-time-code",value:t,inputRef:a,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${o+1} ${V||""}`,onPaste:Y,onFocus:k,onChange:I,onKeyDown:X,...P},o))})});Q.defaultProps={value:"",length:4,autoFocus:!1,validateChar:()=>!0,onChange:()=>{},onComplete:()=>{},TextFieldsProps:{}};const ze="/react/assets/img/mail-a33a291d.svg";He.propTypes={store:ue.shape(me)};function He({store:e}){const{lastProcess:n,setActualProcess:r,setLastProcess:s,setToken:u,token:i}=e,{info:c}=n,{mutate:d,isLoading:g}=ye(),{mutate:x,isLoading:R,isError:h,reset:y}=Me(),{data:p,isError:V}=Ce(c==null?void 0:c.email,{enabled:!!(c!=null&&c.email)});L.useEffect(()=>{p&&u(p==null?void 0:p.token)},[p]);const[P,f]=L.useState(""),v=m=>{f(m),y()},F=(m,D)=>Le(m),T=m=>{x({verificationCode:m,token:i},{onSuccess:()=>{r(he.SERVICES_SELECTION),s()},onError:()=>{f("")}})},b=()=>{d({token:p==null?void 0:p.token})};return w(U,{children:[l(E,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",my:4},children:l("img",{className:"animate__animated animate__pulse",src:ze,width:"25%",alt:"Sent Mail"})}),l(S,{variant:"h4",color:"textPrimary",align:"center",children:"Verificación de Cuenta"}),w(S,{paragraph:!0,sx:{mb:4,mt:2},align:"center",variant:"body2",color:"text.secondary",whiteSpace:"pre-line",children:["Enviamos un correo electrónico a ",c==null?void 0:c.email," con el código de verificacion de tu cuenta, ingrese el código en el cuadro a continuación para verificar su cuenta."]}),l(Q,{length:6,value:P,onComplete:T,onChange:v,validateChar:F,sx:{gap:{xs:1.5,sm:2,md:3}},TextFieldsProps:{placeholder:"-",error:h,disabled:R}}),!!h&&l(E,{mt:1,children:l(S,{variant:"caption",color:"error",children:"Código incorrecto"})}),l(E,{mb:5,children:l(be,{sx:{my:4},children:l(fe,{direction:"row",spacing:1,justifyContent:"center",children:g?l(ge,{wid:!0,sx:{mx:3}}):w(U,{children:[l(S,{variant:"body2",children:"¿No tengo un código?"}),l(Ae,{underline:"hover",sx:{cursor:"pointer"},onClick:b,children:l(S,{variant:"body2",color:"primary",children:"Reenviar código"})})]})})})})]})}export{He as default};
