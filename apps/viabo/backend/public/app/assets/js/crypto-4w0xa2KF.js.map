{"version":3,"file":"crypto-4w0xa2KF.js","sources":["../../../../../frontend/src/shared/utils/crypto.js"],"sourcesContent":["import CryptoJS from 'crypto-js'\r\n\r\nconst SECRET_KEY = import.meta.env.APP_OPENSSL\r\n\r\nexport const getCryptInfo = object => {\r\n  // Convertir el objeto a una cadena JSON\r\n  const jsonString = JSON.stringify(object)\r\n\r\n  // Generar una clave de cifrado\r\n  const key = CryptoJS.enc.Utf8.parse(SECRET_KEY)\r\n\r\n  // Generar un vector de inicialización aleatorio\r\n  const iv = CryptoJS.lib.WordArray.random(16)\r\n\r\n  // Cifrar la cadena JSON utilizando AES-256-CBC\r\n  const ciphertext = CryptoJS.AES.encrypt(jsonString, key, {\r\n    iv\r\n  }).toString()\r\n\r\n  // Convertir el vector de inicialización a una cadena Base64\r\n  const ivBase64 = CryptoJS.enc.Base64.stringify(iv)\r\n\r\n  return {\r\n    ciphertext,\r\n    iv: ivBase64\r\n  }\r\n}\r\n\r\nexport const getDecryptInfo = (ciphertextBase64, ivBase64) => {\r\n  try {\r\n    const key = CryptoJS.enc.Utf8.parse(SECRET_KEY)\r\n    // Decodificar el vector de inicialización desde Base64\r\n    const iv = CryptoJS.enc.Base64.parse(ivBase64)\r\n    // Decodificar el texto cifrado desde Base64\r\n    const ciphertext = CryptoJS.enc.Base64.parse(ciphertextBase64)\r\n    // Desencriptar el texto cifrado utilizando AES-256-CBC\r\n    const decrypted = CryptoJS.AES.decrypt(\r\n      {\r\n        ciphertext\r\n      },\r\n      key,\r\n      {\r\n        iv\r\n      }\r\n    )\r\n\r\n    // Convertir el resultado de desencriptar a una cadena UTF-8\r\n    const plaintext = decrypted.toString(CryptoJS.enc.Utf8)\r\n    const object = JSON.parse(plaintext)\r\n    return object ?? null\r\n  } catch (e) {\r\n    return null\r\n  }\r\n}\r\n"],"names":["SECRET_KEY","getCryptInfo","object","jsonString","key","CryptoJS","iv","ciphertext","ivBase64","getDecryptInfo","ciphertextBase64","plaintext"],"mappings":"0CAEA,MAAMA,EAAa,mCAENC,EAAyBC,GAAA,CAE9B,MAAAC,EAAa,KAAK,UAAUD,CAAM,EAGlCE,EAAMC,EAAS,IAAI,KAAK,MAAML,CAAU,EAGxCM,EAAKD,EAAS,IAAI,UAAU,OAAO,EAAE,EAGrCE,EAAaF,EAAS,IAAI,QAAQF,EAAYC,EAAK,CACvD,GAAAE,CAAA,CACD,EAAE,SAAS,EAGNE,EAAWH,EAAS,IAAI,OAAO,UAAUC,CAAE,EAE1C,MAAA,CACL,WAAAC,EACA,GAAIC,CAAA,CAER,EAEaC,EAAiB,CAACC,EAAkBF,IAAa,CACxD,GAAA,CACF,MAAMJ,EAAMC,EAAS,IAAI,KAAK,MAAML,CAAU,EAExCM,EAAKD,EAAS,IAAI,OAAO,MAAMG,CAAQ,EAEvCD,EAAaF,EAAS,IAAI,OAAO,MAAMK,CAAgB,EAavDC,EAXYN,EAAS,IAAI,QAC7B,CACE,WAAAE,CACF,EACAH,EACA,CACE,GAAAE,CACF,CAAA,EAI0B,SAASD,EAAS,IAAI,IAAI,EAEtD,OADe,KAAK,MAAMM,CAAS,GAClB,UACP,CACH,OAAA,IACT,CACF"}