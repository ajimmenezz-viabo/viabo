import{ab as D,ac as x,ad as F,j as e,S as a,T as s,X as V,ae as I,L as q,c as P,r as w}from"./build-bd106f3f.js";import{R as h}from"./build-6201b366.js";import{R as k,I as E}from"./build-b80dcee8.js";import{u as M}from"./build-7122b208.js";import{F as N}from"./build-bae479f0.js";import{c as j,a as p}from"./build-f590a2bc.js";import{u as L,V as z,D as _}from"./build-1d224b6d.js";import{u as f,C as v}from"./build-bc6720e1.js";import{I as g}from"./build-200f548c.js";import{C as G}from"./build-a614d788.js";import{A as B}from"./build-b563e77e.js";import"./build-ce849df6.js";import"./build-785a4db1.js";import"./build-bee6630b.js";import"./build-d3be50c2.js";import"./build-ecaf0d13.js";import"./build-3df7d10a.js";import"./build-fecf758a.js";const b=w.forwardRef((o,l)=>e.jsx(E,{overwrite:!0,...o,inputRef:l}));function ce(){const o=f(r=>r.setStepAssignRegister),l=f(r=>r.setCard),{data:y,isLoading:C}=L(),S=j().shape({cardNumber:p().transform((r,t)=>t.replace(/\s/g,"")).min(16,"Debe contener 16 digitos").required("El número de la tarjeta es requerido"),cvv:p().min(3,"Debe contener 3 digitos").required("El CVV es requerido"),cardType:j().nullable().required("El tipo de tarjeta es requerido"),expiration:p().required("La fecha de vencimiento es requerida").test("is-future-date","La fecha  debe ser mayor que la fecha actual",function(r){const t=D(`01/${r}`,"dd/MM/yyyy",new Date),A=new Date;return x(t)&&F(t,A)})}),n=M({initialValues:{cardNumber:"",cardType:null,expiration:"",cvv:""},validationSchema:S,onSubmit:(r,{setSubmitting:t})=>{t(!1),l(r),o(v.CARD_ASSIGNED)}}),{isSubmitting:R,values:d,setFieldValue:u,errors:c,handleSubmit:T,touched:m,resetForm:W,setSubmitting:$}=n,i=R||C;return e.jsxs(a,{sx:{display:"flex",overflow:"hidden",mb:3},children:[e.jsxs(a,{direction:"column",width:1,spacing:1,children:[e.jsx(s,{variant:"h4",color:"textPrimary",align:"center",children:"Registrar Tarjeta"}),e.jsx(s,{paragraph:!0,align:"center",variant:"body1",color:"text.secondary",whiteSpace:"pre-line",children:"Ingrese la información de la tarjeta para asociarla a su cuenta."})]}),e.jsx(V,{containerProps:{sx:{flexGrow:0,height:"auto"}},children:e.jsx(N,{formik:n,children:e.jsxs(a,{spacing:2,p:3,children:[e.jsxs(a,{children:[e.jsx(s,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Tipo de Tarjeta"}),e.jsx(k,{name:"cardType",disableClearable:!0,size:"small",textFieldParams:{placeholder:"Seleccionar ...",required:!0,size:"small"},options:y||[],disabled:i})]}),e.jsxs(a,{children:[e.jsx(s,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Número de Tarjeta"}),e.jsx(h,{autoFocus:!0,name:"cardNumber",required:!0,placeholder:"5254 2700 9717 8968",fullWidth:!0,size:"small",InputProps:{startAdornment:e.jsx(g,{position:"start",children:e.jsx(G,{})}),inputComponent:b,inputProps:{mask:"0000 0000 0000 0000",value:d.cardNumber,onAccept:r=>{u("cardNumber",r)}}},disabled:i})]}),e.jsxs(a,{direction:{xs:"column",lg:"row"},spacing:3,display:"flex",children:[e.jsxs(a,{sx:{width:{xs:"100%",lg:"40%"}},children:[e.jsx(s,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"CVV"}),e.jsx(h,{name:"cvv",required:!0,placeholder:"123",size:"small",InputProps:{startAdornment:e.jsx(g,{position:"start",children:e.jsx(z,{})}),inputComponent:b,inputProps:{mask:"000",onAccept:r=>{u("cvv",r)},value:d.cvv}},disabled:i})]}),e.jsxs(a,{children:[e.jsx(s,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Vence"}),e.jsx(_,{disabled:i,views:["year","month"],size:"small",name:"expiration",value:new Date(d.expiration)??null,onChange:r=>x(r)?n.setFieldValue("expiration",I(r,"MM/yyyy")):n.setFieldValue("expiration",""),slotProps:{textField:{fullWidth:!0,size:"small",error:!!(m.expiration&&c.expiration),required:!0,helperText:m.expiration&&c.expiration?c.expiration:""}},disablePast:!0,format:"MM/yy"})]})]})]})})}),e.jsxs(a,{spacing:3,p:3,children:[e.jsx(q,{loading:i,variant:"contained",color:"primary",fullWidth:!0,type:"submit",onClick:T,disabled:i,startIcon:e.jsx(B,{}),children:"Asociar"}),e.jsx(P,{variant:"outlined",color:"inherit",onClick:()=>{o(v.USER_REGISTER)},children:"Cancelar"})]})]})}export{ce as default};
