import{c as R,f as _,a9 as g,u as F,i as e,V as i,T as p,B as j,b8 as I,dH as P,e0 as M,dZ as S,e1 as C,aY as v,dr as T,dv as D,a0 as L,P as w}from"./vendor-X9cKXa3I.js";import{u as z}from"./formik.esm-drA_7EEr.js";import{c as q,a as o,d as U}from"./index.esm-87Db4h5o.js";import{g as W,a as V}from"./index-IncEwUKO.js";import{M as t,n as B}from"./ViaboSpeiCostCenters--cgK_71n.js";import{i as A}from"./matchTypes-ev-w7Wi9.js";import{F as O,R as N}from"./TextMaxLine-SKcMsBiK.js";import{R as k}from"./RFSelect-FrmrIEQp.js";import"./useViaboSpeiBreadCrumbs-_KtiQNgU.js";import"./index-bT7c8_vF.js";import"./crypto-DLV5sXJi.js";import"./HeaderPage-V_w2vjBb.js";import"./fade-HpdRXKiE.js";import"./transition-Uc7vb3zK.js";import"./useMaterialTable-N56kn-M3.js";import"./UploadSingleFile-v78kQPok.js";import"./formatNumber-lcHsHzSd.js";const $=r=>{var l,x,h,u,n,m;return{name:(l=r==null?void 0:r.adminName)==null?void 0:l.trim(),isNewUser:(r==null?void 0:r.method)===t.NEW_ADMIN_USER,assignedUsers:((x=r==null?void 0:r.adminUsers)==null?void 0:x.map(a=>a.value))||[],newUserName:(h=r==null?void 0:r.adminName)==null?void 0:h.trim(),newUserLastName:(u=r==null?void 0:r.adminLastName)==null?void 0:u.trim(),newUserEmail:(n=r==null?void 0:r.adminEmail)==null?void 0:n.trim(),newUserPhone:(m=r==null?void 0:r.adminPhone)==null?void 0:m.trim()}},H=(r={})=>{R();const l=_(B,r);return{...l,mutate:async(h,u)=>{const{onSuccess:n,onError:m,mutationOptions:a}=u;try{await g.promise(l.mutateAsync(h,a),{pending:"Creando centro de costos...",success:{render({data:c}){return A(n)&&n(c),"Se creó el centro de costos con éxito"}}})}catch(c){const E=W(c,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");A(m)&&m(E),g.error(E,{type:V(c)})}}}},Q=({adminUsers:r,onSuccess:l})=>{const{mutate:x,isLoading:h}=H(),u=q().shape({name:o().trim().required("Es necesario el nombre del centro de costos"),method:o(),adminUsers:U().when("method",{is:t.ADMIN_USERS,then:s=>s.min(1,"Es necesario al menos un usuario administrador asignado al centro de costos"),otherwise:s=>U()}),adminName:o().trim().when("method",{is:t.NEW_ADMIN_USER,then:s=>s.required("Es necesario el nombre del administrador"),otherwise:s=>o().trim()}),adminLastName:o().trim().when("method",{is:t.NEW_ADMIN_USER,then:s=>s.required("Es necesario los apellidos del administrador"),otherwise:s=>o().trim()}),adminEmail:o().trim().email("Ingrese un correo valido").when("method",{is:t.NEW_ADMIN_USER,then:s=>s.required("Es necesario el correo del administrador"),otherwise:s=>o().trim().email("Ingrese un correo valido")}),adminPhone:o().trim()}),n=z({initialValues:{name:"",method:t.ADMIN_USERS,adminUsers:[],adminName:"",adminLastName:"",adminEmail:"",adminPhone:""},enableReinitialize:!0,validationSchema:u,onSubmit:(s,{setSubmitting:b,setFieldValue:G})=>{const f=$(s);x(f,{onSuccess:()=>{l(),b(!1)},onError:()=>{b(!1)}})}}),{isSubmitting:m,setFieldValue:a,values:c,setTouched:E}=n,d=m||h;return F(),e.jsx(O,{formik:n,children:e.jsxs(i,{spacing:2,children:[e.jsxs(i,{spacing:1,children:[e.jsxs(p,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Nombre",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(N,{inputProps:{maxLength:"18"},required:!0,name:"name",size:"small",disabled:d,placeholder:"Nombre del Centro de Costos..."})]}),e.jsx(i,{children:e.jsxs(I,{disabled:d,children:[e.jsx(P,{id:"demo-row-radio-buttons-group-label",children:"Seleccione al administrador del centro de costos:"}),e.jsxs(M,{value:c.method,onChange:s=>{a("method",s.target.value),a("adminUsers",[]),a("adminName",""),a("adminLastName",""),a("adminEmail",""),a("adminPhone",""),E({},!1)},row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"row-radio-buttons-group",children:[e.jsx(S,{value:t.ADMIN_USERS,control:e.jsx(C,{}),label:"Administrador de Centro de Costos Existente"}),e.jsx(S,{value:t.NEW_ADMIN_USER,control:e.jsx(C,{}),label:"Nuevo Administrador de Centro de Costos"})]})]})}),c.method===t.ADMIN_USERS?e.jsxs(i,{spacing:1,children:[e.jsxs(p,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Usuarios Administradores",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(k,{multiple:!0,name:"adminUsers",textFieldParams:{placeholder:"Seleccionar ...",size:"small"},options:r||[],disabled:d})]}):e.jsxs(e.Fragment,{children:[e.jsxs(i,{spacing:1,children:[e.jsxs(p,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Nombre (s)",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(N,{name:"adminName",size:"small",required:!0,placeholder:"Nombre Administrador del Centro de Costos...",disabled:d})]}),e.jsxs(i,{spacing:1,children:[e.jsxs(p,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Apellido (s)",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(N,{name:"adminLastName",size:"small",required:!0,placeholder:"Apellidos del Administrador del Centro de Costos...",disabled:d})]}),e.jsxs(i,{flexDirection:{md:"row"},gap:2,children:[e.jsxs(i,{spacing:1,flex:1,children:[e.jsxs(p,{type:"email",paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Correo",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(N,{name:"adminEmail",size:"small",required:!0,placeholder:"admin.company@domino.com...",InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(T,{})})},disabled:d})]}),e.jsxs(i,{spacing:1,children:[e.jsx(p,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono"}),e.jsx(N,{name:"adminPhone",type:"tel",size:"small",placeholder:"55 5555 5555",InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(D,{})})},disabled:d})]})]})]}),e.jsx(i,{sx:{pt:1},children:e.jsx(L,{size:"large",loading:d,variant:"contained",color:"primary",fullWidth:!0,type:"submit",children:"Crear"})})]})})};Q.propTypes={adminUsers:w.array,onSuccess:w.func};export{Q as default};
//# sourceMappingURL=SpeiNewCostCenterForm-10CNgHyq.js.map
