import{c as R,f as L,U as I,s as W,bv as E,r as f,i as e,bs as N,bt as P,bu as V,bw as s,bx as z,B as O,T as r,S as v,bQ as Q,aT as _,dt as G,dy as D,e1 as U,P as c}from"./vendor-B39b6gT1.js";import{f as b}from"./formatNumber-Byfz8vD2.js";import{O as $,g as H,b as q,S as K}from"./index-Kl2QvVyT.js";import{d as Y,V as T,L as J,B as X}from"./DashboardViaboSpeiByProfile-DwKkdrW4.js";import{i as k}from"./matchTypes-E5vQDj-t.js";import"./viabo-spei-paths-D6KJcfc8.js";import"./formatTime-DnNoLFDr.js";import"./filterSearch-NGUmCbyG.js";import"./fade-CViozI82.js";import"./transition-anLY3gj9.js";import"./TextMaxLine-BvJpBV6_.js";import"./formik.esm-CRn2DIxC.js";import"./UploadSingleFile-BV6pleIy.js";import"./usePagination-Bk1liHqP.js";import"./spei-third-accounts-store-CxAZWAjk.js";import"./HeaderPage-CoeRaeoE.js";const Z=(n,o,a)=>{const h={externalAccounts:n==null?void 0:n.map(t=>{var x,p,l;return{id:(p=(x=t==null?void 0:t.account)==null?void 0:x.id)==null?void 0:p.toString(),amount:parseFloat((t==null?void 0:t.amount.toString())===""?"0":(l=t==null?void 0:t.amount)==null?void 0:l.toString().replace(/,/g,""))}}),concept:(o==null?void 0:o.toString())||"",googleAuthenticatorCode:(a==null?void 0:a.toString())||""};return $(h)},w=(n={})=>{const o=R(),a=L(Y,n);return{...a,mutate:async(t,x)=>{const{onSuccess:p,onError:l,mutationOptions:S}=x;try{const d=await I.promise(a.mutateAsync(t,S),{pending:"Enviando Transacciones ..."});o.invalidateQueries([T.ACCOUNT_INFO]),o.invalidateQueries([T.BALANCE_RESUME]),o.invalidateQueries([T.MOVEMENTS]),k(p)&&p(d)}catch(d){const m=H(d,"No se puede realizar esta operaciÃ³n en este momento. Intente nuevamente o reporte a sistemas");k(l)&&l(m),I.error(m,{type:q(d)})}}}},B=W(E)(({theme:n})=>({"& td":{paddingTop:n.spacing(.5),paddingBottom:n.spacing(.5)}})),ee=({data:n,onBack:o,setTransactionLoading:a,transactionLoading:h,onSuccess:t})=>{const{mutate:x,isLoading:p}=w(),l=f.useMemo(()=>(n==null?void 0:n.transactions)||[],[n]),S=f.useMemo(()=>(parseFloat(n==null?void 0:n.balance)-(n==null?void 0:n.currentBalance)).toFixed(2)||0,[n]),[d,m]=f.useState(""),F=()=>{const{transactions:i,concept:u}=n,g=Z(i,u,d);a(!0),x(g,{onSuccess:j=>{t(j)},onError:()=>{a(!1)}})},y=p||h;return e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(N,{sx:{minWidth:200},children:e.jsxs(P,{children:[e.jsx(V,{sx:{borderBottom:i=>`solid 1px ${i.palette.divider}`},children:e.jsxs(E,{children:[e.jsx(s,{width:40,children:"#"}),e.jsx(s,{align:"left",children:"Movimiento"}),e.jsx(s,{align:"right",children:"Monto"})]})}),e.jsxs(z,{children:[l==null?void 0:l.map((i,u)=>{var g,j,C,A;return e.jsxs(E,{sx:{borderBottom:M=>`solid 1px ${M.palette.divider}`},children:[e.jsx(s,{children:u+1}),e.jsx(s,{align:"left",children:e.jsxs(O,{sx:{maxWidth:200},children:[e.jsx(r,{variant:"subtitle2",fontWeight:"bold",children:(g=i==null?void 0:i.account)==null?void 0:g.alias}),e.jsx(r,{variant:"subtitle2",children:(C=(j=i==null?void 0:i.account)==null?void 0:j.bank)==null?void 0:C.name}),e.jsx(r,{variant:"subtitle2",children:(A=i==null?void 0:i.account)==null?void 0:A.clabe}),e.jsx(r,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:i==null?void 0:i.concept})]})}),e.jsx(s,{align:"right",children:b(i==null?void 0:i.amount)})]},u)}),e.jsxs(B,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(v,{flexDirection:"row",gap:1,alignItems:"center",justifyContent:"flex-end",children:e.jsx(r,{children:"Saldo disponible"})})}),e.jsx(s,{align:"right",width:120,children:e.jsx(r,{children:b(n==null?void 0:n.balance)})})]}),e.jsxs(B,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(r,{variant:"h6",children:"Total a dispersar"})}),e.jsx(s,{align:"right",width:120,children:e.jsx(r,{variant:"h6",sx:{color:"error.main"},children:b(-(n==null?void 0:n.currentBalance))})})]}),e.jsxs(B,{children:[e.jsx(s,{colSpan:1}),e.jsx(s,{align:"right",children:e.jsx(r,{children:"Saldo actualizado"})}),e.jsx(s,{align:"right",width:140,children:e.jsx(r,{children:b(S)})})]})]})]})}),e.jsxs(v,{spacing:1,p:3,justifyContent:"flex-end",alignItems:"flex-end",children:[e.jsxs(r,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Token de Google"," ",e.jsx(O,{component:"span",color:"error.main",children:"*"})]}),e.jsx(Q,{name:"googleCode",type:"number",size:"small",placeholder:"000000",required:!0,value:d,onChange:i=>{var u;return m((u=i==null?void 0:i.target)==null?void 0:u.value)},inputProps:{pattern:"/^-?d+.?d*$/",min:"1"},InputProps:{startAdornment:e.jsx(_,{position:"start",children:e.jsx(G,{})})},disabled:y})]})]}),e.jsxs(v,{direction:{md:"row-reverse"},sx:{p:3},gap:3,children:[e.jsx(J,{size:"large",onClick:F,endIcon:e.jsx(D,{}),loading:y,variant:"contained",color:"primary",fullWidth:!0,type:"submit",disabled:!d,sx:{fontWeight:"bold"},children:"Enviar"}),!y&&e.jsx(X,{size:"large",onClick:o,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(U,{}),children:"Regresar"})]})]})};ee.propTypes={data:c.shape({balance:c.any,currentBalance:c.any,concept:c.any,transactions:c.array}),onBack:c.func,onSuccess:c.func,setTransactionLoading:c.func,transactionLoading:c.any};export{ee as default};
//# sourceMappingURL=SpeiOutResume-XA_G077q.js.map
