import{y as B,j as r,k as v,a as A,Y as b,g as E,b as R,Z as M,r as I,a2 as F,B as f,T as p,S as N,L as k,p as O,C as t}from"./index-66cb75df.js";import{a as Q}from"./build-6d8fb990.js";import{f as a}from"./build-6421e956.js";import{t as _,C as S}from"./build-2e8706bc.js";import{T,d as L,e as W,f as D,g as c,h as G}from"./build-708407b9.js";import{S as z}from"./build-40c27197.js";import"./build-bee6630b.js";import"./build-9d3fe41c.js";import"./build-cb9d33cb.js";import"./build-f58640b5.js";import"./build-7b5d6586.js";import"./build-1f27af78.js";import"./build-1340cc8b.js";import"./build-33d27e57.js";import"./build-1ee72508.js";import"./build-8fb582f0.js";import"./build-b463c8f6.js";import"./build-7226c475.js";import"./build-27a4b8f9.js";import"./build-8a357111.js";import"./build-bd32fad9.js";const P=B(r.jsx("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos"),Y=(e,n,h)=>{var u,g,x;let l;return h?l={originCardId:e,destinationCards:[{cardId:(u=n==null?void 0:n.card)==null?void 0:u.value.toString(),concept:(g=n==null?void 0:n.concept)==null?void 0:g.toString(),amount:parseFloat((n==null?void 0:n.amount.toString())===""?"0":(x=n==null?void 0:n.amount)==null?void 0:x.toString().replace(/,/g,"")).toString()}]}:l={originCardId:e,destinationCards:n==null?void 0:n.map(i=>{var d,o,s,m;return{cardId:(o=(d=i==null?void 0:i.card)==null?void 0:d.value)==null?void 0:o.toString(),concept:(s=i==null?void 0:i.concept)==null?void 0:s.toString(),amount:parseFloat((i==null?void 0:i.amount.toString())===""?"0":(m=i==null?void 0:i.amount)==null?void 0:m.toString().replace(/,/g,"")).toString()}})},{cardId:l==null?void 0:l.originCardId,data:Q(l)}},$=(e={})=>{const n=v(),h=A(_,e);return{...h,transaction:async(u,g)=>{const{onSuccess:x,onError:i,mutationOptions:d}=g;try{await b.promise(h.mutateAsync(u,d),{pending:"Procesando Transferencia ...",success:{render({data:o}){return n.fetchQuery([S.TRANSIT_BALANCE]),n.invalidateQueries([S.CARD_INFO,o==null?void 0:o.cardId]),n.fetchQuery([S.CARD_MOVEMENTS,o==null?void 0:o.cardId]),n.fetchQuery([S.MAIN_CARD]),x(o),"Se realizo la transferencia con éxito"}}})}catch(o){const s=E(o,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");i(s),b.error(s,{type:R(o)})}}}},C=M(T)(({theme:e})=>({"& td":{paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5)}})),H=({data:e,onBack:n,setTransactionLoading:h,transactionLoading:l,onClose:u})=>{const{transaction:g,isLoading:x}=$(),i=I.useMemo(()=>(e!=null&&e.isGlobal?[e==null?void 0:e.transactions]:e==null?void 0:e.transactions)||[],[e]),d=I.useMemo(()=>(parseFloat(e==null?void 0:e.balance)-(e==null?void 0:e.currentBalance)).toFixed(2)||0,[e]),o=()=>{const{cardOriginId:s,transactions:m,isGlobal:j}=e,y=Y(s,m,j);h(!0),g(y,{onSuccess:()=>{u()},onError:()=>{h(!1)}})};return r.jsxs(r.Fragment,{children:[r.jsx(F,{children:r.jsx(L,{sx:{minWidth:200},children:r.jsxs(W,{children:[r.jsx(D,{sx:{borderBottom:s=>`solid 1px ${s.palette.divider}`},children:r.jsxs(T,{children:[r.jsx(c,{width:40,children:"#"}),r.jsx(c,{align:"left",children:"Descripción"}),r.jsx(c,{align:"right",children:"Total"})]})}),r.jsxs(G,{children:[i==null?void 0:i.map((s,m)=>{var j;return r.jsxs(T,{sx:{borderBottom:y=>`solid 1px ${y.palette.divider}`},children:[r.jsx(c,{children:m+1}),r.jsx(c,{align:"left",children:r.jsxs(f,{sx:{maxWidth:200},children:[r.jsx(p,{variant:"subtitle2",children:((j=s==null?void 0:s.card)==null?void 0:j.cardUserNumber)||"Cuenta Global"}),r.jsx(p,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:s==null?void 0:s.concept})]})}),r.jsx(c,{align:"right",children:a(s==null?void 0:s.amount)})]},m)}),r.jsxs(C,{children:[r.jsx(c,{colSpan:1}),r.jsxs(c,{align:"right",children:[r.jsx(f,{sx:{mt:2}}),r.jsx(p,{children:"Saldo"})]}),r.jsxs(c,{align:"right",width:120,children:[r.jsx(f,{sx:{mt:2}}),r.jsx(p,{children:a(e==null?void 0:e.balance)})]})]}),r.jsxs(C,{children:[r.jsx(c,{colSpan:1}),r.jsx(c,{align:"right",children:r.jsx(p,{children:"Transacciones"})}),r.jsx(c,{align:"right",width:120,children:r.jsx(p,{sx:{color:"error.main"},children:a(-(e==null?void 0:e.currentBalance))})})]}),r.jsxs(C,{children:[r.jsx(c,{colSpan:1}),r.jsx(c,{align:"right",children:r.jsx(p,{variant:"h6",children:"Total"})}),r.jsx(c,{align:"right",width:140,children:r.jsx(p,{variant:"h6",children:a(d)})})]})]})]})})}),r.jsxs(N,{sx:{p:3},spacing:3,children:[r.jsx(k,{onClick:o,loading:x||l,variant:"contained",color:"primary",fullWidth:!0,type:"submit",startIcon:r.jsx(z,{}),children:"Enviar"}),(!x||!l)&&r.jsx(O,{onClick:n,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:r.jsx(P,{}),children:"Regresar"})]})]})};H.propTypes={data:t.shape({balance:t.any,cardOriginId:t.any,currentBalance:t.any,isGlobal:t.any,transactions:t.any}),onBack:t.any,onClose:t.func,setTransactionLoading:t.func,transactionLoading:t.any};export{H as default};
