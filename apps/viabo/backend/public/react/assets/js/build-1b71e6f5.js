import{z as B,j as e,k as v,a as A,Q as T,g as E,b as M,q as R,r as I,D as N,B as f,T as p,S as k,L as F,p as O,N as t}from"./index-3809032b.js";import{g as Q}from"./build-7637d2c3.js";import{f as a}from"./build-566d20b3.js";import{C as S}from"./build-c7ce8ef2.js";import{t as _}from"./build-78fd7f79.js";import{T as b,k as L,l as W,m as z,n as l,o as D}from"./build-1adb5778.js";import{S as G}from"./build-8adb868c.js";import"./build-4389c83a.js";import"./build-53b11780.js";import"./build-4d4aa58d.js";import"./build-8fbeaa5d.js";import"./build-2b227f05.js";import"./build-c6f78c0d.js";import"./build-6fc59234.js";import"./build-627f2440.js";import"./build-5af041c1.js";import"./build-b0677c31.js";import"./build-46916aa3.js";import"./build-381d8d7c.js";import"./build-f831d8b4.js";const P=B(e.jsx("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos"),$=(r,n,m)=>{var u,g,x;let c;return m?c={originCardId:r,destinationCards:[{cardId:(u=n==null?void 0:n.card)==null?void 0:u.value.toString(),concept:(g=n==null?void 0:n.concept)==null?void 0:g.toString(),amount:parseFloat((n==null?void 0:n.amount.toString())===""?"0":(x=n==null?void 0:n.amount)==null?void 0:x.toString().replace(/,/g,"")).toString()}]}:c={originCardId:r,destinationCards:n==null?void 0:n.map(i=>{var d,o,s,h;return{cardId:(o=(d=i==null?void 0:i.card)==null?void 0:d.value)==null?void 0:o.toString(),concept:(s=i==null?void 0:i.concept)==null?void 0:s.toString(),amount:parseFloat((i==null?void 0:i.amount.toString())===""?"0":(h=i==null?void 0:i.amount)==null?void 0:h.toString().replace(/,/g,"")).toString()}})},{cardId:c==null?void 0:c.originCardId,data:Q(c)}},q=(r={})=>{const n=v(),m=A(_,r);return{...m,transaction:async(u,g)=>{const{onSuccess:x,onError:i,mutationOptions:d}=g;try{await T.promise(m.mutateAsync(u,d),{pending:"Procesando Transferencia ...",success:{render({data:o}){return n.fetchQuery([S.TRANSIT_BALANCE]),n.invalidateQueries([S.CARD_INFO,o==null?void 0:o.cardId]),n.fetchQuery([S.CARD_MOVEMENTS,o==null?void 0:o.cardId]),n.fetchQuery([S.MAIN_CARD]),x(o),"Se realizo la transferencia con éxito"}}})}catch(o){const s=E(o,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");i(s),T.error(s,{type:M(o)})}}}},C=R(b)(({theme:r})=>({"& td":{paddingTop:r.spacing(.5),paddingBottom:r.spacing(.5)}})),H=({data:r,onBack:n,setTransactionLoading:m,transactionLoading:c,onClose:u})=>{const{transaction:g,isLoading:x}=q(),i=I.useMemo(()=>(r!=null&&r.isGlobal?[r==null?void 0:r.transactions]:r==null?void 0:r.transactions)||[],[r]),d=I.useMemo(()=>(parseFloat(r==null?void 0:r.balance)-(r==null?void 0:r.currentBalance)).toFixed(2)||0,[r]),o=()=>{const{cardOriginId:s,transactions:h,isGlobal:j}=r,y=$(s,h,j);m(!0),g(y,{onSuccess:()=>{u()},onError:()=>{m(!1)}})};return e.jsxs(e.Fragment,{children:[e.jsx(N,{children:e.jsx(L,{sx:{minWidth:200},children:e.jsxs(W,{children:[e.jsx(z,{sx:{borderBottom:s=>`solid 1px ${s.palette.divider}`},children:e.jsxs(b,{children:[e.jsx(l,{width:40,children:"#"}),e.jsx(l,{align:"left",children:"Movimiento"}),e.jsx(l,{align:"right",children:"Monto"})]})}),e.jsxs(D,{children:[i==null?void 0:i.map((s,h)=>{var j;return e.jsxs(b,{sx:{borderBottom:y=>`solid 1px ${y.palette.divider}`},children:[e.jsx(l,{children:h+1}),e.jsx(l,{align:"left",children:e.jsxs(f,{sx:{maxWidth:200},children:[e.jsx(p,{variant:"subtitle2",children:((j=s==null?void 0:s.card)==null?void 0:j.cardUserNumber)||"Cuenta Global"}),e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:s==null?void 0:s.concept})]})}),e.jsx(l,{align:"right",children:a(s==null?void 0:s.amount)})]},h)}),e.jsxs(C,{children:[e.jsx(l,{colSpan:1}),e.jsxs(l,{align:"right",children:[e.jsx(f,{sx:{mt:2}}),e.jsx(p,{children:"Saldo"})]}),e.jsxs(l,{align:"right",width:120,children:[e.jsx(f,{sx:{mt:2}}),e.jsx(p,{children:a(r==null?void 0:r.balance)})]})]}),e.jsxs(C,{children:[e.jsx(l,{colSpan:1}),e.jsx(l,{align:"right",children:e.jsx(p,{children:"Transacciones"})}),e.jsx(l,{align:"right",width:120,children:e.jsx(p,{sx:{color:"error.main"},children:a(-(r==null?void 0:r.currentBalance))})})]}),e.jsxs(C,{children:[e.jsx(l,{colSpan:1}),e.jsx(l,{align:"right",children:e.jsx(p,{variant:"h6",children:"Total"})}),e.jsx(l,{align:"right",width:140,children:e.jsx(p,{variant:"h6",children:a(d)})})]})]})]})})}),e.jsxs(k,{sx:{p:3},spacing:3,children:[e.jsx(F,{onClick:o,loading:x||c,variant:"contained",color:"primary",fullWidth:!0,type:"submit",startIcon:e.jsx(G,{}),children:"Enviar"}),(!x||!c)&&e.jsx(O,{onClick:n,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(P,{}),children:"Regresar"})]})]})};H.propTypes={data:t.shape({balance:t.any,cardOriginId:t.any,currentBalance:t.any,isGlobal:t.any,transactions:t.any}),onBack:t.any,onClose:t.func,setTransactionLoading:t.func,transactionLoading:t.any};export{H as default};
