import{r as h,i as e,S as i,T as P,Q as C,bx as O,B as R,X as k,bT as X,aX as G,I as Q,d$ as U,bE as W}from"./vendor-CEMfbhOc.js";import{S as Z,a9 as B,aa as $}from"./index-BxvL1HP2.js";import{u as H,d as J,g as K}from"./formik.esm-Dshy1xjd.js";import{c as f,d as Y,a as _}from"./index.esm-C2GVbld4.js";import{F as ee,R as q,M as re}from"./TextMaxLine-iGSgfpVZ.js";import{R as se}from"./RFSelect-B2dtP2ya.js";import"./formatTime-mlJJpQBT.js";import"./matchTypes-BFKCRNnN.js";import"./UploadSingleFile-CP5cFJ4A.js";import"./fade-CViozI82.js";import"./transition-anLY3gj9.js";import"./formatNumber-Df8NwpjV.js";const fe=({accounts:z,setCurrentBalance:D,insufficient:b,onSuccess:T,initialValues:v})=>{const j=h.useRef(null),E=window.crypto||window.msCrypto,M=new Uint32Array(1),g=E.getRandomValues(M)[0],[c,w]=h.useState(z),V=f().shape({transactions:Y().of(f().shape({amount:_().test("maxAmount","Monto m√°ximo de transferencia $50,000",function(o){return parseFloat(o==null?void 0:o.replace(/,/g,""))<=5e4}).required("La cantidad es requerida"),account:f().nullable().required("La cuenta es requerida")}))}),S=H({initialValues:v||{transactions:[{id:g,account:null,amount:""}],concept:""},validateOnChange:!1,validationSchema:V,onSubmit:o=>b?F(!1):(F(!1),T(o))}),{isSubmitting:N,setFieldValue:A,values:u,setSubmitting:F,errors:L,touched:te}=S,x=N;return h.useEffect(()=>{var l;const n=((l=u.transactions)==null?void 0:l.reduce((d,p)=>{const m=p.amount.trim()!==""?parseFloat(p.amount.replace(/,/g,"")):0;return isNaN(m)?d:d+m},0)).toFixed(2);D(n)},[u.transactions]),e.jsxs(e.Fragment,{children:[e.jsxs(i,{p:3,pb:0,gap:1,flexDirection:{xs:"column-reverse",md:"row"},alignItems:"center",children:[e.jsx(P,{variant:"subtitle1",sx:{color:"text.disabled"},children:"Transacciones:"}),e.jsx(i,{spacing:2,justifyContent:"flex-end",direction:{xs:"column",md:"row"},sx:{width:1}}),e.jsx(i,{direction:"row",spacing:1,children:e.jsx(C,{type:"button",size:"small",variant:"outlined",startIcon:e.jsx(O,{}),disabled:x,onClick:()=>j.current.push({id:g,account:null,amount:"",concept:""}),sx:{flexShrink:0},children:"Agregar"})})]}),e.jsx(Z,{containerProps:{sx:{flexGrow:0,height:"auto"}},children:e.jsx(ee,{formik:S,children:e.jsxs(R,{sx:{p:3},children:[e.jsx(J,{name:"transactions",render:o=>(j.current=o,e.jsx(i,{divider:e.jsx(k,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:u==null?void 0:u.transactions.map((n,l)=>{const d=`transactions[${l}].account`,p=K(L,d),m=`transactions[${l}].amount`;return e.jsx(i,{alignItems:"flex-end",spacing:1.5,children:e.jsxs(i,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:1},alignItems:"flex-start",children:[e.jsx(P,{variant:"overline",color:"text.disabled",children:l+1}),e.jsx(se,{name:d,disabled:x,textFieldParams:{placeholder:"Seleccionar ...",label:"Cuentas",required:!0,size:"small"},options:c||[],onChange:(s,r)=>{const t=c==null?void 0:c.map(a=>{var I,y;return!(r!=null&&r.value)&&a.value===((I=n==null?void 0:n.account)==null?void 0:I.value)?{...a,isDisabled:!1}:a.value===(r==null?void 0:r.value)?{...a,isDisabled:!0}:a.value===((y=n==null?void 0:n.account)==null?void 0:y.value)?{...a,isDisabled:!1}:a});w(t),A(d,r)},renderOption:(s,r)=>{const t=B(r==null?void 0:r.label);return e.jsx(R,{component:"li",...s,children:e.jsxs(i,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx($,{src:r.label!==""?r.label:"",alt:r.label,color:t==null?void 0:t.color,sx:{width:25,height:25,fontSize:12},children:t==null?void 0:t.name}),e.jsx("span",{children:r.label})]})})},renderInput:s=>{var t,a;const r=B(((t=s==null?void 0:s.inputProps)==null?void 0:t.value)||"");return e.jsx(X,{...s,size:"small",placeholder:"Seleccionar ...",label:"Beneficiario",inputProps:{...s.inputProps},error:!!p,helperText:p||"",required:!0,InputProps:{...s.InputProps,startAdornment:e.jsx(G,{position:"start",children:e.jsx($,{src:"",alt:((a=s.inputProps)==null?void 0:a.value)||"avatar",color:r==null?void 0:r.color,sx:{width:25,height:25,fontSize:12},children:(r==null?void 0:r.name)!=="undefined"?r==null?void 0:r.name:null})})}})},sx:{width:{xs:1,lg:.6}}}),e.jsx(q,{sx:{width:{xs:1,lg:.4}},size:"small",name:m,required:!0,label:"Monto",placeholder:"0.00",disabled:x,autoComplete:"off",InputProps:{startAdornment:e.jsx("span",{style:{marginRight:"5px"},children:"$"}),inputComponent:re,inputProps:{mask:Number,radix:".",thousandsSeparator:",",padFractionalZeros:!0,min:0,scale:2,value:n.amount,onAccept:s=>{A(m,s)}}}}),l!==0&&e.jsx(Q,{size:"small",color:"error",title:"Borrar",disabled:x,onClick:()=>{const s=c==null?void 0:c.map(r=>{var t;return r.value===((t=n==null?void 0:n.account)==null?void 0:t.value)?{...r,isDisabled:!1}:r});w(s),o.remove(l)},children:e.jsx(U,{})})]})},n.id)})}))}),e.jsx(k,{sx:{my:3,borderStyle:"dashed"}}),e.jsx(i,{sx:{width:1},children:e.jsx(q,{name:"concept",multiline:!0,disabled:x,rows:2,label:"Concepto",placeholder:"Transferencia .."})}),e.jsx(i,{sx:{pt:3},children:e.jsx(C,{variant:"outlined",color:"primary",disabled:b,fullWidth:!0,type:"submit",startIcon:e.jsx(W,{}),children:"Siguiente"})})]})})})]})};export{fe as default};
//# sourceMappingURL=SpeiOutForm-B56bWJxs.js.map
