import{c as R,f as E,U as B,s as M,bv as T,r as f,i as e,bs as N,bt as F,bu as O,bw as o,bx as P,B as Q,T as x,S as I,Q as W,K as _,e1 as k,P as c}from"./vendor-B39b6gT1.js";import{O as D,g as z,b as G,S as L}from"./index-Kl2QvVyT.js";import{f as y}from"./formatNumber-Byfz8vD2.js";import{t as K,C as b}from"./useToggleStatusCard-D24kf7Oa.js";import{g as U}from"./cardTypes-Dv_vUqe3.js";import"./cardsAdapter-jvJTR5hj.js";import"./formatTime-DnNoLFDr.js";import"./matchTypes-E5vQDj-t.js";import"./cardMovementsAdapter-BwF5c2zj.js";import"./AmexLogo-CYfYyhsT.js";import"./CarnetLogo-CXbiBg5q.js";import"./MasterCardLogo-VWsSONZB.js";import"./VisaLogo-DxnifGLv.js";const $=(r,i,t,g)=>{var m,p;let d;return g?d={originCardId:r,destinationCards:[{cardId:(m=i==null?void 0:i.card)==null?void 0:m.value.toString(),concept:(t==null?void 0:t.toString())||"",amount:parseFloat((i==null?void 0:i.amount.toString())===""?"0":(p=i==null?void 0:i.amount)==null?void 0:p.toString().replace(/,/g,"")).toString()}]}:d={originCardId:r,destinationCards:i==null?void 0:i.map(n=>{var u,s,h;return{cardId:(s=(u=n==null?void 0:n.card)==null?void 0:u.value)==null?void 0:s.toString(),concept:(t==null?void 0:t.toString())||"",amount:parseFloat((n==null?void 0:n.amount.toString())===""?"0":(h=n==null?void 0:n.amount)==null?void 0:h.toString().replace(/,/g,"")).toString()}})},{cardId:d==null?void 0:d.originCardId,data:D(d)}},H=(r={})=>{const i=R(),t=E(K,r);return{...t,transaction:async(d,m)=>{const{onSuccess:p,onError:n,mutationOptions:u}=m;try{await B.promise(t.mutateAsync(d,u),{pending:"Procesando Transferencia ...",success:{render({data:s}){return i.fetchQuery([b.TRANSIT_BALANCE]),i.invalidateQueries([b.CARD_INFO,s==null?void 0:s.cardId]),i.fetchQuery([b.CARD_MOVEMENTS,s==null?void 0:s.cardId]),i.fetchQuery([b.MAIN_CARD]),p(s),"Se realizo la transferencia con éxito"}}})}catch(s){const h=z(s,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");n(h),B.error(h,{type:G(s)})}}}},C=M(T)(({theme:r})=>({"& td":{paddingTop:r.spacing(.5),paddingBottom:r.spacing(.5)}})),V=({data:r,onBack:i,setTransactionLoading:t,transactionLoading:g,onClose:d})=>{const{transaction:m,isLoading:p}=H(),n=f.useMemo(()=>(r!=null&&r.isGlobal?[r==null?void 0:r.transactions]:r==null?void 0:r.transactions)||[],[r]),u=f.useMemo(()=>(parseFloat(r==null?void 0:r.balance)-(r==null?void 0:r.currentBalance)).toFixed(2)||0,[r]),s=()=>{const{cardOriginId:l,transactions:a,isGlobal:j,concept:S}=r,A=$(l,a,S,j);t(!0),m(A,{onSuccess:()=>{d()},onError:()=>{t(!1)}})},h=f.useMemo(()=>U(r==null?void 0:r.paymentProcessor),[r]),v=h==null?void 0:h.component;return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsx(N,{sx:{minWidth:200},children:e.jsxs(F,{children:[e.jsx(O,{sx:{borderBottom:l=>`solid 1px ${l.palette.divider}`},children:e.jsxs(T,{children:[e.jsx(o,{width:40,children:"#"}),e.jsx(o,{align:"left",children:"Movimiento"}),e.jsx(o,{align:"right",children:"Monto"})]})}),e.jsxs(P,{children:[n==null?void 0:n.map((l,a)=>{var j;return e.jsxs(T,{sx:{borderBottom:S=>`solid 1px ${S.palette.divider}`},children:[e.jsx(o,{children:a+1}),e.jsx(o,{align:"left",children:e.jsxs(Q,{sx:{maxWidth:200},children:[e.jsx(x,{variant:"subtitle2",children:((j=l==null?void 0:l.card)==null?void 0:j.cardUserNumber)||"Cuenta Global"}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:l==null?void 0:l.concept})]})}),e.jsx(o,{align:"right",children:y(l==null?void 0:l.amount)})]},a)}),e.jsxs(C,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsxs(I,{flexDirection:"row",gap:1,alignItems:"center",justifyContent:"flex-end",children:[e.jsx(x,{children:"Saldo Disponible"}),h&&e.jsx(v,{sx:{width:30,height:30}})]})}),e.jsx(o,{align:"right",width:120,children:e.jsx(x,{children:y(r==null?void 0:r.balance)})})]}),e.jsxs(C,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsx(x,{variant:"h6",children:"Total a dispersar"})}),e.jsx(o,{align:"right",width:120,children:e.jsx(x,{variant:"h6",sx:{color:"error.main"},children:y(-(r==null?void 0:r.currentBalance))})})]}),e.jsxs(C,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsx(x,{children:"Total después de movimiento"})}),e.jsx(o,{align:"right",width:140,children:e.jsx(x,{children:y(u)})})]})]})]})})}),e.jsxs(I,{sx:{p:3},spacing:3,children:[e.jsx(W,{size:"large",onClick:s,loading:p||g,variant:"contained",color:"primary",fullWidth:!0,type:"submit",sx:{fontWeight:"bold"},children:"Realizar"}),(!p||!g)&&e.jsx(_,{onClick:i,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(k,{}),children:"Regresar"})]})]})};V.propTypes={data:c.shape({balance:c.any,cardOriginId:c.any,paymentProcessor:c.any,currentBalance:c.any,isGlobal:c.any,transactions:c.any,concept:c.any}),onBack:c.any,onClose:c.func,setTransactionLoading:c.func,transactionLoading:c.any};export{V as default};
//# sourceMappingURL=ResumeTransactionForm-DSoTUl0q.js.map
