{"version":3,"file":"SpeiOutResume-XA_G077q.js","sources":["../../../../../frontend/src/app/business/viabo-spei/shared/adapters/viabo-spei-out-adapter.js","../../../../../frontend/src/app/business/viabo-spei/shared/hooks/useCreateSpeiOut.js","../../../../../frontend/src/app/business/viabo-spei/dashboard/admin-stp/components/spei-out/SpeiOutResume.jsx"],"sourcesContent":["import { getCryptInfo } from '@/shared/utils'\r\n\r\nexport const ViaboSpeiOutAdapter = (transactions, concept, googleCode) => {\r\n  const adaptedData = {\r\n    externalAccounts: transactions?.map(transaction => ({\r\n      id: transaction?.account?.id?.toString(),\r\n      amount: parseFloat(\r\n        transaction?.amount.toString() === '' ? '0' : transaction?.amount?.toString().replace(/,/g, '')\r\n      )\r\n    })),\r\n    concept: concept?.toString() || '',\r\n    googleAuthenticatorCode: googleCode?.toString() || ''\r\n  }\r\n\r\n  return getCryptInfo(adaptedData)\r\n}\r\n","import { useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { toast } from 'react-toastify'\r\n\r\nimport { VIABO_SPEI_SHARED_KEYS } from '../adapters'\r\nimport { createSpeiOut } from '../services'\r\n\r\nimport { getErrorAPI, getNotificationTypeByErrorCode } from '@/shared/interceptors'\r\nimport { isFunction } from '@/shared/utils'\r\n\r\nexport const useCreateSpeiOut = (options = {}) => {\r\n  const client = useQueryClient()\r\n  const transactions = useMutation(createSpeiOut, options)\r\n  const mutate = async (formData, options) => {\r\n    const { onSuccess, onError, mutationOptions } = options\r\n\r\n    try {\r\n      const data = await toast.promise(transactions.mutateAsync(formData, mutationOptions), {\r\n        pending: 'Enviando Transacciones ...'\r\n      })\r\n      client.invalidateQueries([VIABO_SPEI_SHARED_KEYS.ACCOUNT_INFO])\r\n      client.invalidateQueries([VIABO_SPEI_SHARED_KEYS.BALANCE_RESUME])\r\n      client.invalidateQueries([VIABO_SPEI_SHARED_KEYS.MOVEMENTS])\r\n      isFunction(onSuccess) && onSuccess(data)\r\n    } catch (error) {\r\n      const errorFormatted = getErrorAPI(\r\n        error,\r\n        `No se puede realizar esta operaciÃ³n en este momento. Intente nuevamente o reporte a sistemas`\r\n      )\r\n      isFunction(onError) && onError(errorFormatted)\r\n      toast.error(errorFormatted, {\r\n        type: getNotificationTypeByErrorCode(error)\r\n      })\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...transactions,\r\n    mutate\r\n  }\r\n}\r\n","import { useMemo, useState } from 'react'\r\n\r\nimport PropTypes from 'prop-types'\r\n\r\nimport { ArrowBackIos, GppGoodTwoTone, Lock } from '@mui/icons-material'\r\nimport {\r\n  Box,\r\n  InputAdornment,\r\n  Stack,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  TextField,\r\n  Typography,\r\n  styled\r\n} from '@mui/material'\r\n\r\nimport { ViaboSpeiOutAdapter } from '@/app/business/viabo-spei/shared/adapters'\r\nimport { ButtonViaboSpei, LoadingButtonViaboSpei } from '@/app/business/viabo-spei/shared/components'\r\nimport { useCreateSpeiOut } from '@/app/business/viabo-spei/shared/hooks'\r\nimport { Scrollbar } from '@/shared/components/scroll'\r\nimport { fCurrency } from '@/shared/utils'\r\n\r\nconst RowResultStyle = styled(TableRow)(({ theme }) => ({\r\n  '& td': {\r\n    paddingTop: theme.spacing(0.5),\r\n    paddingBottom: theme.spacing(0.5)\r\n  }\r\n}))\r\n\r\nconst SpeiOutResume = ({ data, onBack, setTransactionLoading, transactionLoading, onSuccess }) => {\r\n  const { mutate, isLoading: isSending } = useCreateSpeiOut()\r\n  const transactions = useMemo(() => data?.transactions || [], [data])\r\n  const total = useMemo(() => (parseFloat(data?.balance) - data?.currentBalance).toFixed(2) || 0, [data])\r\n  const [googleCode, setGoogleCode] = useState('')\r\n\r\n  const handleSubmit = () => {\r\n    const { transactions, concept } = data\r\n\r\n    const dataAdapted = ViaboSpeiOutAdapter(transactions, concept, googleCode)\r\n    setTransactionLoading(true)\r\n    mutate(dataAdapted, {\r\n      onSuccess: data => {\r\n        onSuccess(data)\r\n      },\r\n      onError: () => {\r\n        setTransactionLoading(false)\r\n      }\r\n    })\r\n  }\r\n\r\n  const isLoading = isSending || transactionLoading\r\n\r\n  return (\r\n    <>\r\n      <Scrollbar>\r\n        <TableContainer sx={{ minWidth: 200 }}>\r\n          <Table>\r\n            <TableHead\r\n              sx={{\r\n                borderBottom: theme => `solid 1px ${theme.palette.divider}`\r\n              }}\r\n            >\r\n              <TableRow>\r\n                <TableCell width={40}>#</TableCell>\r\n                <TableCell align=\"left\">Movimiento</TableCell>\r\n                <TableCell align=\"right\">Monto</TableCell>\r\n              </TableRow>\r\n            </TableHead>\r\n\r\n            <TableBody>\r\n              {transactions?.map((row, index) => (\r\n                <TableRow\r\n                  key={index}\r\n                  sx={{\r\n                    borderBottom: theme => `solid 1px ${theme.palette.divider}`\r\n                  }}\r\n                >\r\n                  <TableCell>{index + 1}</TableCell>\r\n                  <TableCell align=\"left\">\r\n                    <Box sx={{ maxWidth: 200 }}>\r\n                      <Typography variant=\"subtitle2\" fontWeight={'bold'}>\r\n                        {row?.account?.alias}\r\n                      </Typography>\r\n                      <Typography variant=\"subtitle2\">{row?.account?.bank?.name}</Typography>\r\n                      <Typography variant=\"subtitle2\">{row?.account?.clabe}</Typography>\r\n                      <Typography variant=\"body2\" sx={{ color: 'text.secondary' }} noWrap>\r\n                        {row?.concept}\r\n                      </Typography>\r\n                    </Box>\r\n                  </TableCell>\r\n                  <TableCell align=\"right\">{fCurrency(row?.amount)}</TableCell>\r\n                </TableRow>\r\n              ))}\r\n\r\n              <RowResultStyle>\r\n                <TableCell colSpan={1} />\r\n                <TableCell align=\"right\">\r\n                  <Stack flexDirection={'row'} gap={1} alignItems={'center'} justifyContent={'flex-end'}>\r\n                    <Typography>Saldo disponible</Typography>\r\n                  </Stack>\r\n                </TableCell>\r\n                <TableCell align=\"right\" width={120}>\r\n                  <Typography>{fCurrency(data?.balance)}</Typography>\r\n                </TableCell>\r\n              </RowResultStyle>\r\n\r\n              <RowResultStyle>\r\n                <TableCell colSpan={1} />\r\n                <TableCell align=\"right\">\r\n                  <Typography variant=\"h6\">Total a dispersar</Typography>\r\n                </TableCell>\r\n                <TableCell align=\"right\" width={120}>\r\n                  <Typography variant=\"h6\" sx={{ color: 'error.main' }}>\r\n                    {fCurrency(-data?.currentBalance)}\r\n                  </Typography>\r\n                </TableCell>\r\n              </RowResultStyle>\r\n\r\n              <RowResultStyle>\r\n                <TableCell colSpan={1} />\r\n                <TableCell align=\"right\">\r\n                  <Typography>Saldo actualizado</Typography>\r\n                </TableCell>\r\n                <TableCell align=\"right\" width={140}>\r\n                  <Typography>{fCurrency(total)}</Typography>\r\n                </TableCell>\r\n              </RowResultStyle>\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n        <Stack spacing={1} p={3} justifyContent={'flex-end'} alignItems={'flex-end'}>\r\n          <Typography paragraph variant=\"overline\" sx={{ color: 'text.disabled' }}>\r\n            Token de Google{' '}\r\n            <Box component={'span'} color={'error.main'}>\r\n              *\r\n            </Box>\r\n          </Typography>\r\n          <TextField\r\n            name={'googleCode'}\r\n            type={'number'}\r\n            size={'small'}\r\n            placeholder={'000000'}\r\n            required\r\n            value={googleCode}\r\n            onChange={e => setGoogleCode(e?.target?.value)}\r\n            inputProps={{ pattern: '/^-?d+.?d*$/', min: '1' }}\r\n            InputProps={{\r\n              startAdornment: (\r\n                <InputAdornment position=\"start\">\r\n                  <Lock />\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            disabled={isLoading}\r\n          />\r\n        </Stack>\r\n      </Scrollbar>\r\n      <Stack direction={{ md: 'row-reverse' }} sx={{ p: 3 }} gap={3}>\r\n        <LoadingButtonViaboSpei\r\n          size={'large'}\r\n          onClick={handleSubmit}\r\n          endIcon={<GppGoodTwoTone />}\r\n          loading={isLoading}\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          fullWidth\r\n          type=\"submit\"\r\n          disabled={!googleCode}\r\n          sx={{ fontWeight: 'bold' }}\r\n        >\r\n          Enviar\r\n        </LoadingButtonViaboSpei>\r\n\r\n        {!isLoading && (\r\n          <ButtonViaboSpei\r\n            size={'large'}\r\n            onClick={onBack}\r\n            variant=\"outlined\"\r\n            color=\"inherit\"\r\n            fullWidth\r\n            startIcon={<ArrowBackIos />}\r\n          >\r\n            Regresar\r\n          </ButtonViaboSpei>\r\n        )}\r\n      </Stack>\r\n    </>\r\n  )\r\n}\r\n\r\nSpeiOutResume.propTypes = {\r\n  data: PropTypes.shape({\r\n    balance: PropTypes.any,\r\n    currentBalance: PropTypes.any,\r\n    concept: PropTypes.any,\r\n    transactions: PropTypes.array\r\n  }),\r\n  onBack: PropTypes.func,\r\n  onSuccess: PropTypes.func,\r\n  setTransactionLoading: PropTypes.func,\r\n  transactionLoading: PropTypes.any\r\n}\r\n\r\nexport default SpeiOutResume\r\n"],"names":["ViaboSpeiOutAdapter","transactions","concept","googleCode","adaptedData","transaction","_b","_a","_c","getCryptInfo","useCreateSpeiOut","options","client","useQueryClient","useMutation","createSpeiOut","formData","onSuccess","onError","mutationOptions","data","toast","VIABO_SPEI_SHARED_KEYS","isFunction","error","errorFormatted","getErrorAPI","getNotificationTypeByErrorCode","RowResultStyle","styled","TableRow","theme","paddingTop","spacing","paddingBottom","SpeiOutResume","onBack","setTransactionLoading","transactionLoading","mutate","isLoading","isSending","useMemo","total","parseFloat","balance","currentBalance","toFixed","setGoogleCode","useState","handleSubmit","dataAdapted","jsxs","Fragment","Scrollbar","jsx","TableContainer","minWidth","Table","TableHead","borderBottom","palette","divider","TableCell","TableBody","map","row","index","Box","maxWidth","Typography","account","alias","bank","name","clabe","color","fCurrency","amount","Stack","TextField","e","target","value","pattern","min","startAdornment","InputAdornment","Lock","md","p","LoadingButtonViaboSpei","GppGoodTwoTone","fontWeight","ButtonViaboSpei","ArrowBackIos","propTypes","PropTypes","shape","any","array","func"],"mappings":"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"}