import{r as h,i as e,V as i,T as P,O as C,bv as L,B as R,X as k,bu as X,aX as G,I as Q,dQ as U,bE as W}from"./vendor-VdGvLetj.js";import{S as Z,a5 as B,a6 as q}from"./index-W5_PJt9d.js";import{u as H,d as J,g as K}from"./formik.esm-qswtkH0w.js";import{c as f,d as Y,a as _}from"./index.esm-tihgvVDv.js";import{F as ee,R as z,M as re}from"./TextMaxLine-WruMZtAJ.js";import{R as se}from"./RFSelect-DkgJojm8.js";import"./UploadSingleFile-6LMGjDBZ.js";import"./fade-HpdRXKiE.js";import"./transition-Uc7vb3zK.js";import"./formatNumber-v_3o-PH6.js";const me=({accounts:D,setCurrentBalance:$,insufficient:b,onSuccess:v,initialValues:T})=>{const j=h.useRef(null),V=window.crypto||window.msCrypto,E=new Uint32Array(1),g=V.getRandomValues(E)[0],[c,w]=h.useState(D),M=f().shape({transactions:Y().of(f().shape({amount:_().test("maxAmount","Monto m√°ximo de transferencia $50,000",function(o){return parseFloat(o==null?void 0:o.replace(/,/g,""))<=5e4}).required("La cantidad es requerida"),account:f().nullable().required("La cuenta es requerida")}))}),A=H({initialValues:T||{transactions:[{id:g,account:null,amount:""}],concept:""},validateOnChange:!1,validationSchema:M,onSubmit:o=>b?S(!1):(S(!1),v(o))}),{isSubmitting:N,setFieldValue:F,values:u,setSubmitting:S,errors:O,touched:te}=A,x=N;return h.useEffect(()=>{var l;const n=((l=u.transactions)==null?void 0:l.reduce((d,p)=>{const m=p.amount.trim()!==""?parseFloat(p.amount.replace(/,/g,"")):0;return isNaN(m)?d:d+m},0)).toFixed(2);$(n)},[u.transactions]),e.jsxs(e.Fragment,{children:[e.jsxs(i,{p:3,pb:0,gap:1,flexDirection:{xs:"column-reverse",md:"row"},alignItems:"center",children:[e.jsx(P,{variant:"subtitle1",sx:{color:"text.disabled"},children:"Transacciones:"}),e.jsx(i,{spacing:2,justifyContent:"flex-end",direction:{xs:"column",md:"row"},sx:{width:1}}),e.jsx(i,{direction:"row",spacing:1,children:e.jsx(C,{type:"button",size:"small",variant:"outlined",startIcon:e.jsx(L,{}),disabled:x,onClick:()=>j.current.push({id:g,account:null,amount:"",concept:""}),sx:{flexShrink:0},children:"Agregar"})})]}),e.jsx(Z,{containerProps:{sx:{flexGrow:0,height:"auto"}},children:e.jsx(ee,{formik:A,children:e.jsxs(R,{sx:{p:3},children:[e.jsx(J,{name:"transactions",render:o=>(j.current=o,e.jsx(i,{divider:e.jsx(k,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:u==null?void 0:u.transactions.map((n,l)=>{const d=`transactions[${l}].account`,p=K(O,d),m=`transactions[${l}].amount`;return e.jsx(i,{alignItems:"flex-end",spacing:1.5,children:e.jsxs(i,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:1},alignItems:"flex-start",children:[e.jsx(P,{variant:"overline",color:"text.disabled",children:l+1}),e.jsx(se,{name:d,disabled:x,textFieldParams:{placeholder:"Seleccionar ...",label:"Cuentas",required:!0,size:"small"},options:c||[],onChange:(s,r)=>{const t=c==null?void 0:c.map(a=>{var I,y;return!(r!=null&&r.value)&&a.value===((I=n==null?void 0:n.account)==null?void 0:I.value)?{...a,isDisabled:!1}:a.value===(r==null?void 0:r.value)?{...a,isDisabled:!0}:a.value===((y=n==null?void 0:n.account)==null?void 0:y.value)?{...a,isDisabled:!1}:a});w(t),F(d,r)},renderOption:(s,r)=>{const t=B(r==null?void 0:r.label);return e.jsx(R,{component:"li",...s,children:e.jsxs(i,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(q,{src:r.label!==""?r.label:"",alt:r.label,color:t==null?void 0:t.color,sx:{width:25,height:25,fontSize:12},children:t==null?void 0:t.name}),e.jsx("span",{children:r.label})]})})},renderInput:s=>{var t,a;const r=B(((t=s==null?void 0:s.inputProps)==null?void 0:t.value)||"");return e.jsx(X,{...s,size:"small",placeholder:"Seleccionar ...",label:"Beneficiario",inputProps:{...s.inputProps},error:!!p,helperText:p||"",required:!0,InputProps:{...s.InputProps,startAdornment:e.jsx(G,{position:"start",children:e.jsx(q,{src:"",alt:((a=s.inputProps)==null?void 0:a.value)||"avatar",color:r==null?void 0:r.color,sx:{width:25,height:25,fontSize:12},children:(r==null?void 0:r.name)!=="undefined"?r==null?void 0:r.name:null})})}})},sx:{width:{xs:1,lg:.6}}}),e.jsx(z,{sx:{width:{xs:1,lg:.4}},size:"small",name:m,required:!0,label:"Monto",placeholder:"0.00",disabled:x,autoComplete:"off",InputProps:{startAdornment:e.jsx("span",{style:{marginRight:"5px"},children:"$"}),inputComponent:re,inputProps:{mask:Number,radix:".",thousandsSeparator:",",padFractionalZeros:!0,min:0,scale:2,value:n.amount,onAccept:s=>{F(m,s)}}}}),l!==0&&e.jsx(Q,{size:"small",color:"error",title:"Borrar",disabled:x,onClick:()=>{const s=c==null?void 0:c.map(r=>{var t;return r.value===((t=n==null?void 0:n.account)==null?void 0:t.value)?{...r,isDisabled:!1}:r});w(s),o.remove(l)},children:e.jsx(U,{})})]})},n.id)})}))}),e.jsx(k,{sx:{my:3,borderStyle:"dashed"}}),e.jsx(i,{sx:{width:1},children:e.jsx(z,{name:"concept",multiline:!0,disabled:x,rows:2,label:"Concepto",placeholder:"Transferencia .."})}),e.jsx(i,{sx:{pt:3},children:e.jsx(C,{variant:"outlined",color:"primary",disabled:b,fullWidth:!0,type:"submit",startIcon:e.jsx(W,{}),children:"Siguiente"})})]})})})]})};export{me as default};
//# sourceMappingURL=SpeiOutForm-h3wqqhKb.js.map
