import{c as I,f as P,a9 as v,u as _,i as e,V as i,T as l,B as j,b8 as V,dH as M,e0 as z,dZ as C,e1 as S,aY as w,dr as D,dv as L,a0 as q,P as A}from"./vendor-X9cKXa3I.js";import{u as T}from"./formik.esm-drA_7EEr.js";import{c as W,a as n,d as E,f as B}from"./index.esm-87Db4h5o.js";import{g as k,a as O,a2 as $}from"./index-IncEwUKO.js";import{M as d,n as H}from"./ViaboSpeiCompanies-XZYl-B87.js";import{i as U}from"./matchTypes-ev-w7Wi9.js";import{V as Q}from"./viabo-card-zH8OCAbq.js";import{F as Y,R as p,a as G}from"./TextMaxLine-SKcMsBiK.js";import{R as F}from"./RFSelect-FrmrIEQp.js";import"./useViaboSpeiBreadCrumbs-_KtiQNgU.js";import"./index-bT7c8_vF.js";import"./crypto-DLV5sXJi.js";import"./formatNumber-lcHsHzSd.js";import"./HeaderPage-V_w2vjBb.js";import"./fade-HpdRXKiE.js";import"./transition-Uc7vb3zK.js";import"./useMaterialTable-N56kn-M3.js";import"./UploadSingleFile-v78kQPok.js";const Z=r=>{var c,N,h,b,m,u,o,t,x;return{fiscalName:(c=r==null?void 0:r.fiscalName)==null?void 0:c.trim(),rfc:(N=r==null?void 0:r.rfc)==null?void 0:N.trim(),commercialName:(h=r==null?void 0:r.commercialName)==null?void 0:h.trim(),isNewUser:(r==null?void 0:r.method)===d.NEW_ADMIN_USER,assignedUsers:((b=r==null?void 0:r.adminUsers)==null?void 0:b.map(a=>a.value))||[],newUserName:(m=r==null?void 0:r.adminName)==null?void 0:m.trim(),newUserLastName:(u=r==null?void 0:r.adminLastName)==null?void 0:u.trim(),newUserEmail:(o=r==null?void 0:r.adminEmail)==null?void 0:o.trim(),newUserPhone:(t=r==null?void 0:r.adminPhone)==null?void 0:t.trim(),costCenters:((x=r==null?void 0:r.costCenters)==null?void 0:x.map(a=>a.value))||[],hasViaboCard:r==null?void 0:r.hasViaboCard}},J=(r={})=>{I();const c=P(H,r);return{...c,mutate:async(h,b)=>{const{onSuccess:m,onError:u,mutationOptions:o}=b;try{await v.promise(c.mutateAsync(h,o),{pending:"Creando empresa...",success:{render({data:t}){return U(m)&&m(t),"Se creó la empresa con éxito"}}})}catch(t){const x=k(t,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");U(u)&&u(x),v.error(x,{type:O(t)})}}}},K=({adminCompanyUsers:r,onSuccess:c})=>{const{mutate:N,isLoading:h}=J(),b=W().shape({fiscalName:n().trim().required("Es necesario el nombre fiscal"),rfc:n().trim().required("Es necesario el rfc"),commercialName:n().trim().max(100,"Máximo 100 caracteres"),adminUsers:E().when("method",{is:d.ADMIN_USERS,then:s=>s.min(1,"Es necesario al menos un usuario administrador asignado a la empresa"),otherwise:s=>E()}),adminName:n().trim().when("method",{is:d.NEW_ADMIN_USER,then:s=>s.required("Es necesario el nombre del administrador"),otherwise:s=>n().trim()}),adminLastName:n().trim().when("method",{is:d.NEW_ADMIN_USER,then:s=>s.required("Es necesario los apellidos del administrador"),otherwise:s=>n().trim()}),adminEmail:n().trim().email("Ingrese un correo valido").when("method",{is:d.NEW_ADMIN_USER,then:s=>s.required("Es necesario el correo del administrador"),otherwise:s=>n().trim().email("Ingrese un correo valido")}),adminPhone:n().trim(),hasViaboCard:B(),costCenters:E()}),m=T({initialValues:{fiscalName:"",commercialName:"",rfc:"",method:d.ADMIN_USERS,adminUsers:[],costCenters:[],adminName:"",adminLastName:"",adminEmail:"",adminPhone:"",hasViaboCard:!1},enableReinitialize:!0,validationSchema:b,onSubmit:(s,{setSubmitting:f,setFieldValue:X})=>{const R=Z(s);N(R,{onSuccess:()=>{c(),f(!1)},onError:()=>{f(!1)}})}}),{isSubmitting:u,setFieldValue:o,values:t,setTouched:x}=m,a=u||h,g=_();return e.jsx(Y,{formik:m,children:e.jsxs(i,{spacing:2,children:[e.jsxs(i,{spacing:1,children:[e.jsxs(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Nombre Fiscal",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(p,{inputProps:{maxLength:"18"},required:!0,name:"fiscalName",size:"small",disabled:a,placeholder:"Nombre Fiscal de la Empresa..."})]}),e.jsxs(i,{spacing:1,children:[e.jsxs(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["RFC",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(p,{required:!0,name:"rfc",size:"small",placeholder:"RFC de la Empresa...",disabled:a})]}),e.jsxs(i,{spacing:1,children:[e.jsx(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre Comercial"}),e.jsx(p,{name:"commercialName",size:"small",placeholder:"Nombre Comercial de la Empresa...",disabled:a})]}),e.jsx(i,{children:e.jsxs(V,{disabled:a,children:[e.jsx(M,{id:"demo-row-radio-buttons-group-label",children:"Seleccione al administrador de la empresa:"}),e.jsxs(z,{value:t.method,onChange:s=>{o("method",s.target.value),o("adminUsers",[]),o("adminName",""),o("adminLastName",""),o("adminEmail",""),o("adminPhone",""),x({},!1)},row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"row-radio-buttons-group",children:[e.jsx(C,{value:d.ADMIN_USERS,control:e.jsx(S,{}),label:"Administrador de Empresa Existente"}),e.jsx(C,{value:d.NEW_ADMIN_USER,control:e.jsx(S,{}),label:"Nuevo Administrador de Empresa"})]})]})}),t.method===d.ADMIN_USERS?e.jsxs(i,{spacing:1,children:[e.jsxs(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Usuarios Administradores",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(F,{multiple:!0,name:"adminUsers",textFieldParams:{placeholder:"Seleccionar ...",size:"small"},options:r||[],disabled:a})]}):e.jsxs(e.Fragment,{children:[e.jsxs(i,{spacing:1,children:[e.jsxs(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Nombre (s)",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(p,{name:"adminName",size:"small",required:!0,placeholder:"Nombre Administrador de la Empresa...",disabled:a})]}),e.jsxs(i,{spacing:1,children:[e.jsxs(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Apellido (s)",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(p,{name:"adminLastName",size:"small",required:!0,placeholder:"Apellidos del Administrador de la Empresa...",disabled:a})]}),e.jsxs(i,{flexDirection:{md:"row"},gap:2,children:[e.jsxs(i,{spacing:1,flex:1,children:[e.jsxs(l,{type:"email",paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Correo",e.jsx(j,{component:"span",color:"error.main",ml:.5,children:"*"})]}),e.jsx(p,{name:"adminEmail",size:"small",required:!0,placeholder:"admin.company@domino.com...",InputProps:{startAdornment:e.jsx(w,{position:"start",children:e.jsx(D,{})})},disabled:a})]}),e.jsxs(i,{spacing:1,children:[e.jsx(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono"}),e.jsx(p,{name:"adminPhone",type:"tel",size:"small",placeholder:"55 5555 5555",InputProps:{startAdornment:e.jsx(w,{position:"start",children:e.jsx(L,{})})},disabled:a})]})]})]}),e.jsxs(i,{spacing:1,children:[e.jsx(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Centros de Costos"}),e.jsx(F,{multiple:!0,name:"costCenters",textFieldParams:{placeholder:"Seleccionar ...",size:"small"},options:[],disabled:a})]}),e.jsxs(i,{spacing:1,children:[e.jsx(l,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Servicios"}),e.jsxs(i,{justifyContent:"space-between",flexDirection:"row",alignItems:"center",children:[e.jsx($,{disabledEffect:!0,visibleByDefault:!0,alt:"logo",src:Q,sx:{maxWidth:150,width:100,filter:(g==null?void 0:g.palette.mode)==="dark"?"brightness(0) invert(1) grayscale(100%)":"none"}}),e.jsx(G,{disabled:h,size:"md",color:t.hasViaboCard?"success":"error",checked:!!t.hasViaboCard||!1,inputProps:{"aria-label":"controlled"},onChange:()=>{o("hasViaboCard",!t.hasViaboCard)}})]})]}),e.jsx(i,{sx:{pt:1},children:e.jsx(q,{size:"large",loading:a,variant:"contained",color:"primary",fullWidth:!0,type:"submit",children:"Crear"})})]})})};K.propTypes={adminCompanyUsers:A.array,onSuccess:A.func};export{K as default};
//# sourceMappingURL=SpeiNewCompanyForm-f5EQlmQh.js.map
