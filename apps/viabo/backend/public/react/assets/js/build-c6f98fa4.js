import{n as L,an as v,g as M,o as S,P as C,j as e,$ as A,S as o,T as s,L as T,r as P,c_ as N,ay as w,I as q,au as $,ar as F,cm as O}from"./build-7f26f9ca.js";import{d as R,C as _,a as B}from"./build-66f9d360.js";import{u as D}from"./build-1442fb25.js";import{a as U}from"./build-632f8838.js";import{c as X,d as z,a as j}from"./build-38142a14.js";import{c as V,L as W}from"./build-cea9a662.js";import{R as g}from"./build-e1125ef8.js";import{F as G}from"./build-bfec3b8f.js";import{I as f}from"./build-8ee9e1f7.js";import{P as Q}from"./build-08df8bb6.js";import{E as H}from"./build-9ad2dcba.js";import{R as J}from"./build-d0fff932.js";import{f as K}from"./build-fb36d713.js";import"./build-bc7fa3d2.js";import"./build-b2ad78ab.js";import"./build-8cd20c41.js";import"./build-c8196064.js";import"./build-4a7db965.js";import"./build-0b64b4ca.js";import"./build-3c5effeb.js";import"./build-123afd9f.js";import"./build-c6051750.js";import"./build-42e9af7a.js";import"./build-db1b4688.js";import"./build-47ca29a0.js";import"./build-bee6630b.js";import"./build-f7a5a130.js";const Y=(r={})=>{const p=L(V,r);return{...p,mutate:async(c,l)=>{const{onSuccess:m,onError:a,mutationOptions:u}=l;try{await v.promise(p.mutateAsync(c,u),{pending:"generando Liga de Pago ...",success:{render({data:n}){return m(n),"Se creó la liga de pago con éxito"}}})}catch(n){const h=M(n,"No se puede realizar esta operacion en este momento. Intente nuevamente o reporte a sistemas");a(h),v.error(h,{type:S(n)})}}}},Z=r=>({amount:r==null?void 0:r.amount,fullName:r==null?void 0:r.name,email:r==null?void 0:r.email,phone:r==null?void 0:r.phone,message:r==null?void 0:r.concept}),y=1,b=2e4,I=({onSuccess:r})=>{const{mutate:p,isLoading:i}=Y(),c=X({amount:z().min(y,`El monto mínimo es ${y}.00`).max(b,`El monto máximo es ${b}.00`).required("El monto es requerido"),name:j().required("El nombre es requerido"),email:j().email("Ingresa un correo valido").required("El correo es requerido"),phone:j().test("longitud","El telefono es muy corto",t=>!(t&&t.replace(/[\s+]/g,"").length<10)).required("El telefono es requerido")}),l=D({initialValues:{amount:0,name:"",email:"",phone:"",concept:""},validationSchema:c,onSubmit:(t,{setSubmitting:d})=>{const E=Z(t);p(E,{onSuccess:()=>{d(!1),r({id:"123",amount:t.amount})},onError:()=>{d(!1)}})}}),{errors:m,touched:a,isSubmitting:u,setFieldValue:n,values:h}=l,x=u||i,k=t=>{const d=t.target.value===""?"":Number(t.target.value);n("amount",d)};return e.jsx(A,{containerProps:{sx:{flexGrow:0,height:"auto"}},children:e.jsx(G,{formik:l,children:e.jsxs(o,{spacing:3,sx:{p:3},children:[e.jsxs(o,{spacing:1,children:[e.jsx(s,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Monto *"}),e.jsx(g,{fullWidth:!0,placeholder:"$0.00",name:"amount",type:"number",InputProps:{endAdornment:e.jsx(f,{position:"end",children:"MXN"})},onChange:k,InputLabelProps:{shrink:!0},inputProps:{inputMode:"numeric",min:y,max:b}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(s,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre Completo *"}),e.jsx(g,{name:"name",required:!0,placeholder:"Usuario",disabled:x,InputProps:{startAdornment:e.jsx(f,{position:"start",children:e.jsx(Q,{})})}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(s,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Correo Electrónico *"}),e.jsx(g,{name:"email",required:!0,placeholder:"usuario@dominio.com",disabled:x,InputProps:{startAdornment:e.jsx(f,{position:"start",children:e.jsx(H,{})})}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(s,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Telefono *"}),e.jsx(U,{name:"phone",fullWidth:!0,langOfCountryName:"es",preferredCountries:["MX","US"],continents:["NA","SA"],value:h.phone||"+52",disabled:x,onChange:(t,d)=>{n("phone",t)},error:a.phone&&!!m.phone,helperText:a.phone&&m.phone})]}),e.jsxs(o,{spacing:1,children:[e.jsx(s,{m:0,paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Mensaje"}),e.jsx(g,{name:"concept",multiline:!0,disabled:x,rows:2,placeholder:"Pago por .."})]}),e.jsx(o,{sx:{pt:3},children:e.jsx(T,{loading:u,variant:"contained",color:"primary",fullWidth:!0,type:"submit",startIcon:e.jsx(W,{}),children:"Generar"})})]})})})};I.propTypes={onSuccess:C.func};const ee=({open:r,setOpen:p})=>{const[i,c]=P.useState(null),[l,m]=P.useState(!1),a=`${window.location.host}/cobro/${i==null?void 0:i.id}`,u=()=>{p(!1),c(null)};return e.jsx(J,{open:r,handleClose:u,title:"Liga de Pago",onSuccess:n=>{c(n)},children:i?e.jsxs(o,{flexDirection:"column",alignItems:"center",justifyContent:"space-between",spacing:2,p:5,children:[e.jsxs(o,{flexDirection:"column",alignItems:"center",spacing:2,children:[e.jsx(N,{sx:{width:40,height:40},color:"success"}),e.jsx(s,{textAlign:"center",variant:"subtitle2",children:"Comparte la siguiente liga de pago para realizar el cobro por:"}),e.jsxs(o,{direction:"row",spacing:1,alignItems:"center",children:[e.jsxs(s,{variant:"h3",children:[" ",K(i.amount)]}),e.jsx(s,{variant:"caption",children:"MXN"})]})]}),e.jsx(o,{flexDirection:"column",alignItems:"center",justifyContent:"space-between",spacing:0,children:e.jsxs(o,{justifyContent:"center",alignItems:"center",direction:"row",spacing:1,children:[e.jsx(R,{}),e.jsx(w,{href:a,target:"_blank",color:"info.main",children:a}),e.jsx(q,{variant:"outlined",size:"small",color:l?"success":"inherit",onClick:()=>{m(!0),$(a),setTimeout(()=>{m(!1)},1e3)},children:l?e.jsx(_,{sx:{color:"success"}}):e.jsx(B,{sx:{color:"text.disabled"}})})]})}),e.jsx(s,{variant:"caption",color:"text.disabled",children:F(new Date,"dd MMM yyyy hh:mm a",{locale:O})})]}):e.jsx(I,{onSuccess:n=>{c(n)}})})};ee.propTypes={open:C.any,setOpen:C.func};export{ee as default};
