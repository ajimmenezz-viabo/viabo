import{c as R,f as E,a9 as B,s as M,bv as T,r as C,i as e,bs as N,bt as F,bu as O,bw as o,bx as P,B as Q,T as p,V as I,a0 as W,O as _,dO as k,P as c}from"./vendor-_TWOdD6q.js";import{a as D}from"./crypto-4w0xa2KF.js";import{g as z,a as G,S as L}from"./index-E9ArhrQG.js";import{f as y}from"./fade-FopuCQlG.js";import{t as V,C as b}from"./useToggleStatusCard-IUaQZy3U.js";import{g as $}from"./cardTypes-6eBoZWRN.js";import"./transition-Uc7vb3zK.js";import"./cardsAdapter-nCJ0s_c2.js";import"./formatTime-6Hp-6rfJ.js";import"./matchTypes--uN0rjmL.js";import"./cardMovementsAdapter-etfskqLP.js";import"./AmexLogo-Q1iP8idz.js";import"./CarnetLogo-YZnWVrub.js";import"./MasterCardLogo-hSHfVJgz.js";import"./VisaLogo-n7L9rAXg.js";const H=(r,i,t,a)=>{var x,m;let d;return a?d={originCardId:r,destinationCards:[{cardId:(x=i==null?void 0:i.card)==null?void 0:x.value.toString(),concept:(t==null?void 0:t.toString())||"",amount:parseFloat((i==null?void 0:i.amount.toString())===""?"0":(m=i==null?void 0:i.amount)==null?void 0:m.toString().replace(/,/g,"")).toString()}]}:d={originCardId:r,destinationCards:i==null?void 0:i.map(n=>{var u,s,h;return{cardId:(s=(u=n==null?void 0:n.card)==null?void 0:u.value)==null?void 0:s.toString(),concept:(t==null?void 0:t.toString())||"",amount:parseFloat((n==null?void 0:n.amount.toString())===""?"0":(h=n==null?void 0:n.amount)==null?void 0:h.toString().replace(/,/g,"")).toString()}})},{cardId:d==null?void 0:d.originCardId,data:D(d)}},K=(r={})=>{const i=R(),t=E(V,r);return{...t,transaction:async(d,x)=>{const{onSuccess:m,onError:n,mutationOptions:u}=x;try{await B.promise(t.mutateAsync(d,u),{pending:"Procesando Transferencia ...",success:{render({data:s}){return i.fetchQuery([b.TRANSIT_BALANCE]),i.invalidateQueries([b.CARD_INFO,s==null?void 0:s.cardId]),i.fetchQuery([b.CARD_MOVEMENTS,s==null?void 0:s.cardId]),i.fetchQuery([b.MAIN_CARD]),m(s),"Se realizo la transferencia con éxito"}}})}catch(s){const h=z(s,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");n(h),B.error(h,{type:G(s)})}}}},S=M(T)(({theme:r})=>({"& td":{paddingTop:r.spacing(.5),paddingBottom:r.spacing(.5)}})),U=({data:r,onBack:i,setTransactionLoading:t,transactionLoading:a,onClose:d})=>{const{transaction:x,isLoading:m}=K(),n=C.useMemo(()=>(r!=null&&r.isGlobal?[r==null?void 0:r.transactions]:r==null?void 0:r.transactions)||[],[r]),u=C.useMemo(()=>(parseFloat(r==null?void 0:r.balance)-(r==null?void 0:r.currentBalance)).toFixed(2)||0,[r]),s=()=>{const{cardOriginId:l,transactions:g,isGlobal:j,concept:f}=r,A=H(l,g,f,j);t(!0),x(A,{onSuccess:()=>{d()},onError:()=>{t(!1)}})},h=C.useMemo(()=>$(r==null?void 0:r.paymentProcessor),[r]),v=h==null?void 0:h.component;return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsx(N,{sx:{minWidth:200},children:e.jsxs(F,{children:[e.jsx(O,{sx:{borderBottom:l=>`solid 1px ${l.palette.divider}`},children:e.jsxs(T,{children:[e.jsx(o,{width:40,children:"#"}),e.jsx(o,{align:"left",children:"Movimiento"}),e.jsx(o,{align:"right",children:"Monto"})]})}),e.jsxs(P,{children:[n==null?void 0:n.map((l,g)=>{var j;return e.jsxs(T,{sx:{borderBottom:f=>`solid 1px ${f.palette.divider}`},children:[e.jsx(o,{children:g+1}),e.jsx(o,{align:"left",children:e.jsxs(Q,{sx:{maxWidth:200},children:[e.jsx(p,{variant:"subtitle2",children:((j=l==null?void 0:l.card)==null?void 0:j.cardUserNumber)||"Cuenta Global"}),e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:l==null?void 0:l.concept})]})}),e.jsx(o,{align:"right",children:y(l==null?void 0:l.amount)})]},g)}),e.jsxs(S,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsxs(I,{flexDirection:"row",gap:1,alignItems:"center",justifyContent:"flex-end",children:[e.jsx(p,{children:"Saldo Disponible"}),h&&e.jsx(v,{sx:{width:30,height:30}})]})}),e.jsx(o,{align:"right",width:120,children:e.jsx(p,{children:y(r==null?void 0:r.balance)})})]}),e.jsxs(S,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsx(p,{variant:"h6",children:"Total a dispersar"})}),e.jsx(o,{align:"right",width:120,children:e.jsx(p,{variant:"h6",sx:{color:"error.main"},children:y(-(r==null?void 0:r.currentBalance))})})]}),e.jsxs(S,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsx(p,{children:"Total después de movimiento"})}),e.jsx(o,{align:"right",width:140,children:e.jsx(p,{children:y(u)})})]})]})]})})}),e.jsxs(I,{sx:{p:3},spacing:3,children:[e.jsx(W,{size:"large",onClick:s,loading:m||a,variant:"contained",color:"primary",fullWidth:!0,type:"submit",sx:{fontWeight:"bold"},children:"Realizar"}),(!m||!a)&&e.jsx(_,{onClick:i,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(k,{}),children:"Regresar"})]})]})};U.propTypes={data:c.shape({balance:c.any,cardOriginId:c.any,paymentProcessor:c.any,currentBalance:c.any,isGlobal:c.any,transactions:c.any,concept:c.any}),onBack:c.any,onClose:c.func,setTransactionLoading:c.func,transactionLoading:c.any};export{U as default};
//# sourceMappingURL=ResumeTransactionForm-kvuSq_8L.js.map
