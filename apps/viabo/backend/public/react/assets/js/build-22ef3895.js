import{t as C,j as e,av as P,r as p,_ as A,B as j,a7 as L,S as x,R as M,L as w,c as R,ad as k,T as y,a8 as W,Z as $,a9 as U,P as l,ab as Q,a6 as q,af as G,ai as K,aj as Y,a as T,b as Z,g as J,aO as X,l as ee,ak as O,f as se,al as te,am as ne,an as oe}from"./index-2d3a0a13.js";import{A as re}from"./build-de06aa21.js";import{a as ae,A as ie,S as ce,N as de,C as le}from"./build-63df143b.js";import{D as he}from"./build-dd4cc906.js";import{C as pe}from"./build-b76a1f77.js";import{S as xe}from"./build-872076cf.js";import{L as ue,f as fe}from"./build-f07e5e18.js";import{L as je,S as ge,a as ye,b as Se,c as I,d as _}from"./build-c642439e.js";import{E as me,C as be,H as ve}from"./build-2272a72f.js";import"./build-30241498.js";import{I as Ie}from"./build-1e307d2a.js";import{I as Ce}from"./build-4e0deea5.js";import{S as Le}from"./build-1528eb82.js";const z=C(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM8.46 14.45l-1.36-.62c.28-.61.41-1.24.4-1.86-.01-.63-.14-1.24-.4-1.8l1.36-.63c.35.75.53 1.56.54 2.4.01.86-.17 1.7-.54 2.51zm3.07 1.56-1.3-.74c.52-.92.78-1.98.78-3.15 0-1.19-.27-2.33-.8-3.4l1.34-.67c.64 1.28.96 2.65.96 4.07 0 1.43-.33 2.74-.98 3.89zm3.14 1.32-1.35-.66c.78-1.6 1.18-3.18 1.18-4.69 0-1.51-.4-3.07-1.18-4.64l1.34-.67c.9 1.78 1.34 3.56 1.34 5.31 0 1.74-.44 3.54-1.33 5.35z"}),"ContactlessSharp"),Te=C(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}),"Link"),Ee=C(e.jsx("path",{d:"M17 2H7c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 4H7V4h10v2zm3 16H4c-1.1 0-2-.9-2-2v-1h20v1c0 1.1-.9 2-2 2zm-1.47-11.81C18.21 9.47 17.49 9 16.7 9H7.3c-.79 0-1.51.47-1.83 1.19L2 18h20l-3.47-7.81zM9.5 16h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5z"}),"PointOfSale"),we=P(p.lazy(()=>A(()=>import("./build-30d35541.js"),["assets/js/build-30d35541.js","assets/js/index-2d3a0a13.js","assets/css/build-f63bc8fe.css","assets/js/build-062a6c7c.js","assets/js/build-30241498.js","assets/js/build-e83f8211.js","assets/js/build-764e85bd.js","assets/js/build-4e0deea5.js","assets/js/build-07def057.js","assets/js/build-d7db9a04.js","assets/js/build-01b6f7f4.js","assets/js/build-1e307d2a.js","assets/js/build-f07e5e18.js","assets/js/build-bee6630b.js","assets/js/build-61ff55f0.js","assets/js/build-1caa2d98.js","assets/js/build-ac8f790c.js","assets/js/build-b76a1f77.js","assets/js/build-2272a72f.js","assets/js/build-b2ae39de.js","assets/js/build-de06aa21.js","assets/js/build-63df143b.js","assets/js/build-dd4cc906.js","assets/js/build-f30598e0.js","assets/js/build-74899642.js","assets/js/build-3ddaf20a.js","assets/js/build-872076cf.js","assets/js/build-c642439e.js","assets/js/build-1528eb82.js"]))),Oe=P(p.lazy(()=>A(()=>import("./build-8dcaf262.js"),["assets/js/build-8dcaf262.js","assets/js/index-2d3a0a13.js","assets/css/build-f63bc8fe.css","assets/js/build-30241498.js","assets/js/build-e83f8211.js","assets/js/build-764e85bd.js","assets/js/build-4e0deea5.js","assets/js/build-07def057.js","assets/js/build-d7db9a04.js","assets/js/build-01b6f7f4.js","assets/js/build-1e307d2a.js","assets/js/build-f07e5e18.js","assets/js/build-bee6630b.js","assets/js/build-09bd3f47.js","assets/js/build-707ce1cf.js","assets/js/build-60fa46af.js","assets/js/build-566f8acd.js","assets/js/build-61ff55f0.js","assets/js/build-1caa2d98.js","assets/js/build-d4521356.js","assets/js/build-74899642.js","assets/js/build-3ddaf20a.js","assets/js/build-ac8f790c.js","assets/js/build-b76a1f77.js","assets/js/build-2272a72f.js","assets/js/build-b2ae39de.js","assets/js/build-de06aa21.js","assets/js/build-63df143b.js","assets/js/build-dd4cc906.js","assets/js/build-f30598e0.js","assets/js/build-872076cf.js","assets/js/build-c642439e.js","assets/js/build-1528eb82.js"]))),_e=()=>{const[t,s]=p.useState(!1),[r,a]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{mb:2},children:e.jsx(L,{children:e.jsxs(x,{direction:"row",divider:e.jsx(M,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:3},spacing:1,children:[e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(w,{startIcon:e.jsx(Te,{}),variant:"contained",color:"info",onClick:()=>s(!0),children:"Liga de Pago"})}),e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:150},children:e.jsx(w,{startIcon:e.jsx(re,{}),color:"info",variant:"contained",onClick:()=>a(!0),children:"Terminal Virtual"})})]})})}),t&&e.jsx(we,{open:t,setOpen:s}),r&&e.jsx(Oe,{open:r,setOpen:a})]})},Pe={terminal:null},Ae=(t,s)=>({...Pe,setTerminal:r=>{const{terminal:a}=s();t(o=>({terminal:{...a,...r}}),!1,"SET_TERMINAL_SELECTED")},resetTerminal:()=>{t(r=>({pos:null}),!1,"RESET_TERMINAL_SELECTED")},addTerminalInfo:r=>{const{terminal:a}=s();t(o=>({terminal:{...a,...r}}),!1,"SET_TERMINAL_INFO")}}),b=R(Ae),Me={terminals:[],isOpenList:!1,isCollapse:!1},Re=(t,s)=>({...Me,setTerminals:r=>{t(a=>({terminals:r}),!1,"SET_TERMINAL")},setOpenList:r=>{t(a=>({isOpenList:r}),!1,"SET_OPEN_LIST")},setCollapse:r=>{t(a=>({isCollapse:r}),!1,"SET_COLLAPSE")}}),h=R(Re),ke=()=>{const[t,s]=p.useState(new Date);b(o=>o.terminal),b(o=>o.addTerminalInfo);const r=[],a=[{name:"description",label:"Descripcion",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(o,c)=>{const n=r[o],i=(n==null?void 0:n.type)==="ingreso";return e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(j,{sx:{position:"relative"},children:[e.jsx(k,{sx:{width:48,height:48,color:"text.secondary",bgcolor:"background.neutral"},children:e.jsx(ie,{width:24,height:24})}),e.jsx(j,{sx:{right:0,bottom:0,width:20,height:20,display:"flex",borderRadius:"50%",position:"absolute",alignItems:"center",color:"common.white",bgcolor:"error.main",justifyContent:"center",...i&&{bgcolor:"success.main"}},children:i?e.jsx(ce,{sx:{width:15,height:15}}):e.jsx(de,{sx:{width:15,height:15}})})]}),e.jsxs(j,{sx:{ml:2},children:[e.jsx(y,{variant:"body2",sx:{color:"text.secondary"},children:i?"Recibe dinero de: ":"Retiro de dinero en:"}),e.jsxs(y,{variant:"subtitle2",children:[" ",n==null?void 0:n.description]}),(n==null?void 0:n.concept)!==""&&e.jsxs(y,{variant:"overline",color:"text.disabled",fontStyle:"italic",children:["concepto : ",n==null?void 0:n.concept]})]})]})}}},{name:"date",label:"Fecha",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(o,c)=>{const n=r[o];return e.jsxs(x,{children:[e.jsx(y,{variant:"subtitle2",children:n==null?void 0:n.date}),e.jsx(y,{variant:"body2",sx:{color:"text.secondary"},children:n==null?void 0:n.time})]})}}},{name:"amount",label:"Cantidad",options:{filterType:"textField",filterOptions:{fullWidth:!0},customBodyRenderLite:(o,c)=>{const n=r[o],i=(n==null?void 0:n.type)==="ingreso";return e.jsx(y,{variant:"subtitle2",fontWeight:"bold",color:i?"success.main":"error",children:i?`+ ${n==null?void 0:n.amount}`:`- ${n==null?void 0:n.amount}`})}}}];return e.jsxs(pe,{children:[e.jsx(ae,{currentMonth:t,setCurrentMonth:s,isLoading:!1}),e.jsx(M,{sx:{borderStyle:"dashed"}}),e.jsx(he,{title:"Movimientos",data:r||[],columns:a,options:{responsive:"simple",rowHover:!0,selectableRows:"single",selectableRowsOnClick:!1,selectToolbarPlacement:"replace",sortOrder:{name:"date",direction:"desc"},downloadOptions:{filename:"movimientos.csv",filterOptions:{useDisplayedColumnsOnly:!1}}}})]})},ze=()=>{const t=b(s=>s.terminal);return e.jsxs(x,{sx:s=>({pl:{xs:0,lg:2},overflow:"hidden",flexDirection:"column",flexGrow:1}),children:[t&&e.jsxs(e.Fragment,{children:[(t==null?void 0:t.isVirtual)&&e.jsx(_e,{}),e.jsx(L,{children:e.jsx(x,{pt:0,pb:4,px:2,children:e.jsx(ke,{})})})]}),!t&&e.jsxs(x,{spacing:3,sx:{height:"100%",width:"100%"},children:[e.jsx(W,{variant:"filled",severity:"info",children:"Debe seleccionar una terminal para ver sus detalles!"}),e.jsx(x,{alignItems:"center",children:e.jsx(xe,{sx:{width:"30%"}})})]})]})},De=$(U)(({theme:t})=>({borderRadius:"8px!important",width:1,justifyContent:"center",display:"flex",alignItems:"center",mb:1})),D=({terminal:t})=>{const s=h(i=>i.isOpenList),r=h(i=>i.setOpenList),a=b(i=>i.setTerminal),o=b(i=>i.terminal);(t==null?void 0:t.id)===(o==null?void 0:o.id)&&o&&(o==null||o.cardON);const c=(t==null?void 0:t.id)===(o==null?void 0:o.id),n=i=>{var u;!((u=i.target)==null?void 0:u.type)&&!c&&(a(t),r(!1))};return e.jsx(Q,{title:t==null?void 0:t.name,arrow:!0,placement:"right",children:e.jsx(ue,{sx:{mb:1,padding:0,borderRadius:1,"& :hover":{color:"text.primary"}},disablePadding:!0,children:e.jsxs(De,{onClick:n,sx:{...c&&{bgcolor:"secondary.light",color:"black","& :hover":{color:"text.primary"}},"& :hover":{color:"text.primary"},width:1,py:1,gap:1},children:[e.jsx(je,{sx:{ml:2,m:0},children:e.jsx(j,{sx:{position:"relative"},children:e.jsx(k,{sx:i=>({width:32,height:32,m:0,backgroundColor:i.palette.primary.main,"& :hover":{color:"white"}}),children:t!=null&&t.isVirtual?e.jsx(z,{sx:{width:20,height:20,color:"white"}}):e.jsx(Ee,{sx:{width:16,height:16,color:"white"}})})})}),s&&e.jsx(e.Fragment,{children:e.jsx(x,{sx:{width:1},children:e.jsx(y,{noWrap:!0,variant:"subtitle2",children:t==null?void 0:t.name})})})]})})})};D.propTypes={terminal:l.shape({alias:l.any,id:l.any,isVirtual:l.any,name:l.any})};const B=({terminalsQuery:t,sx:s,...r})=>{const{isLoading:a,data:o,error:c,isError:n,refetch:i}=t,g=h(d=>d.isOpenList),u=h(d=>d.terminals);return n&&g&&!o&&!a?e.jsx(q,{errorMessage:c,handleButton:i}):o&&g&&(o==null?void 0:o.length)===0&&!a?e.jsx(me,{pt:2.5,message:"No hay terminales activas para este comercio"}):e.jsx(G,{disablePadding:!0,sx:s,...r,children:(a?[...Array(12)]:u).map((d,v)=>d!=null&&d.id?e.jsx(D,{terminal:d},d==null?void 0:d.id):e.jsx(ge,{isOpenSideBar:g},v))})};B.propTypes={sx:l.any,terminalsQuery:l.shape({data:l.array,error:l.any,isError:l.any,isLoading:l.any,refetch:l.any})};const F=({commerceTerminals:t=[]})=>{const s=h(f=>f.isOpenList),r=h(f=>f.setOpenList),a=h(f=>f.setTerminals),o=h(f=>f.terminals),c=h(f=>f.isCollapse),[n,i]=p.useState(""),[g,u]=p.useState(!1),d=async f=>{try{const{value:m}=f.target;if(i(m),m){const V=(t==null?void 0:t.filter(S=>{var E;return(S==null?void 0:S.name)&&((E=S==null?void 0:S.name)==null?void 0:E.toLowerCase().indexOf(m.toLowerCase()))!==-1}))||[];a(V)}else a(t)}catch(m){console.error(m)}},v=()=>{s&&(i(""),a(t)),r(!s)},N=()=>{u(!0)},H=()=>{u(!1)};return p.useEffect(()=>{t&&a(t)},[t]),p.useEffect(()=>{if(!s)return u(!1)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{p:2,px:0},children:e.jsxs(x,{direction:"row",justifyContent:s?"flex-end":"center",alignItems:"center",spacing:2,children:[!c&&e.jsx(le,{onClickAway:H,children:e.jsx(Ie,{fullWidth:!0,size:"small",value:n,onFocus:N,onChange:d,placeholder:"Buscar Terminales...",InputProps:{startAdornment:e.jsx(Ce,{position:"start",children:e.jsx(Le,{sx:{color:"text.disabled",width:20,height:20}})})}})}),e.jsx(x,{direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(ye,{size:"small",sx:{...!s&&{transform:"rotate(180deg)"}},onClick:v,children:K})})]})}),(o==null?void 0:o.length)===0&&(t==null?void 0:t.length)>0&&e.jsx(Y,{sx:{p:1,display:"flex",flexDirection:"column",alignItems:"center"},searchQuery:n})]})};F.propTypes={commerceTerminals:l.array};const Be={LIST:"commerce-terminals"},Fe=t=>(t==null?void 0:t.map(s=>{var r,a,o,c;return{id:s==null?void 0:s.id,commerceId:s==null?void 0:s.commerceId,terminalId:s==null?void 0:s.terminalId,terminalON:((r=s==null?void 0:s.apiData)==null?void 0:r.status)===1,country:(a=s==null?void 0:s.apiData)==null?void 0:a.country,date:{created:(o=s==null?void 0:s.apiData)==null?void 0:o.created_at,updated:(c=s==null?void 0:s.apiData)==null?void 0:c.updated_at,register:s==null?void 0:s.registerDate},isVirtual:(s==null?void 0:s.typeId)==="1",name:(s==null?void 0:s.name)!==""?s==null?void 0:s.name.toString().toUpperCase():`TERMINAL-${s==null?void 0:s.terminalId}`,active:(s==null?void 0:s.active)==="1",balanceFormatted:fe("0")}}))||[],Ne=async()=>{const{data:t}=await T.get("/api/commerces/terminals");return Fe(t)},ns=async t=>{const{data:s}=await T.post("/api/commerce/pay/new",t);return s},os=async t=>{const{data:s}=await T.post("/api/commerce/virtual-terminal/generate/transaction",t);return s},He=(t={})=>{const[s,r]=p.useState(null);return{...Z([Be.LIST],Ne,{staleTime:6e4,refetchOnMount:"always",onError:o=>{const c=J(o,"No se puede obtener la lista de terminales del comercio. Intente nuevamente o reporte a sistemas");r(c)},...t}),error:s||null}},Ve=()=>{const t=h(d=>d.setOpenList),s=h(d=>d.setCollapse),r=h(d=>d.isOpenList),a=He(),o=X(),c=ee("up","md"),n=c&&!r,i=()=>{t(!1)},g=()=>{t(!r)};p.useEffect(()=>{c&&t(!0)},[c]),p.useEffect(()=>{s(n)},[n]);const u=e.jsx(L,{sx:{height:.98},children:e.jsxs(x,{px:r?1:0,children:[e.jsx(F,{commerceTerminals:(a==null?void 0:a.data)||[]}),e.jsx(B,{terminalsQuery:a})]})});return e.jsxs(e.Fragment,{children:[!c&&!r&&e.jsx(Se,{onClick:g,children:e.jsx(z,{sx:{width:20,height:20}})}),c?e.jsx(O,{open:r,variant:"persistent",PaperProps:{sx:{height:1,borderRightStyle:"none",bgcolor:"background.default"}},sx:{height:1,width:I,transition:o.transitions.create("width"),"& .MuiDrawer-paper":{position:"static",backgroundColor:"transparent!important",width:I},...n&&{width:_,"& .MuiDrawer-paper":{width:_,backgroundColor:"transparent!important",position:"static",transform:"none !important",visibility:"visible !important"}}},children:u}):e.jsx(O,{ModalProps:{keepMounted:!0},open:r,onClose:i,sx:{height:1,"& .MuiDrawer-paper":{width:I,p:2}},children:u})]})},We=()=>e.jsx(se,{title:"Lista de Terminales Punto de Venta",children:e.jsx(be,{children:e.jsxs(j,{display:"flex",overflow:"hidden",sx:{height:"100vH",maxHeight:"100%",flexDirection:"column"},children:[e.jsx(j,{px:1,children:e.jsx(ve,{name:"Terminales Punto de Venta",links:[{name:"Inicio",href:te.root},{name:"Administracion",href:ne.terminals},{name:oe.terminals.name}]})}),e.jsxs(j,{display:"flex",overflow:"hidden",sx:{flex:"1 1 0%"},children:[e.jsx(j,{display:"block",width:1,position:"absolute"}),e.jsx(Ve,{}),e.jsx(ze,{})]})]})})}),rs=Object.freeze(Object.defineProperty({__proto__:null,default:We},Symbol.toStringTag,{value:"Module"}));export{Te as L,rs as P,ns as c,os as g,b as u};
