import{aj as z,j as t,N as B,aL as R,O as c,r as x,ah as V,S as d,T as i,B as C,ai as M,E as H,a1 as k,ak as U,d as G,g as q,P as $,ab as K,aM as W,aN as Q,C as Y,_ as J}from"./index-uf0rlXc3.js";import{V as X}from"./build-DsWaIpHX.js";import{L as T}from"./build-VEATRJy1.js";import{L as Z}from"./build-972ZQj3z.js";import{g as ee}from"./build-OUqy1OLg.js";import{P as re}from"./build-A0pkRIS4.js";import{f as v,M as te,C as ne,H as ae}from"./build-b1ST9i6W.js";import{u as se}from"./build-bsbiF8au.js";import{C as oe}from"./build-TQSbHIda.js";const le={commerce:null,openDetailsCommerce:!1},ie=(e,r)=>({...le,setCommerce:a=>{e(n=>({commerce:a}))},setOpenDetailsCommerce:a=>{e(n=>({openDetailsCommerce:a}),!1,"SET_OPEN_DETAILS_COMMERCE")}}),ce=z(ie);function pe(e){const{row:r,closeMenu:a}=e,{original:n}=r,{setCommerce:s,setOpenDetailsCommerce:o}=ce(p=>p);return[t.jsxs(B,{onClick:()=>{s(n),o(!0),a()},sx:{m:0},children:[t.jsx(R,{children:t.jsx(X,{color:"info"})}),"Ver Detalles"]},0)]}const A=({open:e,anchorEl:r,handlePopoverClose:a,data:n})=>{var s;return n?t.jsx(V,{id:"mouse-over-popover",sx:{pointerEvents:"none"},open:e,anchorEl:r,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},onClose:a,disableRestoreFocus:!0,slotProps:{paper:{sx:{mt:1.5,ml:.5,overflow:"inherit",boxShadow:o=>o.customShadows.z20,border:o=>`solid 1px ${o.palette.grey[5008]}`,width:200}}},children:t.jsxs(d,{spacing:2,p:2,children:[t.jsxs(d,{spacing:.5,flex:1,children:[t.jsx(i,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre:"}),t.jsx(i,{variant:"body2",children:(n==null?void 0:n.name)??"-"})]}),t.jsxs(d,{spacing:.5,flex:1,children:[t.jsx(i,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono:"}),t.jsx(i,{variant:"body2",children:(n==null?void 0:n.phone)??"-"})]}),t.jsxs(d,{spacing:.5,flex:1,children:[t.jsx(i,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Fecha Registro:"}),t.jsx(i,{variant:"body2",children:(n==null?void 0:n.register)??"-"})]}),t.jsxs(d,{spacing:.5,flex:1,children:[t.jsx(i,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Último Inicio de Sesión:"}),t.jsx(i,{variant:"body2",children:(n==null?void 0:n.lastLogged)??"-"})]}),t.jsxs(d,{spacing:.5,flex:1,children:[t.jsx(i,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Estado:"}),t.jsx(C,{children:t.jsx(T,{variant:"ghost",color:((s=n==null?void 0:n.status)==null?void 0:s.toLowerCase())==="activo"?"success":"error",sx:{textTransform:"uppercase"},children:(n==null?void 0:n.status)??"-"})})]})]})}):null};A.propTypes={anchorEl:c.any,data:c.shape({lastLogged:c.string,name:c.string,phone:c.string,register:c.string,status:c.string}),handlePopoverClose:c.any,open:c.any};const me=x.memo(A),O=({row:e})=>{var l;const[r,a]=x.useState(null),n=p=>{a(p.currentTarget)},s=()=>{a(null)},o=!!r;return t.jsxs(t.Fragment,{children:[t.jsx(me,{anchorEl:r,open:o,handlePopoverClose:s,data:e==null?void 0:e.account}),t.jsx(C,{sx:{display:"flex",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:1},children:t.jsx(Z,{color:"info.main",sx:{cursor:"auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},underline:"none",variant:"subtitle2",component:i,"aria-owns":o?"mouse-over-popover":void 0,"aria-haspopup":"true",onMouseEnter:p=>{n(p)},onMouseLeave:s,children:(l=e==null?void 0:e.account)==null?void 0:l.name})})]})};O.propTypes={row:c.shape({account:c.shape({name:c.any})})};const ue=e=>{const r=e==null?void 0:e.find(a=>(a==null?void 0:a.type)==="2");return r?{id:r==null?void 0:r.id,type:r==null?void 0:r.type,name:r==null?void 0:r.name,cardNumbers:r==null?void 0:r.cardNumbers,cardUse:r==null?void 0:r.cardUse,customCardsRequired:(r==null?void 0:r.personalized)==="1"}:null},de=e=>(e==null?void 0:e.map(r=>{const{Id:a,Name:n,storePath:s}=r;return{id:a,name:n,path:s}}))??[],he=e=>({available:!!e,speiInCarnet:parseFloat((e==null?void 0:e.SpeiInCarnet)??"0.0"),speiOutCarnet:parseFloat((e==null?void 0:e.SpeiOutCarnet)??"0.0"),speiInMasterCard:parseFloat((e==null?void 0:e.SpeiInMasterCard)??"0.0"),speiOutMasterCard:parseFloat((e==null?void 0:e.SpeiOutMasterCard)??"0.0"),viaboPay:parseFloat((e==null?void 0:e.Pay)??"0.0")}),xe=e=>e.map((r,a)=>{var y;const{id:n,legalRepresentative:s,legalRepresentativeName:o,legalRepresentativePhone:l,legalRepresentativeLastSession:p,legalRepresentativeEmail:m,taxName:u,fiscalPersonType:S,tradeName:f,rfc:b,employees:j,branchOffices:P,pointSaleTerminal:E,paymentApi:N,register:_,statusId:I,registerStep:L,statusName:D,services:g,documents:F,commissions:w}=r;return{id:n,name:f,account:{id:s,name:o,email:m,phone:l,status:"Activo",lastLogged:p===""?"No ha iniciado sesión":v(p),register:v(_)??""},information:{available:u!=="",fiscalName:u,commercialName:f,fiscalTypePerson:S==="1"?"Moral":"Física",rfc:b,employeesNumber:j,branchesNumber:P},services:{names:(g==null?void 0:g.map(h=>h==null?void 0:h.name))||[],available:E!=="0",viaboCard:ue(g),viaboPay:{tpvsNumber:E,apiRequired:N==="1"}},status:{id:I,name:D,step:((y=re.find(h=>h.step.toString()===L))==null?void 0:y.name)??""},documents:de(F),commissions:he(w)}}),fe={COMMERCE_LIST:"commerceList"},ge=async()=>{const{data:e}=await M.get("/api/commerces");return xe(e)},De=async e=>{const{data:r}=await M.post("/api/commerce/information",e);return r},Ce=[{id:1,name:"Registro",color:"info"},{id:2,name:"Validacion",color:"warning"},{id:3,name:"Afiliacion",color:"primary"},{id:4,name:"Cancelado",color:"error"}],Se=e=>{var r;return((r=Ce.find(a=>a.id.toString()===e.toString()))==null?void 0:r.color)||"info"},be=()=>x.useMemo(()=>[{id:"name",accessorKey:"name",header:"Nombre",enableHiding:!1,size:100,Cell:({cell:e,column:r,row:a,renderedCellValue:n})=>t.jsx(i,{fontWeight:"bold",variant:"subtitle2",children:n})},{id:"legalRepresentative",accessorFn:e=>{var r;return(r=e==null?void 0:e.account)==null?void 0:r.name},header:"Representante Legal",size:100,Cell:({cell:e,column:r,row:a,renderedCellValue:n})=>{const{original:s}=a;return t.jsx(O,{row:s})}},{id:"services",accessorFn:e=>{var r,a;return(a=(r=e==null?void 0:e.services)==null?void 0:r.names)==null?void 0:a.toString()},header:"Servicios",Cell:({cell:e,column:r,row:a,renderedCellValue:n})=>{var l,p;const{original:s}=a,o=[];return(p=(l=s==null?void 0:s.services)==null?void 0:l.names)==null||p.forEach(m=>{const u=ee(m);u&&o.push({component:u==null?void 0:u.component,name:m,width:m==="NUBE"?20:25,height:m==="NUBE"?20:25,color:m==="NUBE"?"primary.main":"inherit"})}),t.jsxs(d,{flexDirection:"row",alignItems:"center",gap:1,divider:t.jsx(H,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"double"}}),children:[(o==null?void 0:o.length)===0&&t.jsx(i,{variant:"subtitle2",fontWeight:"bold",color:"warning.main",children:"Sin Servicios"}),o==null?void 0:o.map(({component:m,width:u,height:S,name:f,color:b},j)=>t.jsx(k,{title:f,children:t.jsx(C,{display:"flex",children:t.jsx(m,{sx:{width:u,height:S,color:b}})})},j))]})}},{id:"register-status",accessorFn:e=>{var r;return(r=e==null?void 0:e.status)==null?void 0:r.step},header:"Estado Registro",size:100,Cell:({cell:e,column:r,row:a,renderedCellValue:n})=>t.jsx(d,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.jsx(i,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variant:"subtitle2",title:n,children:n})})},{id:"status",accessorFn:e=>{var r;return(r=e==null?void 0:e.status)==null?void 0:r.name},header:"Estado",size:70,Cell:({cell:e,column:r,row:a,renderedCellValue:n})=>{var o,l;const{original:s}=a;return t.jsx(d,{children:t.jsx(T,{size:"sm",variant:"filled",color:Se((o=s==null?void 0:s.status)==null?void 0:o.id),sx:{textTransform:"uppercase"},children:(l=s==null?void 0:s.status)==null?void 0:l.name})})}}],[]),je=(e={})=>{const{enqueueSnackbar:r}=U(),[a,n]=x.useState(null);return{...G([fe.COMMERCE_LIST],ge,{staleTime:60*5e3,onError:o=>{const l=q(o,"No se puede obtener la lista de comercios");n(l),r(l,{variant:"error",autoHideDuration:5e3})},...e}),error:a||null}};function Ee(){const{data:e,isLoading:r,isError:a,error:n,isFetching:s}=je(),o=be(),l=se(a,n,{columns:o,data:e||[],enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowActions:!0,enableRowSelection:!0,enableDensityToggle:!1,positionActionsColumn:"last",selectAllMode:"all",initialState:{density:"compact",sorting:[{id:"name",desc:!1}]},state:{isLoading:r,showAlertBanner:a,showProgressBars:s},displayColumnDefOptions:{"mrt-row-select":{maxSize:10},"mrt-row-actions":{header:"Acciones",maxSize:80}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},renderTopToolbarCustomActions:()=>t.jsx(C,{}),renderRowActionMenuItems:pe});return t.jsx(oe,{children:t.jsx(te,{table:l})})}const ye=Y(x.lazy(()=>J(()=>import("./build-_BTCchIG.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))));function ve(){return t.jsx($,{title:"Administración Comercios",children:t.jsxs(ne,{children:[t.jsx(ae,{name:"Comercios",links:[{name:"Inicio",href:K.root},{name:"Administración",href:W.commerces},{name:Q.commerces.name}]}),t.jsx(Ee,{}),t.jsx(ye,{})]})})}const Fe=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"}));export{fe as M,De as a,Fe as b,ce as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/build-_BTCchIG.js","assets/js/index-uf0rlXc3.js","assets/css/build-D8PjCv5v.css","assets/js/build--Hpn1XPp.js","assets/js/build-TQSbHIda.js","assets/js/build-0n9aYzfv.js","assets/js/build-DsWaIpHX.js","assets/js/build-VEATRJy1.js","assets/js/build-lh15rGBf.js","assets/js/build-5q97hjQz.js","assets/js/build-Om2RpeG4.js","assets/js/build-gzzdWRH-.js","assets/js/build-cbZN2ucd.js","assets/js/build-CFHioas6.js","assets/js/build-Uc7vb3zK.js","assets/js/build-WVKOg0-x.js","assets/js/build-972ZQj3z.js","assets/js/build-OUqy1OLg.js","assets/js/build-b1ST9i6W.js","assets/js/build-DaLTkvGJ.js","assets/js/build-OGvlSQZv.js","assets/js/build-YMH39fBE.js","assets/js/build-38HIMMdA.js","assets/js/build-3AyMUiN8.js","assets/js/build-zH8OCAbq.js","assets/js/build-zEF68lUW.js","assets/js/build-A0pkRIS4.js","assets/js/build-bsbiF8au.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}