import{u as Q,k as U,g as W,W as X,aa as V,j as r,B as I,P as Y,r as L,T as P,aJ as Z,S as ee,C as te,a1 as ae}from"./build-1231e3a0.js";import{T as re}from"./build-50738b0b.js";import{v as ne,p as se}from"./build-08db240c.js";import{m as oe}from"./build-ecaf0d13.js";import{a as ie,P as O}from"./build-61d5e77c.js";import{u as ce,a as le}from"./build-4cfd5209.js";import"./build-79be541e.js";import"./build-9563ddbe.js";import"./build-e603dc94.js";import"./build-9c6dbdda.js";const de=(n={})=>{const{enqueueSnackbar:i}=Q();return U({mutationFn:ne,onError:c=>{const o=W(c,"No se puede validar el código");i(o,{variant:(c==null?void 0:c.status)===500?"error":"warning",autoHideDuration:5e3})},...n})},ue=X(re)`
  input {
    text-align: center;
  }
`,pe={TextFieldStyled:ue},me=n=>r.jsx(pe.TextFieldStyled,{...n}),N={left:"ArrowLeft",right:"ArrowRight",backspace:"Backspace"};function ge(n,i){return n<=0?[]:Array.from({length:n},i)}function he(n,i,c){return n.map((o,h)=>i===h?c:o)}function _(n){return n.join("")}function B(n,i){return[...n,i]}function xe(n,i,c){return n.reduce((o,h,d)=>{const{characters:l,restArrayMerged:s}=o;if(d<c)return{restArrayMerged:s,characters:B(l,h)};const[f,...y]=s;return{restArrayMerged:y,characters:B(l,f||"")}},{restArrayMerged:i,characters:[]}).characters}function fe(n){return n.split("")}const $=V.forwardRef((n,i)=>{const{value:c,length:o,autoFocus:h,onChange:d,TextFieldsProps:l,onComplete:s,validateChar:f,className:y,...k}=n,{onPaste:S,onFocus:C,onKeyDown:j,className:u,...A}=l||{},g=ge(o,(e,a)=>({character:c[a]||"",inputRef:V.createRef()})),v=e=>g.findIndex(({inputRef:a})=>a.current===e),F=()=>g.map(({character:e})=>e),R=(e,a)=>{const t=he(F(),e,a);return _(t)},E=e=>{var a,t;(t=(a=g[e])==null?void 0:a.inputRef.current)==null||t.focus()},x=e=>{var a,t;(t=(a=g[e])==null?void 0:a.inputRef.current)==null||t.select()},p=e=>{e+1!==o&&(g[e+1].character?x(e+1):E(e+1))},T=e=>{e>0&&x(e-1)},b=e=>{const a=e.target.value[0]||"",t=v(e.target);if(typeof f=="function"&&!f(a,t))return;const m=R(t,a);d==null||d(m),m.length===o&&(s==null||s(m)),a!==""?m.length<o?p(m.length-1):p(t):m[t]?x(t):T(t)},K=e=>{e.preventDefault(),e.target.select(),C==null||C(e)},H=e=>{const a=e.target,t=v(a);a.value===e.key?(e.preventDefault(),p(t)):!a.value&&N.backspace===e.key||N.left===e.key?(e.preventDefault(),x(t-1)):N.right===e.key&&(e.preventDefault(),x(t+1)),j==null||j(e)},J=e=>{e.preventDefault();const a=e.target,t=e.clipboardData.getData("text/plain"),m=v(a),q=F(),D=xe(q,fe(t),m),M=D.findIndex((z,G)=>G>m&&z===""),w=_(D);if(d==null||d(w),w.length===o){s==null||s(w),E(o-1);return}M!==-1&&E(M),S==null||S(e)};return r.jsx(I,{display:"flex",gap:"20px",alignItems:"center",ref:i,className:`MuiOtpInput-Box ${y||""}`,...k,children:g.map(({character:e,inputRef:a},t)=>r.jsx(me,{autoFocus:h?t===0:!1,autoComplete:"one-time-code",value:e,inputRef:a,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${t+1} ${u||""}`,onPaste:J,onFocus:K,onChange:b,onKeyDown:H,...A},t))})});$.defaultProps={value:"",length:4,autoFocus:!1,validateChar:()=>!0,onChange:()=>{},onComplete:()=>{},TextFieldsProps:{}};const Ce="/react/assets/img/mail.svg";ve.propTypes={store:Y.shape(se)};function ve({store:n}){const{lastProcess:i,setActualProcess:c,setLastProcess:o,setToken:h,token:d,resume:l}=n,{info:s}=i,{mutate:f,isLoading:y}=ce(),{mutate:k,isLoading:S,isError:C,reset:j}=de(),{data:u,isError:A}=le(s==null?void 0:s.email,{enabled:!!(s!=null&&s.email)});L.useEffect(()=>{u&&h(u==null?void 0:u.token)},[u]);const[g,v]=L.useState(""),F=p=>{v(p),j()},R=(p,T)=>oe(p),E=p=>{k({verificationCode:p,token:d},{onSuccess:()=>{var T;l!=null&&l.step?c(((T=ie.find(b=>b.step===(l==null?void 0:l.step)))==null?void 0:T.name)||O.SERVICES_SELECTION):c(O.SERVICES_SELECTION),o()},onError:()=>{v("")}})},x=()=>{f({token:u==null?void 0:u.token})};return r.jsxs(r.Fragment,{children:[r.jsx(I,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",my:4},children:r.jsx("img",{className:"animate__animated animate__pulse",src:Ce,width:"25%",alt:"Sent Mail"})}),r.jsx(P,{variant:"h4",color:"textPrimary",align:"center",children:"Verificación de Cuenta"}),r.jsxs(P,{paragraph:!0,sx:{mb:4,mt:2},align:"center",variant:"body2",color:"text.secondary",whiteSpace:"pre-line",children:["Enviamos un correo electrónico a ",s==null?void 0:s.email," con el código de verificacion de tu cuenta, ingrese el código en el cuadro a continuación para verificar su cuenta."]}),r.jsx($,{length:6,value:g,onComplete:E,onChange:F,validateChar:R,sx:{gap:{xs:1.5,sm:2,md:3}},TextFieldsProps:{placeholder:"-",error:C,disabled:S}}),!!C&&r.jsx(I,{mt:1,children:r.jsx(P,{variant:"caption",color:"error",children:"Código incorrecto"})}),r.jsx(I,{mb:5,children:r.jsx(Z,{sx:{my:4},children:r.jsx(ee,{direction:"row",spacing:1,justifyContent:"center",children:y?r.jsx(te,{wid:!0,sx:{mx:3}}):r.jsxs(r.Fragment,{children:[r.jsx(P,{variant:"body2",children:"¿No tengo un código?"}),r.jsx(ae,{underline:"hover",sx:{cursor:"pointer"},onClick:x,children:r.jsx(P,{variant:"body2",color:"primary",children:"Reenviar código"})})]})})})})]})}export{ve as default};
