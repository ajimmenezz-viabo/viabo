import{z as $,j as r,am as q,K as M,aO as v,O as u,r as g,ak as K,S as x,T as d,B as j,al as y,E as Q,a2 as Y,an as J,d as X,g as Z,N as ee,P as te,ae as re,aP as ne,aQ as ae,C as T,_ as A}from"./index-2z-ZW7ZM.js";import{V as se}from"./build-mhiluQTQ.js";import{P as oe}from"./build-i9WRBA9-.js";import{L as P}from"./build-A7hFqGNg.js";import{L as le}from"./build-1KANcpWx.js";import{g as ie}from"./build-3BTHYvQG.js";import{P as ce}from"./build-A0pkRIS4.js";import{f as _,M as me,C as pe,H as de}from"./build-Ve6yeeQ4.js";import{c as ue}from"./build--SuI_DMG.js";import{u as he}from"./build-R1Mj0_Ez.js";const xe=$(r.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"}),"LibraryAdd"),Ce={commerce:null,openCommerceDetails:!1,openCommerceCommissions:!1,openCommerceServices:!1},ge=(e,t)=>({...Ce,setCommerce:a=>{e(n=>({commerce:a}))},setOpenCommerceDetails:a=>{e(n=>({openCommerceDetails:a}),!1,"SET_OPEN_COMMERCE_DETAILS")},setOpenCommerceCommissions:a=>{e(n=>({openCommerceCommissions:a}),!1,"SET_OPEN_COMMERCE_COMMISSIONS")},setOpenCommerceServices:a=>{e(n=>({openCommerceServices:a}),!1,"SET_OPEN_COMMERCE_SERVICES")}}),fe=q(ge);function Se(e){const{row:t,closeMenu:a}=e,{original:n}=t,{setCommerce:s,setOpenCommerceDetails:o,setOpenCommerceCommissions:l,setOpenCommerceServices:c}=fe(p=>p);return[r.jsxs(M,{onClick:()=>{s(n),o(!0),a()},sx:{m:0},children:[r.jsx(v,{children:r.jsx(se,{color:"info"})}),"Ver Detalles"]},"details"),r.jsxs(M,{onClick:()=>{s(n),l(!0),a()},sx:{m:0},children:[r.jsx(v,{children:r.jsx(oe,{color:"primary"})}),"Comisiones"]},"commissions"),r.jsxs(M,{onClick:()=>{s(n),c(!0),a()},sx:{m:0},children:[r.jsx(v,{children:r.jsx(xe,{})}),"Servicios"]},"services")]}const N=({open:e,anchorEl:t,handlePopoverClose:a,data:n})=>{var s;return n?r.jsx(K,{id:"mouse-over-popover",sx:{pointerEvents:"none"},open:e,anchorEl:t,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},onClose:a,disableRestoreFocus:!0,slotProps:{paper:{sx:{mt:1.5,ml:.5,overflow:"inherit",boxShadow:o=>o.customShadows.z20,border:o=>`solid 1px ${o.palette.grey[5008]}`,width:200}}},children:r.jsxs(x,{spacing:2,p:2,children:[r.jsxs(x,{spacing:.5,flex:1,children:[r.jsx(d,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Nombre:"}),r.jsx(d,{variant:"body2",children:(n==null?void 0:n.name)??"-"})]}),r.jsxs(x,{spacing:.5,flex:1,children:[r.jsx(d,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Teléfono:"}),r.jsx(d,{variant:"body2",children:(n==null?void 0:n.phone)??"-"})]}),r.jsxs(x,{spacing:.5,flex:1,children:[r.jsx(d,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Fecha Registro:"}),r.jsx(d,{variant:"body2",children:(n==null?void 0:n.register)??"-"})]}),r.jsxs(x,{spacing:.5,flex:1,children:[r.jsx(d,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Último Inicio de Sesión:"}),r.jsx(d,{variant:"body2",children:(n==null?void 0:n.lastLogged)??"-"})]}),r.jsxs(x,{spacing:.5,flex:1,children:[r.jsx(d,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:"Estado:"}),r.jsx(j,{children:r.jsx(P,{variant:"ghost",color:((s=n==null?void 0:n.status)==null?void 0:s.toLowerCase())==="activo"?"success":"error",sx:{textTransform:"uppercase"},children:(n==null?void 0:n.status)??"-"})})]})]})}):null};N.propTypes={anchorEl:u.any,data:u.shape({lastLogged:u.string,name:u.string,phone:u.string,register:u.string,status:u.string}),handlePopoverClose:u.any,open:u.any};const Ee=g.memo(N),I=({row:e})=>{var l;const[t,a]=g.useState(null),n=c=>{a(c.currentTarget)},s=()=>{a(null)},o=!!t;return r.jsxs(r.Fragment,{children:[r.jsx(Ee,{anchorEl:t,open:o,handlePopoverClose:s,data:e==null?void 0:e.account}),r.jsx(j,{sx:{display:"flex",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:1},children:r.jsx(le,{color:"info.main",sx:{cursor:"auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},underline:"none",variant:"subtitle2",component:d,"aria-owns":o?"mouse-over-popover":void 0,"aria-haspopup":"true",onMouseEnter:c=>{n(c)},onMouseLeave:s,children:(l=e==null?void 0:e.account)==null?void 0:l.name})})]})};I.propTypes={row:u.shape({account:u.shape({name:u.any})})};const be=e=>{const t=e==null?void 0:e.find(a=>(a==null?void 0:a.type)==="2");return t?{id:t==null?void 0:t.id,type:t==null?void 0:t.type,name:t==null?void 0:t.name,cardNumbers:t==null?void 0:t.cardNumbers,cardUse:t==null?void 0:t.cardUse,customCardsRequired:(t==null?void 0:t.personalized)==="1"}:null},ye=e=>(e==null?void 0:e.map(t=>{const{Id:a,Name:n,storePath:s}=t;return{id:a,name:n,path:s}}))??[],je=e=>({available:!!e,speiInCarnet:parseFloat((e==null?void 0:e.SpeiInCarnet)??"0.0"),speiOutCarnet:parseFloat((e==null?void 0:e.SpeiOutCarnet)??"0.0"),speiInMasterCard:parseFloat((e==null?void 0:e.SpeiInMasterCard)??"0.0"),speiOutMasterCard:parseFloat((e==null?void 0:e.SpeiOutMasterCard)??"0.0"),viaboPay:parseFloat((e==null?void 0:e.Pay)??"0.0"),cloud:parseFloat((e==null?void 0:e.SharedTerminal)??"0.0")}),Me=e=>e.map((t,a)=>L(t)),L=e=>{var O;const{id:t,legalRepresentative:a,legalRepresentativeName:n,legalRepresentativePhone:s,legalRepresentativeLastSession:o,legalRepresentativeEmail:l,fiscalName:c,fiscalPersonType:m,tradeName:p,rfc:E,employees:b,branchOffices:S,pointSaleTerminal:h,paymentApi:C,register:z,statusId:D,registerStep:R,statusName:w,services:f,documents:V,terminals:F,commissions:H,slug:k,publicTerminal:B,postalAddress:U,phoneNumbers:W,logo:G}=e;return{id:t,name:p,account:{id:a,name:n,email:l,phone:s,status:"Activo",lastLogged:o===""?"No ha iniciado sesión":_(o),register:_(z)??""},information:{available:c!=="",fiscalName:c,commercialName:p,fiscalTypePerson:m,rfc:E,employeesNumber:b,branchesNumber:S,terminalCommerceSlug:k||"",publicTerminal:B||null,postalAddress:U||"",phoneNumbers:W||"",logo:G||null},terminals:ue(F||[],"id","name"),services:{names:(f==null?void 0:f.map(i=>i==null?void 0:i.name))||[],catalog:(f==null?void 0:f.map(i=>({id:i==null?void 0:i.Id,type:i==null?void 0:i.type,name:i==null?void 0:i.name})))||[],available:h!=="0",viaboCard:be(f),viaboPay:{tpvsNumber:h,apiRequired:C==="1"}},status:{id:D,name:w,step:((O=ce.find(i=>i.step.toString()===R))==null?void 0:O.name)??""},documents:ye(V),commissions:je(H)}},ve={COMMERCE_LIST:"commerceList",COMMERCE_DETAILS:"commerce-details"},Te=async()=>{const{data:e}=await y.get("/api/commerces");return Me(e)},$e=async e=>{const{data:t}=await y.get(`/api/commerce/${e}`);return L(t)},qe=async e=>{const{data:t}=await y.post("/api/commerce/commissions/register",e);return t},Ke=async e=>{const{data:t}=await y.post("/api/backoffice/commerce/update",e);return t},Qe=async e=>{const{data:t}=await y.put("/api/backoffice/commerce/service/update",e);return t},Ae=[{id:1,name:"Registro",color:"info"},{id:2,name:"Validacion",color:"warning"},{id:3,name:"Afiliacion",color:"primary"},{id:4,name:"Cancelado",color:"error"}],Oe=e=>{var t;return((t=Ae.find(a=>a.id.toString()===e.toString()))==null?void 0:t.color)||"info"},_e=()=>g.useMemo(()=>[{id:"name",accessorKey:"name",header:"Nombre",enableHiding:!1,size:150,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>r.jsx(d,{fontWeight:"bold",variant:"subtitle2",children:n})},{id:"legalRepresentative",accessorFn:e=>{var t;return(t=e==null?void 0:e.account)==null?void 0:t.name},header:"Representante Legal",size:100,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>{const{original:s}=a;return r.jsx(I,{row:s})}},{id:"services",accessorFn:e=>{var t,a;return(a=(t=e==null?void 0:e.services)==null?void 0:t.names)==null?void 0:a.toString()},header:"Servicios",Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>{var l,c;const{original:s}=a,o=[];return(c=(l=s==null?void 0:s.services)==null?void 0:l.names)==null||c.forEach(m=>{const p=ie(m);p&&o.push({component:p==null?void 0:p.component,name:m,width:m==="NUBE"?20:25,height:m==="NUBE"?20:25,color:m==="NUBE"?"primary.main":"inherit"})}),r.jsxs(x,{flexDirection:"row",alignItems:"center",gap:1,divider:r.jsx(Q,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"double"}}),children:[(o==null?void 0:o.length)===0&&r.jsx(d,{variant:"subtitle2",fontWeight:"bold",color:"warning.main",children:"Sin Servicios"}),o==null?void 0:o.map(({component:m,width:p,height:E,name:b,color:S},h)=>r.jsx(Y,{title:b,children:r.jsx(j,{display:"flex",children:r.jsx(m,{sx:{width:p,height:E,color:S}})})},h))]})}},{id:"register-status",accessorFn:e=>{var t;return(t=e==null?void 0:e.status)==null?void 0:t.step},header:"Estado Registro",minSize:100,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>r.jsx(x,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.jsx(d,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variant:"subtitle2",title:n,children:n})})},{id:"status",accessorFn:e=>{var t;return(t=e==null?void 0:e.status)==null?void 0:t.name},header:"Estado",size:70,Cell:({cell:e,column:t,row:a,renderedCellValue:n})=>{var o,l;const{original:s}=a;return r.jsx(x,{children:r.jsx(P,{size:"sm",variant:"filled",color:Oe((o=s==null?void 0:s.status)==null?void 0:o.id),sx:{textTransform:"uppercase"},children:(l=s==null?void 0:s.status)==null?void 0:l.name})})}}],[]),Pe=(e={})=>{const{enqueueSnackbar:t}=J(),[a,n]=g.useState(null);return{...X([ve.COMMERCE_LIST],Te,{staleTime:60*5e3,onError:o=>{const l=Z(o,"No se puede obtener la lista de comercios");n(l),t(l,{variant:"error",autoHideDuration:5e3})},...e}),error:a||null}};function Ne(){const{data:e,isLoading:t,isError:a,error:n,isFetching:s}=Pe(),o=_e(),l=he(a,n,{columns:o,data:e||[],enableColumnPinning:!0,enableColumnFilterModes:!0,enableStickyHeader:!0,enableRowVirtualization:!0,enableFacetedValues:!0,enableRowActions:!0,enableRowSelection:!0,enableDensityToggle:!1,positionActionsColumn:"last",selectAllMode:"all",initialState:{density:"compact",sorting:[{id:"name",desc:!1}]},state:{isLoading:t,showAlertBanner:a,showProgressBars:s},displayColumnDefOptions:{"mrt-row-select":{maxSize:10},"mrt-row-actions":{header:"Acciones",maxSize:80}},muiTableContainerProps:{sx:{maxHeight:{md:"350px",lg:"450px",xl:"700px"}}},enableColumnResizing:!0,layoutMode:"grid",renderTopToolbarCustomActions:()=>r.jsx(j,{}),renderRowActionMenuItems:Se}),c=(m=1)=>{const p=l.refs.tableContainerRef.current.offsetWidth,E=l.getState().density==="spacious"?40:l.getState().density==="comfortable"?32:16,b=20;let S=0;const h=l.getAllColumns();for(let C=0;C<h.length;C++)S+=h[C].getSize()+E,S+b>p?C>m&&h[C].toggleVisibility(!1):h[C].toggleVisibility(!0)};return g.useEffect(()=>{c(3);function m(){c(3)}window.addEventListener("resize",m)},[l,l.getState().density]),r.jsx(ee,{children:r.jsx(me,{table:l})})}const Ie=T(g.lazy(()=>A(()=>import("./build-m5LJ00Zz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])))),Le=T(g.lazy(()=>A(()=>import("./build-EmV3bKxs.js"),__vite__mapDeps([27,1,2,13,14,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26])))),ze=T(g.lazy(()=>A(()=>import("./build-l1-tWvu6.js"),__vite__mapDeps([28,1,2,13,14,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26]))));function De(){return r.jsx(te,{title:"Administración Comercios",children:r.jsxs(pe,{children:[r.jsx(de,{name:"Comercios",links:[{name:"Inicio",href:re.root},{name:"Administración",href:ne.commerces},{name:ae.commerces.name}]}),r.jsx(Ne,{}),r.jsx(Ie,{}),r.jsx(Le,{}),r.jsx(ze,{})]})})}const Ye=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));export{ve as M,Ke as a,qe as b,Qe as c,Ye as d,$e as g,fe as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/build-m5LJ00Zz.js","assets/js/index-2z-ZW7ZM.js","assets/css/build-pvjN466W.css","assets/js/build-A7hFqGNg.js","assets/js/build-zmG1rUQC.js","assets/js/build-SzDtQGnO.js","assets/js/build-KmDWCa1O.js","assets/js/build-fTSzZ0k5.js","assets/js/build-1AAt12lA.js","assets/js/build-u3LcFEdF.js","assets/js/build-Uc7vb3zK.js","assets/js/build-_xMqY4Jh.js","assets/js/build-1KANcpWx.js","assets/js/build-mhiluQTQ.js","assets/js/build-i9WRBA9-.js","assets/js/build-3BTHYvQG.js","assets/js/build-zH8OCAbq.js","assets/js/build-zEF68lUW.js","assets/js/build-A0pkRIS4.js","assets/js/build-Ve6yeeQ4.js","assets/js/build-397rQXlc.js","assets/js/build-ohrxkAt7.js","assets/js/build-_FiX8RUA.js","assets/js/build-wuqjaMWm.js","assets/js/build-xb_ThzDn.js","assets/js/build--SuI_DMG.js","assets/js/build-R1Mj0_Ez.js","assets/js/build-EmV3bKxs.js","assets/js/build-l1-tWvu6.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}